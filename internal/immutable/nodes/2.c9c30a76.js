var Xc=Object.defineProperty;var Zc=(r,t,e)=>t in r?Xc(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var X=(r,t,e)=>(Zc(r,typeof t!="symbol"?t+"":t,e),e);import{A as Qc,B as Jc,C as as,D as eu,s as mt,e as ve,i as W,d as I,E as Bn,b as tu,F as ru,t as nu,G as $i,q as Cs,H as ml,y as H,f as Z,a as Te,g as Q,h as U,c as Pe,j as C,x as K,I as jt,l as me,m as de,n as He,J as It,K as Ue,r as su,L as iu,u as au,v as ou,w as lu,M as zn,N as Oe,O as Le,k as xs,p as ks,P as cu,Q as uu,R as fu,S as Ya,T as hu,U as Xa}from"../chunks/scheduler.6ae58f8a.js";import{g as Ct,t as ge,c as xt,a as fe,S as dt,i as pt,b as st,d as gt,m as it,e as at,f as Za}from"../chunks/index.d95b2dc9.js";import{d as dl,r as mu,w as du,b as bs}from"../chunks/paths.2ac2c086.js";function Ut(r,t){const e=t.token={};function n(s,i,a,o){if(t.token!==e)return;t.resolved=o;let l=t.ctx;a!==void 0&&(l=l.slice(),l[a]=o);const f=s&&(t.current=s)(l);let c=!1;t.block&&(t.blocks?t.blocks.forEach((h,d)=>{d!==i&&h&&(Ct(),ge(h,1,1,()=>{t.blocks[d]===h&&(t.blocks[d]=null)}),xt())}):t.block.d(1),f.c(),fe(f,1),f.m(t.mount(),t.anchor),c=!0),t.block=f,t.blocks&&(t.blocks[i]=f),c&&eu()}if(Qc(r)){const s=Jc();if(r.then(i=>{as(s),n(t.then,1,t.value,i),as(null)},i=>{if(as(s),n(t.catch,2,t.error,i),as(null),!t.hasCatch)throw i}),t.current!==t.pending)return n(t.pending,0),!0}else{if(t.current!==t.then)return n(t.then,1,t.value,r),!0;t.resolved=r}}function Tn(r,t,e){const n=t.slice(),{resolved:s}=r;r.current===r.then&&(n[r.value]=s),r.current===r.catch&&(n[r.error]=s),r.block.p(n,e)}function Ve(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function pl(r,t){const e={},n={},s={$$scope:1};let i=r.length;for(;i--;){const a=r[i],o=t[i];if(o){for(const l in a)l in o||(n[l]=1);for(const l in o)s[l]||(e[l]=o[l],s[l]=1);r[i]=o}else for(const l in a)s[l]=1}for(const a in n)a in e||(e[a]=void 0);return e}function bl(r){return typeof r=="object"&&r!==null?r:{}}const pu=!0,bu=!1,dd=Object.freeze(Object.defineProperty({__proto__:null,prerender:pu,ssr:bu},Symbol.toStringTag,{value:"Module"})),je=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ze=Object.keys,Ze=Array.isArray;function et(r,t){return typeof t!="object"||ze(t).forEach(function(e){r[e]=t[e]}),r}typeof Promise>"u"||je.Promise||(je.Promise=Promise);const Pn=Object.getPrototypeOf,gu={}.hasOwnProperty;function ht(r,t){return gu.call(r,t)}function tn(r,t){typeof t=="function"&&(t=t(Pn(r))),(typeof Reflect>"u"?ze:Reflect.ownKeys)(t).forEach(e=>{Ht(r,e,t[e])})}const gl=Object.defineProperty;function Ht(r,t,e,n){gl(r,t,et(e&&ht(e,"get")&&typeof e.get=="function"?{get:e.get,set:e.set,configurable:!0}:{value:e,configurable:!0,writable:!0},n))}function qr(r){return{from:function(t){return r.prototype=Object.create(t.prototype),Ht(r.prototype,"constructor",r),{extend:tn.bind(null,r.prototype)}}}}const yu=Object.getOwnPropertyDescriptor;function ta(r,t){let e;return yu(r,t)||(e=Pn(r))&&ta(e,t)}const _u=[].slice;function Ss(r,t,e){return _u.call(r,t,e)}function yl(r,t){return t(r)}function $n(r){if(!r)throw new Error("Assertion Failed")}function _l(r){je.setImmediate?setImmediate(r):setTimeout(r,0)}function vl(r,t){return r.reduce((e,n,s)=>{var i=t(n,s);return i&&(e[i[0]]=i[1]),e},{})}function Wt(r,t){if(ht(r,t))return r[t];if(!t)return r;if(typeof t!="string"){for(var e=[],n=0,s=t.length;n<s;++n){var i=Wt(r,t[n]);e.push(i)}return e}var a=t.indexOf(".");if(a!==-1){var o=r[t.substr(0,a)];return o===void 0?void 0:Wt(o,t.substr(a+1))}}function Et(r,t,e){if(r&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(r)))if(typeof t!="string"&&"length"in t){$n(typeof e!="string"&&"length"in e);for(var n=0,s=t.length;n<s;++n)Et(r,t[n],e[n])}else{var i=t.indexOf(".");if(i!==-1){var a=t.substr(0,i),o=t.substr(i+1);if(o==="")e===void 0?Ze(r)&&!isNaN(parseInt(a))?r.splice(a,1):delete r[a]:r[a]=e;else{var l=r[a];l&&ht(r,a)||(l=r[a]={}),Et(l,o,e)}}else e===void 0?Ze(r)&&!isNaN(parseInt(t))?r.splice(t,1):delete r[t]:r[t]=e}}function $l(r){var t={};for(var e in r)ht(r,e)&&(t[e]=r[e]);return t}const vu=[].concat;function wl(r){return vu.apply([],r)}const El="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(wl([8,16,32,64].map(r=>["Int","Uint","Float"].map(t=>t+r+"Array")))).filter(r=>je[r]),$u=El.map(r=>je[r]);vl(El,r=>[r,!0]);let rr=null;function Vn(r){rr=typeof WeakMap<"u"&&new WeakMap;const t=wi(r);return rr=null,t}function wi(r){if(!r||typeof r!="object")return r;let t=rr&&rr.get(r);if(t)return t;if(Ze(r)){t=[],rr&&rr.set(r,t);for(var e=0,n=r.length;e<n;++e)t.push(wi(r[e]))}else if($u.indexOf(r.constructor)>=0)t=r;else{const i=Pn(r);for(var s in t=i===Object.prototype?{}:Object.create(i),rr&&rr.set(r,t),r)ht(r,s)&&(t[s]=wi(r[s]))}return t}const{toString:wu}={};function Ei(r){return wu.call(r).slice(8,-1)}const Ci=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Eu=typeof Ci=="symbol"?function(r){var t;return r!=null&&(t=r[Ci])&&t.apply(r)}:function(){return null},Vr={};function Gt(r){var t,e,n,s;if(arguments.length===1){if(Ze(r))return r.slice();if(this===Vr&&typeof r=="string")return[r];if(s=Eu(r)){for(e=[];!(n=s.next()).done;)e.push(n.value);return e}if(r==null)return[r];if(typeof(t=r.length)=="number"){for(e=new Array(t);t--;)e[t]=r[t];return e}return[r]}for(t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return e}const ra=typeof Symbol<"u"?r=>r[Symbol.toStringTag]==="AsyncFunction":()=>!1;var Ot=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Cl(r,t){Ot=r,xl=t}var xl=()=>!0;const Cu=!new Error("").stack;function jr(){if(Cu)try{throw jr.arguments,new Error}catch(r){return r}return new Error}function xi(r,t){var e=r.stack;return e?(t=t||0,e.indexOf(r.name)===0&&(t+=(r.name+r.message).split(`
`).length),e.split(`
`).slice(t).filter(xl).map(n=>`
`+n).join("")):""}var kl=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],na=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(kl),xu={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Hr(r,t){this._e=jr(),this.name=r,this.message=t}function Sl(r,t){return r+". Errors: "+Object.keys(t).map(e=>t[e].toString()).filter((e,n,s)=>s.indexOf(e)===n).join(`
`)}function As(r,t,e,n){this._e=jr(),this.failures=t,this.failedKeys=n,this.successCount=e,this.message=Sl(r,t)}function En(r,t){this._e=jr(),this.name="BulkError",this.failures=Object.keys(t).map(e=>t[e]),this.failuresByPos=t,this.message=Sl(r,t)}qr(Hr).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+xi(this._e,2))}},toString:function(){return this.name+": "+this.message}}),qr(As).from(Hr),qr(En).from(Hr);var sa=na.reduce((r,t)=>(r[t]=t+"Error",r),{});const ku=Hr;var oe=na.reduce((r,t)=>{var e=t+"Error";function n(s,i){this._e=jr(),this.name=e,s?typeof s=="string"?(this.message=`${s}${i?`
 `+i:""}`,this.inner=i||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=xu[t]||e,this.inner=null)}return qr(n).from(ku),r[t]=n,r},{});oe.Syntax=SyntaxError,oe.Type=TypeError,oe.Range=RangeError;var Qa=kl.reduce((r,t)=>(r[t+"Error"]=oe[t],r),{}),gs=na.reduce((r,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(r[t+"Error"]=oe[t]),r),{});function Ae(){}function jn(r){return r}function Su(r,t){return r==null||r===jn?t:function(e){return t(r(e))}}function Sr(r,t){return function(){r.apply(this,arguments),t.apply(this,arguments)}}function Au(r,t){return r===Ae?t:function(){var e=r.apply(this,arguments);e!==void 0&&(arguments[0]=e);var n=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Sr(n,this.onsuccess):n),s&&(this.onerror=this.onerror?Sr(s,this.onerror):s),i!==void 0?i:e}}function Tu(r,t){return r===Ae?t:function(){r.apply(this,arguments);var e=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),e&&(this.onsuccess=this.onsuccess?Sr(e,this.onsuccess):e),n&&(this.onerror=this.onerror?Sr(n,this.onerror):n)}}function Pu(r,t){return r===Ae?t:function(e){var n=r.apply(this,arguments);et(e,n);var s=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Sr(s,this.onsuccess):s),i&&(this.onerror=this.onerror?Sr(i,this.onerror):i),n===void 0?a===void 0?void 0:a:et(n,a)}}function ju(r,t){return r===Ae?t:function(){return t.apply(this,arguments)!==!1&&r.apply(this,arguments)}}function ia(r,t){return r===Ae?t:function(){var e=r.apply(this,arguments);if(e&&typeof e.then=="function"){for(var n=this,s=arguments.length,i=new Array(s);s--;)i[s]=arguments[s];return e.then(function(){return t.apply(n,i)})}return t.apply(this,arguments)}}gs.ModifyError=As,gs.DexieError=Hr,gs.BulkError=En;var In={};const Al=100,[ki,Ts,Si]=typeof Promise>"u"?[]:(()=>{let r=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[r,Pn(r),r];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Pn(t),r]})(),Tl=Ts&&Ts.then,ys=ki&&ki.constructor,aa=!!Si;var Ai=!1,Iu=Si?()=>{Si.then(os)}:je.setImmediate?setImmediate.bind(null,os):je.MutationObserver?()=>{var r=document.createElement("div");new MutationObserver(()=>{os(),r=null}).observe(r,{attributes:!0}),r.setAttribute("i","1")}:()=>{setTimeout(os,0)},Cn=function(r,t){wn.push([r,t]),Ps&&(Iu(),Ps=!1)},Ti=!0,Ps=!0,Er=[],_s=[],Pi=null,ji=jn,Wr={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:to,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(r=>{try{to(r[0],r[1])}catch{}})}},ee=Wr,wn=[],Cr=0,vs=[];function q(r){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Ae,this._lib=!1;var t=this._PSD=ee;if(Ot&&(this._stackHolder=jr(),this._prev=null,this._numPrev=0),typeof r!="function"){if(r!==In)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Oi(this,this._value))}this._state=null,this._value=null,++t.ref,jl(this,r)}const Ii={get:function(){var r=ee,t=js;function e(n,s){var i=!r.global&&(r!==ee||t!==js);const a=i&&!Yt();var o=new q((l,f)=>{oa(this,new Pl(Is(n,r,i,a),Is(s,r,i,a),l,f,r))});return Ot&&Ll(o,this),o}return e.prototype=In,e},set:function(r){Ht(this,"then",r&&r.prototype===In?Ii:{get:function(){return r},set:Ii.set})}};function Pl(r,t,e,n,s){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof t=="function"?t:null,this.resolve=e,this.reject=n,this.psd=s}function jl(r,t){try{t(e=>{if(r._state===null){if(e===r)throw new TypeError("A promise cannot be resolved with itself.");var n=r._lib&&Gn();e&&typeof e.then=="function"?jl(r,(s,i)=>{e instanceof q?e._then(s,i):e.then(s,i)}):(r._state=!0,r._value=e,Il(r)),n&&Un()}},Oi.bind(null,r))}catch(e){Oi(r,e)}}function Oi(r,t){if(_s.push(t),r._state===null){var e=r._lib&&Gn();t=ji(t),r._state=!1,r._value=t,Ot&&t!==null&&typeof t=="object"&&!t._promise&&function(n,s,i){try{n.apply(null,i)}catch(a){s&&s(a)}}(()=>{var n=ta(t,"stack");t._promise=r,Ht(t,"stack",{get:()=>Ai?n&&(n.get?n.get.apply(t):n.value):r.stack})}),function(n){Er.some(s=>s._value===n._value)||Er.push(n)}(r),Il(r),e&&Un()}}function Il(r){var t=r._listeners;r._listeners=[];for(var e=0,n=t.length;e<n;++e)oa(r,t[e]);var s=r._PSD;--s.ref||s.finalize(),Cr===0&&(++Cr,Cn(()=>{--Cr==0&&la()},[]))}function oa(r,t){if(r._state!==null){var e=r._state?t.onFulfilled:t.onRejected;if(e===null)return(r._state?t.resolve:t.reject)(r._value);++t.psd.ref,++Cr,Cn(Ou,[e,r,t])}else r._listeners.push(t)}function Ou(r,t,e){try{Pi=t;var n,s=t._value;t._state?n=r(s):(_s.length&&(_s=[]),n=r(s),_s.indexOf(s)===-1&&function(i){for(var a=Er.length;a;)if(Er[--a]._value===i._value)return void Er.splice(a,1)}(t)),e.resolve(n)}catch(i){e.reject(i)}finally{Pi=null,--Cr==0&&la(),--e.psd.ref||e.psd.finalize()}}function Ol(r,t,e){if(t.length===e)return t;var n="";if(r._state===!1){var s,i,a=r._value;a!=null?(s=a.name||"Error",i=a.message||a,n=xi(a,0)):(s=a,i=""),t.push(s+(i?": "+i:"")+n)}return Ot&&((n=xi(r._stackHolder,2))&&t.indexOf(n)===-1&&t.push(n),r._prev&&Ol(r._prev,t,e)),t}function Ll(r,t){var e=t?t._numPrev+1:0;e<100&&(r._prev=t,r._numPrev=e)}function os(){Gn()&&Un()}function Gn(){var r=Ti;return Ti=!1,Ps=!1,r}function Un(){var r,t,e;do for(;wn.length>0;)for(r=wn,wn=[],e=r.length,t=0;t<e;++t){var n=r[t];n[0].apply(null,n[1])}while(wn.length>0);Ti=!0,Ps=!0}function la(){var r=Er;Er=[],r.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=vs.slice(0),e=t.length;e;)t[--e]()}function ls(r){return new q(In,!1,r)}function Ie(r,t){var e=ee;return function(){var n=Gn(),s=ee;try{return lr(e,!0),r.apply(this,arguments)}catch(i){t&&t(i)}finally{lr(s,!1),n&&Un()}}}tn(q.prototype,{then:Ii,_then:function(r,t){oa(this,new Pl(null,null,r,t,ee))},catch:function(r){if(arguments.length===1)return this.then(null,r);var t=arguments[0],e=arguments[1];return typeof t=="function"?this.then(null,n=>n instanceof t?e(n):ls(n)):this.then(null,n=>n&&n.name===t?e(n):ls(n))},finally:function(r){return this.then(t=>(r(),t),t=>(r(),ls(t)))},stack:{get:function(){if(this._stack)return this._stack;try{Ai=!0;var r=Ol(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=r),r}finally{Ai=!1}}},timeout:function(r,t){return r<1/0?new q((e,n)=>{var s=setTimeout(()=>n(new oe.Timeout(t)),r);this.then(e,n).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Ht(q.prototype,Symbol.toStringTag,"Dexie.Promise"),Wr.env=Dl(),tn(q,{all:function(){var r=Gt.apply(null,arguments).map(cs);return new q(function(t,e){r.length===0&&t([]);var n=r.length;r.forEach((s,i)=>q.resolve(s).then(a=>{r[i]=a,--n||t(r)},e))})},resolve:r=>{if(r instanceof q)return r;if(r&&typeof r.then=="function")return new q((e,n)=>{r.then(e,n)});var t=new q(In,!0,r);return Ll(t,Pi),t},reject:ls,race:function(){var r=Gt.apply(null,arguments).map(cs);return new q((t,e)=>{r.map(n=>q.resolve(n).then(t,e))})},PSD:{get:()=>ee,set:r=>ee=r},totalEchoes:{get:()=>js},newPSD:or,usePSD:an,scheduler:{get:()=>Cn,set:r=>{Cn=r}},rejectionMapper:{get:()=>ji,set:r=>{ji=r}},follow:(r,t)=>new q((e,n)=>or((s,i)=>{var a=ee;a.unhandleds=[],a.onunhandled=i,a.finalize=Sr(function(){(function(o){function l(){o(),vs.splice(vs.indexOf(l),1)}vs.push(l),++Cr,Cn(()=>{--Cr==0&&la()},[])})(()=>{this.unhandleds.length===0?s():i(this.unhandleds[0])})},a.finalize),r()},t,e,n))}),ys&&(ys.allSettled&&Ht(q,"allSettled",function(){const r=Gt.apply(null,arguments).map(cs);return new q(t=>{r.length===0&&t([]);let e=r.length;const n=new Array(e);r.forEach((s,i)=>q.resolve(s).then(a=>n[i]={status:"fulfilled",value:a},a=>n[i]={status:"rejected",reason:a}).then(()=>--e||t(n)))})}),ys.any&&typeof AggregateError<"u"&&Ht(q,"any",function(){const r=Gt.apply(null,arguments).map(cs);return new q((t,e)=>{r.length===0&&e(new AggregateError([]));let n=r.length;const s=new Array(n);r.forEach((i,a)=>q.resolve(i).then(o=>t(o),o=>{s[a]=o,--n||e(new AggregateError(s))}))})}));const Xe={awaits:0,echoes:0,id:0};var Lu=0,$s=[],oi=0,js=0,Du=0;function or(r,t,e,n){var s=ee,i=Object.create(s);i.parent=s,i.ref=0,i.global=!1,i.id=++Du;var a=Wr.env;i.env=aa?{Promise:q,PromiseProp:{value:q,configurable:!0,writable:!0},all:q.all,race:q.race,allSettled:q.allSettled,any:q.any,resolve:q.resolve,reject:q.reject,nthen:Ja(a.nthen,i),gthen:Ja(a.gthen,i)}:{},t&&et(i,t),++s.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=an(i,r,e,n);return i.ref===0&&i.finalize(),o}function sn(){return Xe.id||(Xe.id=++Lu),++Xe.awaits,Xe.echoes+=Al,Xe.id}function Yt(){return!!Xe.awaits&&(--Xe.awaits==0&&(Xe.id=0),Xe.echoes=Xe.awaits*Al,!0)}function cs(r){return Xe.echoes&&r&&r.constructor===ys?(sn(),r.then(t=>(Yt(),t),t=>(Yt(),qe(t)))):r}function Mu(r){++js,Xe.echoes&&--Xe.echoes!=0||(Xe.echoes=Xe.id=0),$s.push(ee),lr(r,!0)}function Nu(){var r=$s[$s.length-1];$s.pop(),lr(r,!1)}function lr(r,t){var e=ee;if((t?!Xe.echoes||oi++&&r===ee:!oi||--oi&&r===ee)||Ml(t?Mu.bind(null,r):Nu),r!==ee&&(ee=r,e===Wr&&(Wr.env=Dl()),aa)){var n=Wr.env.Promise,s=r.env;Ts.then=s.nthen,n.prototype.then=s.gthen,(e.global||r.global)&&(Object.defineProperty(je,"Promise",s.PromiseProp),n.all=s.all,n.race=s.race,n.resolve=s.resolve,n.reject=s.reject,s.allSettled&&(n.allSettled=s.allSettled),s.any&&(n.any=s.any))}}function Dl(){var r=je.Promise;return aa?{Promise:r,PromiseProp:Object.getOwnPropertyDescriptor(je,"Promise"),all:r.all,race:r.race,allSettled:r.allSettled,any:r.any,resolve:r.resolve,reject:r.reject,nthen:Ts.then,gthen:r.prototype.then}:{}}function an(r,t,e,n,s){var i=ee;try{return lr(r,!0),t(e,n,s)}finally{lr(i,!1)}}function Ml(r){Tl.call(ki,r)}function Is(r,t,e,n){return typeof r!="function"?r:function(){var s=ee;e&&sn(),lr(t,!0);try{return r.apply(this,arguments)}finally{lr(s,!1),n&&Ml(Yt)}}}function Ja(r,t){return function(e,n){return r.call(this,Is(e,t),Is(n,t))}}(""+Tl).indexOf("[native code]")===-1&&(sn=Yt=Ae);const eo="unhandledrejection";function to(r,t){var e;try{e=t.onuncatched(r)}catch{}if(e!==!1)try{var n,s={promise:t,reason:r};if(je.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(eo,!0,!0),et(n,s)):je.CustomEvent&&et(n=new CustomEvent(eo,{detail:s}),s),n&&je.dispatchEvent&&(dispatchEvent(n),!je.PromiseRejectionEvent&&je.onunhandledrejection))try{je.onunhandledrejection(n)}catch{}Ot&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${r.stack||r}`)}catch{}}var qe=q.reject;function Li(r,t,e,n){if(r.idbdb&&(r._state.openComplete||ee.letThrough||r._vip)){var s=r._createTransaction(t,e,r._dbSchema);try{s.create(),r._state.PR1398_maxLoop=3}catch(i){return i.name===sa.InvalidState&&r.isOpen()&&--r._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),r._close(),r.open().then(()=>Li(r,t,e,n))):qe(i)}return s._promise(t,(i,a)=>or(()=>(ee.trans=s,n(i,a,s)))).then(i=>s._completion.then(()=>i))}if(r._state.openComplete)return qe(new oe.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._options.autoOpen)return qe(new oe.DatabaseClosed);r.open().catch(Ae)}return r._state.dbReadyPromise.then(()=>Li(r,t,e,n))}const ro="3.2.4",vr=String.fromCharCode(65535),Di=-1/0,Rt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Nl="String expected.",xn=[],Vs=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Fu=Vs,Ku=Vs,Fl=r=>!/(dexie\.js|dexie\.min\.js)/.test(r),Gs="__dbnames",li="readonly",ci="readwrite";function Ar(r,t){return r?t?function(){return r.apply(this,arguments)&&t.apply(this,arguments)}:r:t}const Kl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function us(r){return typeof r!="string"||/\./.test(r)?t=>t:t=>(t[r]===void 0&&r in t&&delete(t=Vn(t))[r],t)}class Ru{_trans(t,e,n){const s=this._tx||ee.trans,i=this.name;function a(l,f,c){if(!c.schema[i])throw new oe.NotFound("Table "+i+" not part of transaction");return e(c.idbtrans,c)}const o=Gn();try{return s&&s.db===this.db?s===ee.trans?s._promise(t,a,n):or(()=>s._promise(t,a,n),{trans:s,transless:ee.transless||ee}):Li(this.db,t,[this.name],a)}finally{o&&Un()}}get(t,e){return t&&t.constructor===Object?this.where(t).first(e):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(s=>this.hook.reading.fire(s))).then(e)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(Ze(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const e=ze(t);if(e.length===1)return this.where(e[0]).equals(t[e[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(f=>f.compound&&e.every(c=>f.keyPath.indexOf(c)>=0)&&f.keyPath.every(c=>e.indexOf(c)>=0))[0];if(n&&this.db._maxKey!==vr)return this.where(n.name).equals(n.keyPath.map(f=>t[f]));!n&&Ot&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${e.join("+")}]`);const{idxByName:s}=this.schema,i=this.db._deps.indexedDB;function a(f,c){try{return i.cmp(f,c)===0}catch{return!1}}const[o,l]=e.reduce(([f,c],h)=>{const d=s[h],y=t[h];return[f||d,f||!d?Ar(c,d&&d.multi?$=>{const v=Wt($,h);return Ze(v)&&v.some(A=>a(y,A))}:$=>a(y,Wt($,h))):c]},[null,null]);return o?this.where(o.name).equals(t[o.keyPath]).filter(l):n?this.filter(l):this.where(e).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,Ze(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const e=n=>{if(!n)return n;const s=Object.create(t.prototype);for(var i in n)if(ht(n,i))try{s[i]=n[i]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=e,this.hook("reading",e),t}defineClass(){return this.mapToClass(function(t){et(this,t)})}add(t,e){const{auto:n,keyPath:s}=this.schema.primKey;let i=t;return s&&n&&(i=us(s)(t)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"add",keys:e!=null?[e]:null,values:[i]})).then(a=>a.numFailures?q.reject(a.failures[0]):a.lastResult).then(a=>{if(s)try{Et(t,s,a)}catch{}return a})}update(t,e){if(typeof t!="object"||Ze(t))return this.where(":id").equals(t).modify(e);{const n=Wt(t,this.schema.primKey.keyPath);if(n===void 0)return qe(new oe.InvalidArgument("Given object does not contain its primary key"));try{typeof e!="function"?ze(e).forEach(s=>{Et(t,s,e[s])}):e(t,{value:t,primKey:n})}catch{}return this.where(":id").equals(n).modify(e)}}put(t,e){const{auto:n,keyPath:s}=this.schema.primKey;let i=t;return s&&n&&(i=us(s)(t)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"put",values:[i],keys:e!=null?[e]:null})).then(a=>a.numFailures?q.reject(a.failures[0]):a.lastResult).then(a=>{if(s)try{Et(t,s,a)}catch{}return a})}delete(t){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"delete",keys:[t]})).then(e=>e.numFailures?q.reject(e.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:Kl})).then(t=>t.numFailures?q.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",e=>this.core.getMany({keys:t,trans:e}).then(n=>n.map(s=>this.hook.reading.fire(s))))}bulkAdd(t,e,n){const s=Array.isArray(e)?e:void 0,i=(n=n||(s?void 0:e))?n.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&s)throw new oe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");const f=t.length;let c=l&&o?t.map(us(l)):t;return this.core.mutate({trans:a,type:"add",keys:s,values:c,wantResults:i}).then(({numFailures:h,results:d,lastResult:y,failures:$})=>{if(h===0)return i?d:y;throw new En(`${this.name}.bulkAdd(): ${h} of ${f} operations failed`,$)})})}bulkPut(t,e,n){const s=Array.isArray(e)?e:void 0,i=(n=n||(s?void 0:e))?n.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&s)throw new oe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");const f=t.length;let c=l&&o?t.map(us(l)):t;return this.core.mutate({trans:a,type:"put",keys:s,values:c,wantResults:i}).then(({numFailures:h,results:d,lastResult:y,failures:$})=>{if(h===0)return i?d:y;throw new En(`${this.name}.bulkPut(): ${h} of ${f} operations failed`,$)})})}bulkDelete(t){const e=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:s,failures:i})=>{if(n===0)return s;throw new En(`${this.name}.bulkDelete(): ${n} of ${e} operations failed`,i)})}}function kn(r){var t={},e=function(a,o){if(o){for(var l=arguments.length,f=new Array(l-1);--l;)f[l-1]=arguments[l];return t[a].subscribe.apply(null,f),r}if(typeof a=="string")return t[a]};e.addEventType=i;for(var n=1,s=arguments.length;n<s;++n)i(arguments[n]);return e;function i(a,o,l){if(typeof a!="object"){var f;o||(o=ju),l||(l=Ae);var c={subscribers:[],fire:l,subscribe:function(h){c.subscribers.indexOf(h)===-1&&(c.subscribers.push(h),c.fire=o(c.fire,h))},unsubscribe:function(h){c.subscribers=c.subscribers.filter(function(d){return d!==h}),c.fire=c.subscribers.reduce(o,l)}};return t[a]=e[a]=c,c}ze(f=a).forEach(function(h){var d=f[h];if(Ze(d))i(h,f[h][0],f[h][1]);else{if(d!=="asap")throw new oe.InvalidArgument("Invalid event config");var y=i(h,jn,function(){for(var $=arguments.length,v=new Array($);$--;)v[$]=arguments[$];y.subscribers.forEach(function(A){_l(function(){A.apply(null,v)})})})}})}}function vn(r,t){return qr(t).from({prototype:r}),t}function Br(r,t){return!(r.filter||r.algorithm||r.or)&&(t?r.justLimit:!r.replayFilter)}function ui(r,t){r.filter=Ar(r.filter,t)}function fi(r,t,e){var n=r.replayFilter;r.replayFilter=n?()=>Ar(n(),t()):t,r.justLimit=e&&!n}function ws(r,t){if(r.isPrimKey)return t.primaryKey;const e=t.getIndexByKeyPath(r.index);if(!e)throw new oe.Schema("KeyPath "+r.index+" on object store "+t.name+" is not indexed");return e}function no(r,t,e){const n=ws(r,t.schema);return t.openCursor({trans:e,values:!r.keysOnly,reverse:r.dir==="prev",unique:!!r.unique,query:{index:n,range:r.range}})}function fs(r,t,e,n){const s=r.replayFilter?Ar(r.filter,r.replayFilter()):r.filter;if(r.or){const i={},a=(o,l,f)=>{if(!s||s(l,f,d=>l.stop(d),d=>l.fail(d))){var c=l.primaryKey,h=""+c;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(c)),ht(i,h)||(i[h]=!0,t(o,l,f))}};return Promise.all([r.or._iterate(a,e),so(no(r,n,e),r.algorithm,a,!r.keysOnly&&r.valueMapper)])}return so(no(r,n,e),Ar(r.algorithm,s),t,!r.keysOnly&&r.valueMapper)}function so(r,t,e,n){var s=Ie(n?(i,a,o)=>e(n(i),a,o):e);return r.then(i=>{if(i)return i.start(()=>{var a=()=>i.continue();t&&!t(i,o=>a=o,o=>{i.stop(o),a=Ae},o=>{i.fail(o),a=Ae})||s(i.value,i,o=>a=o),a()})})}function Qe(r,t){try{const e=io(r),n=io(t);if(e!==n)return e==="Array"?1:n==="Array"?-1:e==="binary"?1:n==="binary"?-1:e==="string"?1:n==="string"?-1:e==="Date"?1:n!=="Date"?NaN:-1;switch(e){case"number":case"Date":case"string":return r>t?1:r<t?-1:0;case"binary":return function(s,i){const a=s.length,o=i.length,l=a<o?a:o;for(let f=0;f<l;++f)if(s[f]!==i[f])return s[f]<i[f]?-1:1;return a===o?0:a<o?-1:1}(ao(r),ao(t));case"Array":return function(s,i){const a=s.length,o=i.length,l=a<o?a:o;for(let f=0;f<l;++f){const c=Qe(s[f],i[f]);if(c!==0)return c}return a===o?0:a<o?-1:1}(r,t)}}catch{}return NaN}function io(r){const t=typeof r;if(t!=="object")return t;if(ArrayBuffer.isView(r))return"binary";const e=Ei(r);return e==="ArrayBuffer"?"binary":e}function ao(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r)}class Bu{_read(t,e){var n=this._ctx;return n.error?n.table._trans(null,qe.bind(null,n.error)):n.table._trans("readonly",t).then(e)}_write(t){var e=this._ctx;return e.error?e.table._trans(null,qe.bind(null,e.error)):e.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var e=this._ctx;e.algorithm=Ar(e.algorithm,t)}_iterate(t,e){return fs(this._ctx,t,e,this._ctx.table.core)}clone(t){var e=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&et(n,t),e._ctx=n,e}raw(){return this._ctx.valueMapper=null,this}each(t){var e=this._ctx;return this._read(n=>fs(e,t,n,e.table.core))}count(t){return this._read(e=>{const n=this._ctx,s=n.table.core;if(Br(n,!0))return s.count({trans:e,query:{index:ws(n,s.schema),range:n.range}}).then(a=>Math.min(a,n.limit));var i=0;return fs(n,()=>(++i,!1),e,s).then(()=>i)}).then(t)}sortBy(t,e){const n=t.split(".").reverse(),s=n[0],i=n.length-1;function a(f,c){return c?a(f[n[c]],c-1):f[s]}var o=this._ctx.dir==="next"?1:-1;function l(f,c){var h=a(f,i),d=a(c,i);return h<d?-o:h>d?o:0}return this.toArray(function(f){return f.sort(l)}).then(e)}toArray(t){return this._read(e=>{var n=this._ctx;if(n.dir==="next"&&Br(n,!0)&&n.limit>0){const{valueMapper:s}=n,i=ws(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then(({result:a})=>s?a.map(s):a)}{const s=[];return fs(n,i=>s.push(i),e,n.table.core).then(()=>s)}},t)}offset(t){var e=this._ctx;return t<=0||(e.offset+=t,Br(e)?fi(e,()=>{var n=t;return(s,i)=>n===0||(n===1?(--n,!1):(i(()=>{s.advance(n),n=0}),!1))}):fi(e,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),fi(this._ctx,()=>{var e=t;return function(n,s,i){return--e<=0&&s(i),e>=0}},!0),this}until(t,e){return ui(this._ctx,function(n,s,i){return!t(n.value)||(s(i),e)}),this}first(t){return this.limit(1).toArray(function(e){return e[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var e,n;return ui(this._ctx,function(s){return t(s.value)}),e=this._ctx,n=t,e.isMatch=Ar(e.isMatch,n),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(n,s){t(s.key,s)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(n,s){t(s.primaryKey,s)})}keys(t){var e=this._ctx;e.keysOnly=!e.isMatch;var n=[];return this.each(function(s,i){n.push(i.key)}).then(function(){return n}).then(t)}primaryKeys(t){var e=this._ctx;if(e.dir==="next"&&Br(e,!0)&&e.limit>0)return this._read(s=>{var i=ws(e,e.table.core.schema);return e.table.core.query({trans:s,values:!1,limit:e.limit,query:{index:i,range:e.range}})}).then(({result:s})=>s).then(t);e.keysOnly=!e.isMatch;var n=[];return this.each(function(s,i){n.push(i.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(e){return e[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,e=t.index&&t.table.schema.idxByName[t.index];if(!e||!e.multi)return this;var n={};return ui(this._ctx,function(s){var i=s.primaryKey.toString(),a=ht(n,i);return n[i]=!0,!a}),this}modify(t){var e=this._ctx;return this._write(n=>{var s;if(typeof t=="function")s=t;else{var i=ze(t),a=i.length;s=function(v){for(var A=!1,x=0;x<a;++x){var S=i[x],D=t[S];Wt(v,S)!==D&&(Et(v,S,D),A=!0)}return A}}const o=e.table.core,{outbound:l,extractKey:f}=o.schema.primaryKey,c=this.db._options.modifyChunkSize||200,h=[];let d=0;const y=[],$=(v,A)=>{const{failures:x,numFailures:S}=A;d+=v-S;for(let D of ze(x))h.push(x[D])};return this.clone().primaryKeys().then(v=>{const A=x=>{const S=Math.min(c,v.length-x);return o.getMany({trans:n,keys:v.slice(x,x+S),cache:"immutable"}).then(D=>{const P=[],O=[],j=l?[]:null,L=[];for(let F=0;F<S;++F){const V=D[F],G={value:Vn(V),primKey:v[x+F]};s.call(G,G.value,G)!==!1&&(G.value==null?L.push(v[x+F]):l||Qe(f(V),f(G.value))===0?(O.push(G.value),l&&j.push(v[x+F])):(L.push(v[x+F]),P.push(G.value)))}const N=Br(e)&&e.limit===1/0&&(typeof t!="function"||t===hi)&&{index:e.index,range:e.range};return Promise.resolve(P.length>0&&o.mutate({trans:n,type:"add",values:P}).then(F=>{for(let V in F.failures)L.splice(parseInt(V),1);$(P.length,F)})).then(()=>(O.length>0||N&&typeof t=="object")&&o.mutate({trans:n,type:"put",keys:j,values:O,criteria:N,changeSpec:typeof t!="function"&&t}).then(F=>$(O.length,F))).then(()=>(L.length>0||N&&t===hi)&&o.mutate({trans:n,type:"delete",keys:L,criteria:N}).then(F=>$(L.length,F))).then(()=>v.length>x+S&&A(x+c))})};return A(0).then(()=>{if(h.length>0)throw new As("Error modifying one or more objects",h,d,y);return v.length})})})}delete(){var t=this._ctx,e=t.range;return Br(t)&&(t.isPrimKey&&!Ku||e.type===3)?this._write(n=>{const{primaryKey:s}=t.table.core.schema,i=e;return t.table.core.count({trans:n,query:{index:s,range:i}}).then(a=>t.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(({failures:o,lastResult:l,results:f,numFailures:c})=>{if(c)throw new As("Could not delete some values",Object.keys(o).map(h=>o[h]),a-c);return a-c}))}):this.modify(hi)}}const hi=(r,t)=>t.value=null;function zu(r,t){return r<t?-1:r===t?0:1}function Vu(r,t){return r>t?-1:r===t?0:1}function ft(r,t,e){var n=r instanceof Bl?new r.Collection(r):r;return n._ctx.error=e?new e(t):new TypeError(t),n}function zr(r){return new r.Collection(r,()=>Rl("")).limit(0)}function Gu(r,t,e,n,s,i){for(var a=Math.min(r.length,n.length),o=-1,l=0;l<a;++l){var f=t[l];if(f!==n[l])return s(r[l],e[l])<0?r.substr(0,l)+e[l]+e.substr(l+1):s(r[l],n[l])<0?r.substr(0,l)+n[l]+e.substr(l+1):o>=0?r.substr(0,o)+t[o]+e.substr(o+1):null;s(r[l],f)<0&&(o=l)}return a<n.length&&i==="next"?r+e.substr(r.length):a<r.length&&i==="prev"?r.substr(0,e.length):o<0?null:r.substr(0,o)+n[o]+e.substr(o+1)}function hs(r,t,e,n){var s,i,a,o,l,f,c,h=e.length;if(!e.every(v=>typeof v=="string"))return ft(r,Nl);function d(v){s=function(x){return x==="next"?S=>S.toUpperCase():S=>S.toLowerCase()}(v),i=function(x){return x==="next"?S=>S.toLowerCase():S=>S.toUpperCase()}(v),a=v==="next"?zu:Vu;var A=e.map(function(x){return{lower:i(x),upper:s(x)}}).sort(function(x,S){return a(x.lower,S.lower)});o=A.map(function(x){return x.upper}),l=A.map(function(x){return x.lower}),f=v,c=v==="next"?"":n}d("next");var y=new r.Collection(r,()=>tr(o[0],l[h-1]+n));y._ondirectionchange=function(v){d(v)};var $=0;return y._addAlgorithm(function(v,A,x){var S=v.key;if(typeof S!="string")return!1;var D=i(S);if(t(D,l,$))return!0;for(var P=null,O=$;O<h;++O){var j=Gu(S,D,o[O],l[O],a,f);j===null&&P===null?$=O+1:(P===null||a(P,j)>0)&&(P=j)}return A(P!==null?function(){v.continue(P+c)}:x),!1}),y}function tr(r,t,e,n){return{type:2,lower:r,upper:t,lowerOpen:e,upperOpen:n}}function Rl(r){return{type:1,lower:r,upper:r}}class Bl{get Collection(){return this._ctx.table.db.Collection}between(t,e,n,s){n=n!==!1,s=s===!0;try{return this._cmp(t,e)>0||this._cmp(t,e)===0&&(n||s)&&(!n||!s)?zr(this):new this.Collection(this,()=>tr(t,e,!n,!s))}catch{return ft(this,Rt)}}equals(t){return t==null?ft(this,Rt):new this.Collection(this,()=>Rl(t))}above(t){return t==null?ft(this,Rt):new this.Collection(this,()=>tr(t,void 0,!0))}aboveOrEqual(t){return t==null?ft(this,Rt):new this.Collection(this,()=>tr(t,void 0,!1))}below(t){return t==null?ft(this,Rt):new this.Collection(this,()=>tr(void 0,t,!1,!0))}belowOrEqual(t){return t==null?ft(this,Rt):new this.Collection(this,()=>tr(void 0,t))}startsWith(t){return typeof t!="string"?ft(this,Nl):this.between(t,t+vr,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):hs(this,(e,n)=>e.indexOf(n[0])===0,[t],vr)}equalsIgnoreCase(t){return hs(this,(e,n)=>e===n[0],[t],"")}anyOfIgnoreCase(){var t=Gt.apply(Vr,arguments);return t.length===0?zr(this):hs(this,(e,n)=>n.indexOf(e)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=Gt.apply(Vr,arguments);return t.length===0?zr(this):hs(this,(e,n)=>n.some(s=>e.indexOf(s)===0),t,vr)}anyOf(){const t=Gt.apply(Vr,arguments);let e=this._cmp;try{t.sort(e)}catch{return ft(this,Rt)}if(t.length===0)return zr(this);const n=new this.Collection(this,()=>tr(t[0],t[t.length-1]));n._ondirectionchange=i=>{e=i==="next"?this._ascending:this._descending,t.sort(e)};let s=0;return n._addAlgorithm((i,a,o)=>{const l=i.key;for(;e(l,t[s])>0;)if(++s,s===t.length)return a(o),!1;return e(l,t[s])===0||(a(()=>{i.continue(t[s])}),!1)}),n}notEqual(t){return this.inAnyRange([[Di,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=Gt.apply(Vr,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return ft(this,Rt)}const e=t.reduce((n,s)=>n?n.concat([[n[n.length-1][1],s]]):[[Di,s]],null);return e.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,e){const n=this._cmp,s=this._ascending,i=this._descending,a=this._min,o=this._max;if(t.length===0)return zr(this);if(!t.every(S=>S[0]!==void 0&&S[1]!==void 0&&s(S[0],S[1])<=0))return ft(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",oe.InvalidArgument);const l=!e||e.includeLowers!==!1,f=e&&e.includeUppers===!0;let c,h=s;function d(S,D){return h(S[0],D[0])}try{c=t.reduce(function(S,D){let P=0,O=S.length;for(;P<O;++P){const j=S[P];if(n(D[0],j[1])<0&&n(D[1],j[0])>0){j[0]=a(j[0],D[0]),j[1]=o(j[1],D[1]);break}}return P===O&&S.push(D),S},[]),c.sort(d)}catch{return ft(this,Rt)}let y=0;const $=f?S=>s(S,c[y][1])>0:S=>s(S,c[y][1])>=0,v=l?S=>i(S,c[y][0])>0:S=>i(S,c[y][0])>=0;let A=$;const x=new this.Collection(this,()=>tr(c[0][0],c[c.length-1][1],!l,!f));return x._ondirectionchange=S=>{S==="next"?(A=$,h=s):(A=v,h=i),c.sort(d)},x._addAlgorithm((S,D,P)=>{for(var O=S.key;A(O);)if(++y,y===c.length)return D(P),!1;return!!function(j){return!$(j)&&!v(j)}(O)||(this._cmp(O,c[y][1])===0||this._cmp(O,c[y][0])===0||D(()=>{h===s?S.continue(c[y][0]):S.continue(c[y][1])}),!1)}),x}startsWithAnyOf(){const t=Gt.apply(Vr,arguments);return t.every(e=>typeof e=="string")?t.length===0?zr(this):this.inAnyRange(t.map(e=>[e,e+vr])):ft(this,"startsWithAnyOf() only works with strings")}}function Pt(r){return Ie(function(t){return On(t),r(t.target.error),!1})}function On(r){r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault()}const Ln="storagemutated",nr="x-storagemutated-1",cr=kn(null,Ln);class Uu{_lock(){return $n(!ee.global),++this._reculock,this._reculock!==1||ee.global||(ee.lockOwnerFor=this),this}_unlock(){if($n(!ee.global),--this._reculock==0)for(ee.global||(ee.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{an(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&ee.lockOwnerFor!==this}create(t){if(!this.mode)return this;const e=this.db.idbdb,n=this.db._state.dbOpenError;if($n(!this.idbtrans),!t&&!e)switch(n&&n.name){case"DatabaseClosedError":throw new oe.DatabaseClosed(n);case"MissingAPIError":throw new oe.MissingAPI(n.message,n);default:throw new oe.OpenFailed(n)}if(!this.active)throw new oe.TransactionInactive;return $n(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):e.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Ie(s=>{On(s),this._reject(t.error)}),t.onabort=Ie(s=>{On(s),this.active&&this._reject(new oe.Abort(t.error)),this.active=!1,this.on("abort").fire(s)}),t.oncomplete=Ie(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&cr.storagemutated.fire(t.mutatedParts)}),this}_promise(t,e,n){if(t==="readwrite"&&this.mode!=="readwrite")return qe(new oe.ReadOnly("Transaction is readonly"));if(!this.active)return qe(new oe.TransactionInactive);if(this._locked())return new q((i,a)=>{this._blockedFuncs.push([()=>{this._promise(t,e,n).then(i,a)},ee])});if(n)return or(()=>{var i=new q((a,o)=>{this._lock();const l=e(a,o,this);l&&l.then&&l.then(a,o)});return i.finally(()=>this._unlock()),i._lib=!0,i});var s=new q((i,a)=>{var o=e(i,a,this);o&&o.then&&o.then(i,a)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(t){var e=this._root();const n=q.resolve(t);if(e._waitingFor)e._waitingFor=e._waitingFor.then(()=>n);else{e._waitingFor=n,e._waitingQueue=[];var s=e.idbtrans.objectStore(e.storeNames[0]);(function a(){for(++e._spinCount;e._waitingQueue.length;)e._waitingQueue.shift()();e._waitingFor&&(s.get(-1/0).onsuccess=a)})()}var i=e._waitingFor;return new q((a,o)=>{n.then(l=>e._waitingQueue.push(Ie(a.bind(null,l))),l=>e._waitingQueue.push(Ie(o.bind(null,l)))).finally(()=>{e._waitingFor===i&&(e._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new oe.Abort))}table(t){const e=this._memoizedTables||(this._memoizedTables={});if(ht(e,t))return e[t];const n=this.schema[t];if(!n)throw new oe.NotFound("Table "+t+" not part of transaction");const s=new this.db.Table(t,n,this);return s.core=this.db.core.table(t),e[t]=s,s}}function Mi(r,t,e,n,s,i,a){return{name:r,keyPath:t,unique:e,multi:n,auto:s,compound:i,src:(e&&!a?"&":"")+(n?"*":"")+(s?"++":"")+zl(t)}}function zl(r){return typeof r=="string"?r:r?"["+[].join.call(r,"+")+"]":""}function Vl(r,t,e){return{name:r,primKey:t,indexes:e,mappedClass:null,idxByName:vl(e,n=>[n.name,n])}}let Dn=r=>{try{return r.only([[]]),Dn=()=>[[]],[[]]}catch{return Dn=()=>vr,vr}};function Ni(r){return r==null?()=>{}:typeof r=="string"?function(t){return t.split(".").length===1?n=>n[t]:n=>Wt(n,t)}(r):t=>Wt(t,r)}function oo(r){return[].slice.call(r)}let qu=0;function Sn(r){return r==null?":id":typeof r=="string"?r:`[${r.join("+")}]`}function Hu(r,t,e){function n(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:f,upper:c,lowerOpen:h,upperOpen:d}=l;return f===void 0?c===void 0?null:t.upperBound(c,!!d):c===void 0?t.lowerBound(f,!!h):t.bound(f,c,!!h,!!d)}const{schema:s,hasGetAll:i}=function(l,f){const c=oo(l.objectStoreNames);return{schema:{name:l.name,tables:c.map(h=>f.objectStore(h)).map(h=>{const{keyPath:d,autoIncrement:y}=h,$=Ze(d),v=d==null,A={},x={name:h.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:v,compound:$,keyPath:d,autoIncrement:y,unique:!0,extractKey:Ni(d)},indexes:oo(h.indexNames).map(S=>h.index(S)).map(S=>{const{name:D,unique:P,multiEntry:O,keyPath:j}=S,L={name:D,compound:Ze(j),keyPath:j,unique:P,multiEntry:O,extractKey:Ni(j)};return A[Sn(j)]=L,L}),getIndexByKeyPath:S=>A[Sn(S)]};return A[":id"]=x.primaryKey,d!=null&&(A[Sn(d)]=x.primaryKey),x})},hasGetAll:c.length>0&&"getAll"in f.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(r,e),a=s.tables.map(l=>function(f){const c=f.name;return{name:c,schema:f,mutate:function({trans:h,type:d,keys:y,values:$,range:v}){return new Promise((A,x)=>{A=Ie(A);const S=h.objectStore(c),D=S.keyPath==null,P=d==="put"||d==="add";if(!P&&d!=="delete"&&d!=="deleteRange")throw new Error("Invalid operation type: "+d);const{length:O}=y||$||{length:1};if(y&&$&&y.length!==$.length)throw new Error("Given keys array must have same length as given values array.");if(O===0)return A({numFailures:0,failures:{},results:[],lastResult:void 0});let j;const L=[],N=[];let F=0;const V=Y=>{++F,On(Y)};if(d==="deleteRange"){if(v.type===4)return A({numFailures:F,failures:N,results:[],lastResult:void 0});v.type===3?L.push(j=S.clear()):L.push(j=S.delete(n(v)))}else{const[Y,pe]=P?D?[$,y]:[$,null]:[y,null];if(P)for(let ce=0;ce<O;++ce)L.push(j=pe&&pe[ce]!==void 0?S[d](Y[ce],pe[ce]):S[d](Y[ce])),j.onerror=V;else for(let ce=0;ce<O;++ce)L.push(j=S[d](Y[ce])),j.onerror=V}const G=Y=>{const pe=Y.target.result;L.forEach((ce,$e)=>ce.error!=null&&(N[$e]=ce.error)),A({numFailures:F,failures:N,results:d==="delete"?y:L.map(ce=>ce.result),lastResult:pe})};j.onerror=Y=>{V(Y),G(Y)},j.onsuccess=G})},getMany:({trans:h,keys:d})=>new Promise((y,$)=>{y=Ie(y);const v=h.objectStore(c),A=d.length,x=new Array(A);let S,D=0,P=0;const O=L=>{const N=L.target;x[N._pos]=N.result,++P===D&&y(x)},j=Pt($);for(let L=0;L<A;++L)d[L]!=null&&(S=v.get(d[L]),S._pos=L,S.onsuccess=O,S.onerror=j,++D);D===0&&y(x)}),get:({trans:h,key:d})=>new Promise((y,$)=>{y=Ie(y);const v=h.objectStore(c).get(d);v.onsuccess=A=>y(A.target.result),v.onerror=Pt($)}),query:function(h){return d=>new Promise((y,$)=>{y=Ie(y);const{trans:v,values:A,limit:x,query:S}=d,D=x===1/0?void 0:x,{index:P,range:O}=S,j=v.objectStore(c),L=P.isPrimaryKey?j:j.index(P.name),N=n(O);if(x===0)return y({result:[]});if(h){const F=A?L.getAll(N,D):L.getAllKeys(N,D);F.onsuccess=V=>y({result:V.target.result}),F.onerror=Pt($)}else{let F=0;const V=A||!("openKeyCursor"in L)?L.openCursor(N):L.openKeyCursor(N),G=[];V.onsuccess=Y=>{const pe=V.result;return pe?(G.push(A?pe.value:pe.primaryKey),++F===x?y({result:G}):void pe.continue()):y({result:G})},V.onerror=Pt($)}})}(i),openCursor:function({trans:h,values:d,query:y,reverse:$,unique:v}){return new Promise((A,x)=>{A=Ie(A);const{index:S,range:D}=y,P=h.objectStore(c),O=S.isPrimaryKey?P:P.index(S.name),j=$?v?"prevunique":"prev":v?"nextunique":"next",L=d||!("openKeyCursor"in O)?O.openCursor(n(D),j):O.openKeyCursor(n(D),j);L.onerror=Pt(x),L.onsuccess=Ie(N=>{const F=L.result;if(!F)return void A(null);F.___id=++qu,F.done=!1;const V=F.continue.bind(F);let G=F.continuePrimaryKey;G&&(G=G.bind(F));const Y=F.advance.bind(F),pe=()=>{throw new Error("Cursor not stopped")};F.trans=h,F.stop=F.continue=F.continuePrimaryKey=F.advance=()=>{throw new Error("Cursor not started")},F.fail=Ie(x),F.next=function(){let ce=1;return this.start(()=>ce--?this.continue():this.stop()).then(()=>this)},F.start=ce=>{const $e=new Promise((Ce,ie)=>{Ce=Ie(Ce),L.onerror=Pt(ie),F.fail=ie,F.stop=Fe=>{F.stop=F.continue=F.continuePrimaryKey=F.advance=pe,Ce(Fe)}}),Ee=()=>{if(L.result)try{ce()}catch(Ce){F.fail(Ce)}else F.done=!0,F.start=()=>{throw new Error("Cursor behind last entry")},F.stop()};return L.onsuccess=Ie(Ce=>{L.onsuccess=Ee,Ee()}),F.continue=V,F.continuePrimaryKey=G,F.advance=Y,Ee(),$e},A(F)},x)})},count({query:h,trans:d}){const{index:y,range:$}=h;return new Promise((v,A)=>{const x=d.objectStore(c),S=y.isPrimaryKey?x:x.index(y.name),D=n($),P=D?S.count(D):S.count();P.onsuccess=Ie(O=>v(O.target.result)),P.onerror=Pt(A)})}}}(l)),o={};return a.forEach(l=>o[l.name]=l),{stack:"dbcore",transaction:r.transaction.bind(r),table(l){if(!o[l])throw new Error(`Table '${l}' not found`);return o[l]},MIN_KEY:-1/0,MAX_KEY:Dn(t),schema:s}}function Fi({_novip:r},t){const e=t.db,n=function(s,i,{IDBKeyRange:a,indexedDB:o},l){return{dbcore:function(c,h){return h.reduce((d,{create:y})=>({...d,...y(d)}),c)}(Hu(i,a,l),s.dbcore)}}(r._middlewares,e,r._deps,t);r.core=n.dbcore,r.tables.forEach(s=>{const i=s.name;r.core.schema.tables.some(a=>a.name===i)&&(s.core=r.core.table(i),r[i]instanceof r.Table&&(r[i].core=s.core))})}function Os({_novip:r},t,e,n){e.forEach(s=>{const i=n[s];t.forEach(a=>{const o=ta(a,s);(!o||"value"in o&&o.value===void 0)&&(a===r.Transaction.prototype||a instanceof r.Transaction?Ht(a,s,{get(){return this.table(s)},set(l){gl(this,s,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):a[s]=new r.Table(s,i))})})}function Ki({_novip:r},t){t.forEach(e=>{for(let n in e)e[n]instanceof r.Table&&delete e[n]})}function Wu(r,t){return r._cfg.version-t._cfg.version}function Yu(r,t,e,n){const s=r._dbSchema,i=r._createTransaction("readwrite",r._storeNames,s);i.create(e),i._completion.catch(n);const a=i._reject.bind(i),o=ee.transless||ee;or(()=>{ee.trans=i,ee.transless=o,t===0?(ze(s).forEach(l=>{mi(e,l,s[l].primKey,s[l].indexes)}),Fi(r,e),q.follow(()=>r.on.populate.fire(i)).catch(a)):function({_novip:l},f,c,h){const d=[],y=l._versions;let $=l._dbSchema=Bi(l,l.idbdb,h),v=!1;const A=y.filter(S=>S._cfg.version>=f);function x(){return d.length?q.resolve(d.shift()(c.idbtrans)).then(x):q.resolve()}return A.forEach(S=>{d.push(()=>{const D=$,P=S._cfg.dbschema;zi(l,D,h),zi(l,P,h),$=l._dbSchema=P;const O=Gl(D,P);O.add.forEach(L=>{mi(h,L[0],L[1].primKey,L[1].indexes)}),O.change.forEach(L=>{if(L.recreate)throw new oe.Upgrade("Not yet support for changing primary key");{const N=h.objectStore(L.name);L.add.forEach(F=>Ri(N,F)),L.change.forEach(F=>{N.deleteIndex(F.name),Ri(N,F)}),L.del.forEach(F=>N.deleteIndex(F))}});const j=S._cfg.contentUpgrade;if(j&&S._cfg.version>f){Fi(l,h),c._memoizedTables={},v=!0;let L=$l(P);O.del.forEach(G=>{L[G]=D[G]}),Ki(l,[l.Transaction.prototype]),Os(l,[l.Transaction.prototype],ze(L),L),c.schema=L;const N=ra(j);let F;N&&sn();const V=q.follow(()=>{if(F=j(c),F&&N){var G=Yt.bind(null,null);F.then(G,G)}});return F&&typeof F.then=="function"?q.resolve(F):V.then(()=>F)}}),d.push(D=>{(!v||!Fu)&&function(P,O){[].slice.call(O.db.objectStoreNames).forEach(j=>P[j]==null&&O.db.deleteObjectStore(j))}(S._cfg.dbschema,D),Ki(l,[l.Transaction.prototype]),Os(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),c.schema=l._dbSchema})}),x().then(()=>{var S,D;D=h,ze(S=$).forEach(P=>{D.db.objectStoreNames.contains(P)||mi(D,P,S[P].primKey,S[P].indexes)})})}(r,t,i,e).catch(a)})}function Gl(r,t){const e={del:[],add:[],change:[]};let n;for(n in r)t[n]||e.del.push(n);for(n in t){const s=r[n],i=t[n];if(s){const a={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||s.primKey.auto!==i.primKey.auto&&!Vs)a.recreate=!0,e.change.push(a);else{const o=s.idxByName,l=i.idxByName;let f;for(f in o)l[f]||a.del.push(f);for(f in l){const c=o[f],h=l[f];c?c.src!==h.src&&a.change.push(h):a.add.push(h)}(a.del.length>0||a.add.length>0||a.change.length>0)&&e.change.push(a)}}else e.add.push([n,i])}return e}function mi(r,t,e,n){const s=r.db.createObjectStore(t,e.keyPath?{keyPath:e.keyPath,autoIncrement:e.auto}:{autoIncrement:e.auto});return n.forEach(i=>Ri(s,i)),s}function Ri(r,t){r.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Bi(r,t,e){const n={};return Ss(t.objectStoreNames,0).forEach(s=>{const i=e.objectStore(s);let a=i.keyPath;const o=Mi(zl(a),a||"",!1,!1,!!i.autoIncrement,a&&typeof a!="string",!0),l=[];for(let c=0;c<i.indexNames.length;++c){const h=i.index(i.indexNames[c]);a=h.keyPath;var f=Mi(h.name,a,!!h.unique,!!h.multiEntry,!1,a&&typeof a!="string",!1);l.push(f)}n[s]=Vl(s,o,l)}),n}function zi({_novip:r},t,e){const n=e.db.objectStoreNames;for(let s=0;s<n.length;++s){const i=n[s],a=e.objectStore(i);r._hasGetAll="getAll"in a;for(let o=0;o<a.indexNames.length;++o){const l=a.indexNames[o],f=a.index(l).keyPath,c=typeof f=="string"?f:"["+Ss(f).join("+")+"]";if(t[i]){const h=t[i].idxByName[c];h&&(h.name=l,delete t[i].idxByName[c],t[i].idxByName[l]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&je.WorkerGlobalScope&&je instanceof je.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}class Xu{_parseStoresSpec(t,e){ze(t).forEach(n=>{if(t[n]!==null){var s=t[n].split(",").map((a,o)=>{const l=(a=a.trim()).replace(/([&*]|\+\+)/g,""),f=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return Mi(l,f||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),Ze(f),o===0)}),i=s.shift();if(i.multi)throw new oe.Schema("Primary key cannot be multi-valued");s.forEach(a=>{if(a.auto)throw new oe.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new oe.Schema("Index must have a name and cannot be an empty string")}),e[n]=Vl(n,i,s)}})}stores(t){const e=this.db;this._cfg.storesSource=this._cfg.storesSource?et(this._cfg.storesSource,t):t;const n=e._versions,s={};let i={};return n.forEach(a=>{et(s,a._cfg.storesSource),i=a._cfg.dbschema={},a._parseStoresSpec(s,i)}),e._dbSchema=i,Ki(e,[e._allTables,e,e.Transaction.prototype]),Os(e,[e._allTables,e,e.Transaction.prototype,this._cfg.tables],ze(i),i),e._storeNames=ze(i),this}upgrade(t){return this._cfg.contentUpgrade=ia(this._cfg.contentUpgrade||Ae,t),this}}function ca(r,t){let e=r._dbNamesDB;return e||(e=r._dbNamesDB=new xr(Gs,{addons:[],indexedDB:r,IDBKeyRange:t}),e.version(1).stores({dbnames:"name"})),e.table("dbnames")}function ua(r){return r&&typeof r.databases=="function"}function Vi(r){return or(function(){return ee.letThrough=!0,r()})}function Zu(){var r;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var e=function(){return indexedDB.databases().finally(t)};r=setInterval(e,100),e()}).finally(function(){return clearInterval(r)}):Promise.resolve()}function Qu(r){const t=r._state,{indexedDB:e}=r._deps;if(t.isBeingOpened||r.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?qe(t.dbOpenError):r);Ot&&(t.openCanceller._stackHolder=jr()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function s(){if(t.openCanceller!==n)throw new oe.DatabaseClosed("db.open() was cancelled")}let i=t.dbReadyResolve,a=null,o=!1;return q.race([n,(typeof navigator>"u"?q.resolve():Zu()).then(()=>new q((l,f)=>{if(s(),!e)throw new oe.MissingAPI;const c=r.name,h=t.autoSchema?e.open(c):e.open(c,Math.round(10*r.verno));if(!h)throw new oe.MissingAPI;h.onerror=Pt(f),h.onblocked=Ie(r._fireOnBlocked),h.onupgradeneeded=Ie(d=>{if(a=h.transaction,t.autoSchema&&!r._options.allowEmptyDB){h.onerror=On,a.abort(),h.result.close();const $=e.deleteDatabase(c);$.onsuccess=$.onerror=Ie(()=>{f(new oe.NoSuchDatabase(`Database ${c} doesnt exist`))})}else{a.onerror=Pt(f);var y=d.oldVersion>Math.pow(2,62)?0:d.oldVersion;o=y<1,r._novip.idbdb=h.result,Yu(r,y/10,a,f)}},f),h.onsuccess=Ie(()=>{a=null;const d=r._novip.idbdb=h.result,y=Ss(d.objectStoreNames);if(y.length>0)try{const v=d.transaction(($=y).length===1?$[0]:$,"readonly");t.autoSchema?function({_novip:A},x,S){A.verno=x.version/10;const D=A._dbSchema=Bi(0,x,S);A._storeNames=Ss(x.objectStoreNames,0),Os(A,[A._allTables],ze(D),D)}(r,d,v):(zi(r,r._dbSchema,v),function(A,x){const S=Gl(Bi(0,A.idbdb,x),A._dbSchema);return!(S.add.length||S.change.some(D=>D.add.length||D.change.length))}(r,v)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Fi(r,v)}catch{}var $;xn.push(r),d.onversionchange=Ie(v=>{t.vcFired=!0,r.on("versionchange").fire(v)}),d.onclose=Ie(v=>{r.on("close").fire(v)}),o&&function({indexedDB:v,IDBKeyRange:A},x){!ua(v)&&x!==Gs&&ca(v,A).put({name:x}).catch(Ae)}(r._deps,c),l()},f)}))]).then(()=>(s(),t.onReadyBeingFired=[],q.resolve(Vi(()=>r.on.ready.fire(r.vip))).then(function l(){if(t.onReadyBeingFired.length>0){let f=t.onReadyBeingFired.reduce(ia,Ae);return t.onReadyBeingFired=[],q.resolve(Vi(()=>f(r.vip))).then(l)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>r).catch(l=>{t.dbOpenError=l;try{a&&a.abort()}catch{}return n===t.openCanceller&&r._close(),qe(l)}).finally(()=>{t.openComplete=!0,i()})}function Gi(r){var t=i=>r.next(i),e=s(t),n=s(i=>r.throw(i));function s(i){return a=>{var o=i(a),l=o.value;return o.done?l:l&&typeof l.then=="function"?l.then(e,n):Ze(l)?Promise.all(l).then(e,n):e(l)}}return s(t)()}function Ju(r,t,e){var n=arguments.length;if(n<2)throw new oe.InvalidArgument("Too few arguments");for(var s=new Array(n-1);--n;)s[n-1]=arguments[n];return e=s.pop(),[r,wl(s),e]}function Ul(r,t,e,n,s){return q.resolve().then(()=>{const i=ee.transless||ee,a=r._createTransaction(t,e,r._dbSchema,n),o={trans:a,transless:i};if(n)a.idbtrans=n.idbtrans;else try{a.create(),r._state.PR1398_maxLoop=3}catch(h){return h.name===sa.InvalidState&&r.isOpen()&&--r._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),r._close(),r.open().then(()=>Ul(r,t,e,null,s))):qe(h)}const l=ra(s);let f;l&&sn();const c=q.follow(()=>{if(f=s.call(a,a),f)if(l){var h=Yt.bind(null,null);f.then(h,h)}else typeof f.next=="function"&&typeof f.throw=="function"&&(f=Gi(f))},o);return(f&&typeof f.then=="function"?q.resolve(f).then(h=>a.active?h:qe(new oe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>f)).then(h=>(n&&a._resolve(),a._completion.then(()=>h))).catch(h=>(a._reject(h),qe(h)))})}function ms(r,t,e){const n=Ze(r)?r.slice():[r];for(let s=0;s<e;++s)n.push(t);return n}const ef={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(r){return{...r,table(t){const e=r.table(t),{schema:n}=e,s={},i=[];function a(c,h,d){const y=Sn(c),$=s[y]=s[y]||[],v=c==null?0:typeof c=="string"?1:c.length,A=h>0,x={...d,isVirtual:A,keyTail:h,keyLength:v,extractKey:Ni(c),unique:!A&&d.unique};return $.push(x),x.isPrimaryKey||i.push(x),v>1&&a(v===2?c[0]:c.slice(0,v-1),h+1,d),$.sort((S,D)=>S.keyTail-D.keyTail),x}const o=a(n.primaryKey.keyPath,0,n.primaryKey);s[":id"]=[o];for(const c of n.indexes)a(c.keyPath,0,c);function l(c){const h=c.query.index;return h.isVirtual?{...c,query:{index:h,range:(d=c.query.range,y=h.keyTail,{type:d.type===1?2:d.type,lower:ms(d.lower,d.lowerOpen?r.MAX_KEY:r.MIN_KEY,y),lowerOpen:!0,upper:ms(d.upper,d.upperOpen?r.MIN_KEY:r.MAX_KEY,y),upperOpen:!0})}}:c;var d,y}return{...e,schema:{...n,primaryKey:o,indexes:i,getIndexByKeyPath:function(c){const h=s[Sn(c)];return h&&h[0]}},count:c=>e.count(l(c)),query:c=>e.query(l(c)),openCursor(c){const{keyTail:h,isVirtual:d,keyLength:y}=c.query.index;return d?e.openCursor(l(c)).then($=>$&&function(v){return Object.create(v,{continue:{value:function(x){x!=null?v.continue(ms(x,c.reverse?r.MAX_KEY:r.MIN_KEY,h)):c.unique?v.continue(v.key.slice(0,y).concat(c.reverse?r.MIN_KEY:r.MAX_KEY,h)):v.continue()}},continuePrimaryKey:{value(x,S){v.continuePrimaryKey(ms(x,r.MAX_KEY,h),S)}},primaryKey:{get:()=>v.primaryKey},key:{get(){const x=v.key;return y===1?x[0]:x.slice(0,y)}},value:{get:()=>v.value}})}($)):e.openCursor(c)}}}}}};function fa(r,t,e,n){return e=e||{},n=n||"",ze(r).forEach(s=>{if(ht(t,s)){var i=r[s],a=t[s];if(typeof i=="object"&&typeof a=="object"&&i&&a){const o=Ei(i);o!==Ei(a)?e[n+s]=t[s]:o==="Object"?fa(i,a,e,n+s+"."):i!==a&&(e[n+s]=t[s])}else i!==a&&(e[n+s]=t[s])}else e[n+s]=void 0}),ze(t).forEach(s=>{ht(r,s)||(e[n+s]=t[s])}),e}const tf={stack:"dbcore",name:"HooksMiddleware",level:2,create:r=>({...r,table(t){const e=r.table(t),{primaryKey:n}=e.schema;return{...e,mutate(i){const a=ee.trans,{deleting:o,creating:l,updating:f}=a.table(t).hook;switch(i.type){case"add":if(l.fire===Ae)break;return a._promise("readwrite",()=>c(i),!0);case"put":if(l.fire===Ae&&f.fire===Ae)break;return a._promise("readwrite",()=>c(i),!0);case"delete":if(o.fire===Ae)break;return a._promise("readwrite",()=>c(i),!0);case"deleteRange":if(o.fire===Ae)break;return a._promise("readwrite",()=>function(d){return h(d.trans,d.range,1e4)}(i),!0)}return e.mutate(i);function c(d){const y=ee.trans,$=d.keys||function(v,A){return A.type==="delete"?A.keys:A.keys||A.values.map(v.extractKey)}(n,d);if(!$)throw new Error("Keys missing");return(d=d.type==="add"||d.type==="put"?{...d,keys:$}:{...d}).type!=="delete"&&(d.values=[...d.values]),d.keys&&(d.keys=[...d.keys]),function(v,A,x){return A.type==="add"?Promise.resolve([]):v.getMany({trans:A.trans,keys:x,cache:"immutable"})}(e,d,$).then(v=>{const A=$.map((x,S)=>{const D=v[S],P={onerror:null,onsuccess:null};if(d.type==="delete")o.fire.call(P,x,D,y);else if(d.type==="add"||D===void 0){const O=l.fire.call(P,x,d.values[S],y);x==null&&O!=null&&(x=O,d.keys[S]=x,n.outbound||Et(d.values[S],n.keyPath,x))}else{const O=fa(D,d.values[S]),j=f.fire.call(P,O,x,D,y);if(j){const L=d.values[S];Object.keys(j).forEach(N=>{ht(L,N)?L[N]=j[N]:Et(L,N,j[N])})}}return P});return e.mutate(d).then(({failures:x,results:S,numFailures:D,lastResult:P})=>{for(let O=0;O<$.length;++O){const j=S?S[O]:$[O],L=A[O];j==null?L.onerror&&L.onerror(x[O]):L.onsuccess&&L.onsuccess(d.type==="put"&&v[O]?d.values[O]:j)}return{failures:x,results:S,numFailures:D,lastResult:P}}).catch(x=>(A.forEach(S=>S.onerror&&S.onerror(x)),Promise.reject(x)))})}function h(d,y,$){return e.query({trans:d,values:!1,query:{index:n,range:y},limit:$}).then(({result:v})=>c({type:"delete",keys:v,trans:d}).then(A=>A.numFailures>0?Promise.reject(A.failures[0]):v.length<$?{failures:[],numFailures:0,lastResult:void 0}:h(d,{...y,lower:v[v.length-1],lowerOpen:!0},$)))}}}}})};function ql(r,t,e){try{if(!t||t.keys.length<r.length)return null;const n=[];for(let s=0,i=0;s<t.keys.length&&i<r.length;++s)Qe(t.keys[s],r[i])===0&&(n.push(e?Vn(t.values[s]):t.values[s]),++i);return n.length===r.length?n:null}catch{return null}}const rf={stack:"dbcore",level:-1,create:r=>({table:t=>{const e=r.table(t);return{...e,getMany:n=>{if(!n.cache)return e.getMany(n);const s=ql(n.keys,n.trans._cache,n.cache==="clone");return s?q.resolve(s):e.getMany(n).then(i=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?Vn(i):i},i))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),e.mutate(n))}}})};function ha(r){return!("from"in r)}const Vt=function(r,t){if(!this){const e=new Vt;return r&&"d"in r&&et(e,r),e}et(this,arguments.length?{d:1,from:r,to:arguments.length>1?t:r}:{d:0})};function Mn(r,t,e){const n=Qe(t,e);if(isNaN(n))return;if(n>0)throw RangeError();if(ha(r))return et(r,{from:t,to:e,d:1});const s=r.l,i=r.r;if(Qe(e,r.from)<0)return s?Mn(s,t,e):r.l={from:t,to:e,d:1,l:null,r:null},lo(r);if(Qe(t,r.to)>0)return i?Mn(i,t,e):r.r={from:t,to:e,d:1,l:null,r:null},lo(r);Qe(t,r.from)<0&&(r.from=t,r.l=null,r.d=i?i.d+1:1),Qe(e,r.to)>0&&(r.to=e,r.r=null,r.d=r.l?r.l.d+1:1);const a=!r.r;s&&!r.l&&Ls(r,s),i&&a&&Ls(r,i)}function Ls(r,t){ha(t)||function e(n,{from:s,to:i,l:a,r:o}){Mn(n,s,i),a&&e(n,a),o&&e(n,o)}(r,t)}function nf(r,t){const e=Ui(t);let n=e.next();if(n.done)return!1;let s=n.value;const i=Ui(r);let a=i.next(s.from),o=a.value;for(;!n.done&&!a.done;){if(Qe(o.from,s.to)<=0&&Qe(o.to,s.from)>=0)return!0;Qe(s.from,o.from)<0?s=(n=e.next(o.from)).value:o=(a=i.next(s.from)).value}return!1}function Ui(r){let t=ha(r)?null:{s:0,n:r};return{next(e){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Qe(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Qe(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function lo(r){var t,e;const n=(((t=r.r)===null||t===void 0?void 0:t.d)||0)-(((e=r.l)===null||e===void 0?void 0:e.d)||0),s=n>1?"r":n<-1?"l":"";if(s){const i=s==="r"?"l":"r",a={...r},o=r[s];r.from=o.from,r.to=o.to,r[s]=o[s],a[s]=o[i],r[i]=a,a.d=co(a)}r.d=co(r)}function co({r,l:t}){return(r?t?Math.max(r.d,t.d):r.d:t?t.d:0)+1}tn(Vt.prototype,{add(r){return Ls(this,r),this},addKey(r){return Mn(this,r,r),this},addKeys(r){return r.forEach(t=>Mn(this,t,t)),this},[Ci](){return Ui(this)}});const sf={stack:"dbcore",level:0,create:r=>{const t=r.schema.name,e=new Vt(r.MIN_KEY,r.MAX_KEY);return{...r,table:n=>{const s=r.table(n),{schema:i}=s,{primaryKey:a}=i,{extractKey:o,outbound:l}=a,f={...s,mutate:d=>{const y=d.trans,$=y.mutatedParts||(y.mutatedParts={}),v=j=>{const L=`idb://${t}/${n}/${j}`;return $[L]||($[L]=new Vt)},A=v(""),x=v(":dels"),{type:S}=d;let[D,P]=d.type==="deleteRange"?[d.range]:d.type==="delete"?[d.keys]:d.values.length<50?[[],d.values]:[];const O=d.trans._cache;return s.mutate(d).then(j=>{if(Ze(D)){S!=="delete"&&(D=j.results),A.addKeys(D);const L=ql(D,O);L||S==="add"||x.addKeys(D),(L||P)&&function(N,F,V,G){function Y(pe){const ce=N(pe.name||"");function $e(Ce){return Ce!=null?pe.extractKey(Ce):null}const Ee=Ce=>pe.multiEntry&&Ze(Ce)?Ce.forEach(ie=>ce.addKey(ie)):ce.addKey(Ce);(V||G).forEach((Ce,ie)=>{const Fe=V&&$e(V[ie]),Ke=G&&$e(G[ie]);Qe(Fe,Ke)!==0&&(Fe!=null&&Ee(Fe),Ke!=null&&Ee(Ke))})}F.indexes.forEach(Y)}(v,i,L,P)}else if(D){const L={from:D.lower,to:D.upper};x.add(L),A.add(L)}else A.add(e),x.add(e),i.indexes.forEach(L=>v(L.name).add(e));return j})}},c=({query:{index:d,range:y}})=>{var $,v;return[d,new Vt(($=y.lower)!==null&&$!==void 0?$:r.MIN_KEY,(v=y.upper)!==null&&v!==void 0?v:r.MAX_KEY)]},h={get:d=>[a,new Vt(d.key)],getMany:d=>[a,new Vt().addKeys(d.keys)],count:c,query:c,openCursor:c};return ze(h).forEach(d=>{f[d]=function(y){const{subscr:$}=ee;if($){const v=P=>{const O=`idb://${t}/${n}/${P}`;return $[O]||($[O]=new Vt)},A=v(""),x=v(":dels"),[S,D]=h[d](y);if(v(S.name||"").add(D),!S.isPrimaryKey){if(d!=="count"){const P=d==="query"&&l&&y.values&&s.query({...y,values:!1});return s[d].apply(this,arguments).then(O=>{if(d==="query"){if(l&&y.values)return P.then(({result:L})=>(A.addKeys(L),O));const j=y.values?O.result.map(o):O.result;y.values?A.addKeys(j):x.addKeys(j)}else if(d==="openCursor"){const j=O,L=y.values;return j&&Object.create(j,{key:{get:()=>(x.addKey(j.primaryKey),j.key)},primaryKey:{get(){const N=j.primaryKey;return x.addKey(N),N}},value:{get:()=>(L&&A.addKey(j.primaryKey),j.value)}})}return O})}x.add(e)}}return s[d].apply(this,arguments)}}),f}}}};class xr{constructor(t,e){this._middlewares={},this.verno=0;const n=xr.dependencies;this._options=e={addons:xr.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...e},this._deps={indexedDB:e.indexedDB,IDBKeyRange:e.IDBKeyRange};const{addons:s}=e;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ae,dbReadyPromise:null,cancelOpen:Ae,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a;i.dbReadyPromise=new q(o=>{i.dbReadyResolve=o}),i.openCanceller=new q((o,l)=>{i.cancelOpen=l}),this._state=i,this.name=t,this.on=kn(this,"populate","blocked","versionchange","close",{ready:[ia,Ae]}),this.on.ready.subscribe=yl(this.on.ready.subscribe,o=>(l,f)=>{xr.vip(()=>{const c=this._state;if(c.openComplete)c.dbOpenError||q.resolve().then(l),f&&o(l);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(l),f&&o(l);else{o(l);const h=this;f||o(function d(){h.on.ready.unsubscribe(l),h.on.ready.unsubscribe(d)})}})}),this.Collection=(a=this,vn(Bu.prototype,function(o,l){this.db=a;let f=Kl,c=null;if(l)try{f=l()}catch($){c=$}const h=o._ctx,d=h.table,y=d.hook.reading.fire;this._ctx={table:d,index:h.index,isPrimKey:!h.index||d.schema.primKey.keyPath&&h.index===d.schema.primKey.name,range:f,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:h.or,valueMapper:y!==jn?y:null}})),this.Table=function(o){return vn(Ru.prototype,function(l,f,c){this.db=o,this._tx=c,this.name=l,this.schema=f,this.hook=o._allTables[l]?o._allTables[l].hook:kn(null,{creating:[Au,Ae],reading:[Su,jn],updating:[Pu,Ae],deleting:[Tu,Ae]})})}(this),this.Transaction=function(o){return vn(Uu.prototype,function(l,f,c,h,d){this.db=o,this.mode=l,this.storeNames=f,this.schema=c,this.chromeTransactionDurability=h,this.idbtrans=null,this.on=kn(this,"complete","error","abort"),this.parent=d||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new q((y,$)=>{this._resolve=y,this._reject=$}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},y=>{var $=this.active;return this.active=!1,this.on.error.fire(y),this.parent?this.parent._reject(y):$&&this.idbtrans&&this.idbtrans.abort(),qe(y)})})}(this),this.Version=function(o){return vn(Xu.prototype,function(l){this.db=o,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(o){return vn(Bl.prototype,function(l,f,c){this.db=o,this._ctx={table:l,index:f===":id"?null:f,or:c};const h=o._deps.indexedDB;if(!h)throw new oe.MissingAPI;this._cmp=this._ascending=h.cmp.bind(h),this._descending=(d,y)=>h.cmp(y,d),this._max=(d,y)=>h.cmp(d,y)>0?d:y,this._min=(d,y)=>h.cmp(d,y)<0?d:y,this._IDBKeyRange=o._deps.IDBKeyRange})}(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=Dn(e.IDBKeyRange),this._createTransaction=(o,l,f,c)=>new this.Transaction(o,l,f,this._options.chromeTransactionDurability,c),this._fireOnBlocked=o=>{this.on("blocked").fire(o),xn.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(o))},this.use(ef),this.use(tf),this.use(sf),this.use(rf),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(o=>o(this))}version(t){if(isNaN(t)||t<.1)throw new oe.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new oe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const e=this._versions;var n=e.filter(s=>s._cfg.version===t)[0];return n||(n=new this.Version(t),e.push(n),e.sort(Wu),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||ee.letThrough||this._vip)?t():new q((e,n)=>{if(this._state.openComplete)return n(new oe.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new oe.DatabaseClosed);this.open().catch(Ae)}this._state.dbReadyPromise.then(e,n)}).then(t)}use({stack:t,create:e,level:n,name:s}){s&&this.unuse({stack:t,name:s});const i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:e,level:n??10,name:s}),i.sort((a,o)=>a.level-o.level),this}unuse({stack:t,name:e,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(s=>n?s.create!==n:!!e&&s.name!==e)),this}open(){return Qu(this)}_close(){const t=this._state,e=xn.indexOf(this);if(e>=0&&xn.splice(e,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new q(n=>{t.dbReadyResolve=n}),t.openCanceller=new q((n,s)=>{t.cancelOpen=s})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new oe.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,e=this._state;return new q((n,s)=>{const i=()=>{this.close();var a=this._deps.indexedDB.deleteDatabase(this.name);a.onsuccess=Ie(()=>{(function({indexedDB:o,IDBKeyRange:l},f){!ua(o)&&f!==Gs&&ca(o,l).delete(f).catch(Ae)})(this._deps,this.name),n()}),a.onerror=Pt(s),a.onblocked=this._fireOnBlocked};if(t)throw new oe.InvalidArgument("Arguments not allowed in db.delete()");e.isBeingOpened?e.dbReadyPromise.then(i):i()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return ze(this._allTables).map(t=>this._allTables[t])}transaction(){const t=Ju.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,e,n){let s=ee.trans;s&&s.db===this&&t.indexOf("!")===-1||(s=null);const i=t.indexOf("?")!==-1;let a,o;t=t.replace("!","").replace("?","");try{if(o=e.map(f=>{var c=f instanceof this.Table?f.name:f;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),t=="r"||t===li)a=li;else{if(t!="rw"&&t!=ci)throw new oe.InvalidArgument("Invalid transaction mode: "+t);a=ci}if(s){if(s.mode===li&&a===ci){if(!i)throw new oe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&o.forEach(f=>{if(s&&s.storeNames.indexOf(f)===-1){if(!i)throw new oe.SubTransaction("Table "+f+" not included in parent transaction.");s=null}}),i&&s&&!s.active&&(s=null)}}catch(f){return s?s._promise(null,(c,h)=>{h(f)}):qe(f)}const l=Ul.bind(null,this,a,o,s,n);return s?s._promise(a,l,"lock"):ee.trans?an(ee.transless,()=>this._whenReady(l)):this._whenReady(l)}table(t){if(!ht(this._allTables,t))throw new oe.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const af=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class of{constructor(t){this._subscribe=t}subscribe(t,e,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:e,complete:n})}[af](){return this}}function Hl(r,t){return ze(t).forEach(e=>{Ls(r[e]||(r[e]=new Vt),t[e])}),r}function lf(r){let t,e=!1;const n=new of(s=>{const i=ra(r);let a=!1,o={},l={};const f={get closed(){return a},unsubscribe:()=>{a=!0,cr.storagemutated.unsubscribe(y)}};s.start&&s.start(f);let c=!1,h=!1;function d(){return ze(l).some(v=>o[v]&&nf(o[v],l[v]))}const y=v=>{Hl(o,v),d()&&$()},$=()=>{if(c||a)return;o={};const v={},A=function(x){i&&sn();const S=()=>or(r,{subscr:x,trans:null}),D=ee.trans?an(ee.transless,S):S();return i&&D.then(Yt,Yt),D}(v);h||(cr(Ln,y),h=!0),c=!0,Promise.resolve(A).then(x=>{e=!0,t=x,c=!1,a||(d()?$():(o={},l=v,s.next&&s.next(x)))},x=>{c=!1,e=!1,s.error&&s.error(x),f.unsubscribe()})};return $(),f});return n.hasValue=()=>e,n.getValue=()=>t,n}let qi;try{qi={indexedDB:je.indexedDB||je.mozIndexedDB||je.webkitIndexedDB||je.msIndexedDB,IDBKeyRange:je.IDBKeyRange||je.webkitIDBKeyRange}}catch{qi={indexedDB:null,IDBKeyRange:null}}const gr=xr;function Es(r){let t=qt;try{qt=!0,cr.storagemutated.fire(r)}finally{qt=t}}tn(gr,{...gs,delete:r=>new gr(r,{addons:[]}).delete(),exists:r=>new gr(r,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(r){try{return function({indexedDB:t,IDBKeyRange:e}){return ua(t)?Promise.resolve(t.databases()).then(n=>n.map(s=>s.name).filter(s=>s!==Gs)):ca(t,e).toCollection().primaryKeys()}(gr.dependencies).then(r)}catch{return qe(new oe.MissingAPI)}},defineClass:()=>function(r){et(this,r)},ignoreTransaction:r=>ee.trans?an(ee.transless,r):r(),vip:Vi,async:function(r){return function(){try{var t=Gi(r.apply(this,arguments));return t&&typeof t.then=="function"?t:q.resolve(t)}catch(e){return qe(e)}}},spawn:function(r,t,e){try{var n=Gi(r.apply(e,t||[]));return n&&typeof n.then=="function"?n:q.resolve(n)}catch(s){return qe(s)}},currentTransaction:{get:()=>ee.trans||null},waitFor:function(r,t){const e=q.resolve(typeof r=="function"?gr.ignoreTransaction(r):r).timeout(t||6e4);return ee.trans?ee.trans.waitFor(e):e},Promise:q,debug:{get:()=>Ot,set:r=>{Cl(r,r==="dexie"?()=>!0:Fl)}},derive:qr,extend:et,props:tn,override:yl,Events:kn,on:cr,liveQuery:lf,extendObservabilitySet:Hl,getByKeyPath:Wt,setByKeyPath:Et,delByKeyPath:function(r,t){typeof t=="string"?Et(r,t,void 0):"length"in t&&[].map.call(t,function(e){Et(r,e,void 0)})},shallowClone:$l,deepClone:Vn,getObjectDiff:fa,cmp:Qe,asap:_l,minKey:Di,addons:[],connections:xn,errnames:sa,dependencies:qi,semVer:ro,version:ro.split(".").map(r=>parseInt(r)).reduce((r,t,e)=>r+t/Math.pow(10,2*e))}),gr.maxKey=Dn(gr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(cr(Ln,r=>{if(!qt){let t;Vs?(t=document.createEvent("CustomEvent"),t.initCustomEvent(nr,!0,!0,r)):t=new CustomEvent(nr,{detail:r}),qt=!0,dispatchEvent(t),qt=!1}}),addEventListener(nr,({detail:r})=>{qt||Es(r)}));let qt=!1;if(typeof BroadcastChannel<"u"){const r=new BroadcastChannel(nr);typeof r.unref=="function"&&r.unref(),cr(Ln,t=>{qt||r.postMessage(t)}),r.onmessage=t=>{t.data&&Es(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){cr(Ln,t=>{try{qt||(typeof localStorage<"u"&&localStorage.setItem(nr,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(e=>e.postMessage({type:nr,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===nr){const e=JSON.parse(t.newValue);e&&Es(e.changedParts)}});const r=self.document&&navigator.serviceWorker;r&&r.addEventListener("message",function({data:t}){t&&t.type===nr&&Es(t.changedParts)})}q.rejectionMapper=function(r,t){if(!r||r instanceof Hr||r instanceof TypeError||r instanceof SyntaxError||!r.name||!Qa[r.name])return r;var e=new Qa[r.name](t||r.message,r);return"stack"in r&&Ht(e,"stack",{get:function(){return this.inner.stack}}),e},Cl(Ot,Fl);class cf extends xr{constructor(){super("letkwet");X(this,"songs");X(this,"_meta");this.version(1).stores({songs:"&key,*artists,title",_meta:"last_modified"})}async updateSongs(e,n){const s=this.songs.bulkPut(e);await this._meta.clear();const i=this._meta.add({last_modified:n});return Promise.all([s,i])}}let kr=new cf;function uf(r,t){if(r instanceof RegExp)return{keys:!1,pattern:r};var e,n,s,i,a=[],o="",l=r.split("/");for(l[0]||l.shift();s=l.shift();)e=s[0],e==="*"?(a.push("wild"),o+="/(.*)"):e===":"?(n=s.indexOf("?",1),i=s.indexOf(".",1),a.push(s.substring(1,~n?n:~i?i:s.length)),o+=~n&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(o+=(~n?"?":"")+"\\"+s.substring(i))):o+="/"+s;return{keys:a,pattern:new RegExp("^"+o+(t?"(?=$|/)":"/?$"),"i")}}function ff(r){let t,e,n;const s=[r[2]];var i=r[0];function a(o){let l={};for(let f=0;f<s.length;f+=1)l=ml(l,s[f]);return{props:l}}return i&&(t=Cs(i,a()),t.$on("routeEvent",r[7])),{c(){t&&st(t.$$.fragment),e=ve()},l(o){t&&gt(t.$$.fragment,o),e=ve()},m(o,l){t&&it(t,o,l),W(o,e,l),n=!0},p(o,l){const f=l&4?pl(s,[bl(o[2])]):{};if(l&1&&i!==(i=o[0])){if(t){Ct();const c=t;ge(c.$$.fragment,1,0,()=>{at(c,1)}),xt()}i?(t=Cs(i,a()),t.$on("routeEvent",o[7]),st(t.$$.fragment),fe(t.$$.fragment,1),it(t,e.parentNode,e)):t=null}else i&&t.$set(f)},i(o){n||(t&&fe(t.$$.fragment,o),n=!0)},o(o){t&&ge(t.$$.fragment,o),n=!1},d(o){o&&I(e),t&&at(t,o)}}}function hf(r){let t,e,n;const s=[{params:r[1]},r[2]];var i=r[0];function a(o){let l={};for(let f=0;f<s.length;f+=1)l=ml(l,s[f]);return{props:l}}return i&&(t=Cs(i,a()),t.$on("routeEvent",r[6])),{c(){t&&st(t.$$.fragment),e=ve()},l(o){t&&gt(t.$$.fragment,o),e=ve()},m(o,l){t&&it(t,o,l),W(o,e,l),n=!0},p(o,l){const f=l&6?pl(s,[l&2&&{params:o[1]},l&4&&bl(o[2])]):{};if(l&1&&i!==(i=o[0])){if(t){Ct();const c=t;ge(c.$$.fragment,1,0,()=>{at(c,1)}),xt()}i?(t=Cs(i,a()),t.$on("routeEvent",o[6]),st(t.$$.fragment),fe(t.$$.fragment,1),it(t,e.parentNode,e)):t=null}else i&&t.$set(f)},i(o){n||(t&&fe(t.$$.fragment,o),n=!0)},o(o){t&&ge(t.$$.fragment,o),n=!1},d(o){o&&I(e),t&&at(t,o)}}}function mf(r){let t,e,n,s;const i=[hf,ff],a=[];function o(l,f){return l[1]?0:1}return t=o(r),e=a[t]=i[t](r),{c(){e.c(),n=ve()},l(l){e.l(l),n=ve()},m(l,f){a[t].m(l,f),W(l,n,f),s=!0},p(l,[f]){let c=t;t=o(l),t===c?a[t].p(l,f):(Ct(),ge(a[c],1,1,()=>{a[c]=null}),xt(),e=a[t],e?e.p(l,f):(e=a[t]=i[t](l),e.c()),fe(e,1),e.m(n.parentNode,n))},i(l){s||(fe(e),s=!0)},o(l){ge(e),s=!1},d(l){l&&I(n),a[t].d(l)}}}function uo(){const r=window.location.href.indexOf("#/");let t=r>-1?window.location.href.substr(r+1):"/";const e=t.indexOf("?");let n="";return e>-1&&(n=t.substr(e+1),t=t.substr(0,e)),{location:t,querystring:n}}const ma=mu(null,function(t){t(uo());const e=()=>{t(uo())};return window.addEventListener("hashchange",e,!1),function(){window.removeEventListener("hashchange",e,!1)}});dl(ma,r=>r.location);dl(ma,r=>r.querystring);const fo=du(void 0);function df(r){r?window.scrollTo(r.__svelte_spa_router_scrollX,r.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function pf(r,t,e){let{routes:n={}}=t,{prefix:s=""}=t,{restoreScrollState:i=!1}=t;class a{constructor(O,j){if(!j||typeof j!="function"&&(typeof j!="object"||j._sveltesparouter!==!0))throw Error("Invalid component object");if(!O||typeof O=="string"&&(O.length<1||O.charAt(0)!="/"&&O.charAt(0)!="*")||typeof O=="object"&&!(O instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:L,keys:N}=uf(O);this.path=O,typeof j=="object"&&j._sveltesparouter===!0?(this.component=j.component,this.conditions=j.conditions||[],this.userData=j.userData,this.props=j.props||{}):(this.component=()=>Promise.resolve(j),this.conditions=[],this.props={}),this._pattern=L,this._keys=N}match(O){if(s){if(typeof s=="string")if(O.startsWith(s))O=O.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const F=O.match(s);if(F&&F[0])O=O.substr(F[0].length)||"/";else return null}}const j=this._pattern.exec(O);if(j===null)return null;if(this._keys===!1)return j;const L={};let N=0;for(;N<this._keys.length;){try{L[this._keys[N]]=decodeURIComponent(j[N+1]||"")||null}catch{L[this._keys[N]]=null}N++}return L}async checkConditions(O){for(let j=0;j<this.conditions.length;j++)if(!await this.conditions[j](O))return!1;return!0}}const o=[];n instanceof Map?n.forEach((P,O)=>{o.push(new a(O,P))}):Object.keys(n).forEach(P=>{o.push(new a(P,n[P]))});let l=null,f=null,c={};const h=Bn();async function d(P,O){await nu(),h(P,O)}let y=null,$=null;i&&($=P=>{P.state&&(P.state.__svelte_spa_router_scrollY||P.state.__svelte_spa_router_scrollX)?y=P.state:y=null},window.addEventListener("popstate",$),tu(()=>{df(y)}));let v=null,A=null;const x=ma.subscribe(async P=>{v=P;let O=0;for(;O<o.length;){const j=o[O].match(P.location);if(!j){O++;continue}const L={route:o[O].path,location:P.location,querystring:P.querystring,userData:o[O].userData,params:j&&typeof j=="object"&&Object.keys(j).length?j:null};if(!await o[O].checkConditions(L)){e(0,l=null),A=null,d("conditionsFailed",L);return}d("routeLoading",Object.assign({},L));const N=o[O].component;if(A!=N){N.loading?(e(0,l=N.loading),A=N,e(1,f=N.loadingParams),e(2,c={}),d("routeLoaded",Object.assign({},L,{component:l,name:l.name,params:f}))):(e(0,l=null),A=null);const F=await N();if(P!=v)return;e(0,l=F&&F.default||F),A=N}j&&typeof j=="object"&&Object.keys(j).length?e(1,f=j):e(1,f=null),e(2,c=o[O].props),d("routeLoaded",Object.assign({},L,{component:l,name:l.name,params:f})).then(()=>{fo.set(f)});return}e(0,l=null),A=null,fo.set(void 0)});ru(()=>{x(),$&&window.removeEventListener("popstate",$)});function S(P){$i.call(this,r,P)}function D(P){$i.call(this,r,P)}return r.$$set=P=>{"routes"in P&&e(3,n=P.routes),"prefix"in P&&e(4,s=P.prefix),"restoreScrollState"in P&&e(5,i=P.restoreScrollState)},r.$$.update=()=>{r.$$.dirty&32&&(history.scrollRestoration=i?"manual":"auto")},[l,f,c,n,s,i,S,D]}class Wl extends dt{constructor(t){super(),pt(this,t,pf,mf,mt,{routes:3,prefix:4,restoreScrollState:5})}}function ho(r,t,e){const n=r.slice();return n[6]=t[e],n}function mo(r,t,e){const n=r.slice();return n[10]=t[e],n}function po(r){let t,e,n,s,i,a={ctx:r,current:null,token:null,hasCatch:!1,pending:vf,then:gf,catch:bf,value:9};Ut(n=r[1],a);let o={ctx:r,current:null,token:null,hasCatch:!1,pending:xf,then:wf,catch:$f,value:5};return Ut(i=r[2],o),{c(){t=Z("div"),e=Z("div"),a.block.c(),s=Te(),o.block.c(),this.h()},l(l){t=Q(l,"DIV",{class:!0});var f=U(t);e=Q(f,"DIV",{class:!0});var c=U(e);a.block.l(c),s=Pe(c),o.block.l(c),c.forEach(I),f.forEach(I),this.h()},h(){C(e,"class","shadow border rounded absolute top-0 left-4 right-4 bg-white max-w-lg"),C(t,"class","relative z-10")},m(l,f){W(l,t,f),K(t,e),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=s,K(e,s),o.block.m(e,o.anchor=null),o.mount=()=>e,o.anchor=null},p(l,f){r=l,a.ctx=r,f&2&&n!==(n=r[1])&&Ut(n,a)||Tn(a,r,f),o.ctx=r,f&4&&i!==(i=r[2])&&Ut(i,o)||Tn(o,r,f)},d(l){l&&I(t),a.block.d(),a.token=null,a=null,o.block.d(),o.token=null,o=null}}}function bf(r){return{c:H,l:H,m:H,p:H,d:H}}function gf(r){let t,e,n="သီချင်းများ",s;function i(l,f){return l[9]&&l[9].length>0?_f:yf}let a=i(r),o=a(r);return{c(){t=Z("div"),e=Z("h3"),e.textContent=n,s=Te(),o.c(),this.h()},l(l){t=Q(l,"DIV",{});var f=U(t);e=Q(f,"H3",{class:!0,["data-svelte-h"]:!0}),jt(e)!=="svelte-1ykeg2m"&&(e.textContent=n),s=Pe(f),o.l(f),f.forEach(I),this.h()},h(){C(e,"class","text-md font-bold my-4 mx-8")},m(l,f){W(l,t,f),K(t,e),K(t,s),o.m(t,null)},p(l,f){a===(a=i(l))&&o?o.p(l,f):(o.d(1),o=a(l),o&&(o.c(),o.m(t,null)))},d(l){l&&I(t),o.d()}}}function yf(r){let t,e,n,s;return{c(){t=Z("div"),e=me('"'),n=me(r[0]),s=me('" အမည်ပါ သီချင်းမတွေ့ပါ'),this.h()},l(i){t=Q(i,"DIV",{class:!0});var a=U(t);e=de(a,'"'),n=de(a,r[0]),s=de(a,'" အမည်ပါ သီချင်းမတွေ့ပါ'),a.forEach(I),this.h()},h(){C(t,"class","text-gray-400 px-6 py-4")},m(i,a){W(i,t,a),K(t,e),K(t,n),K(t,s)},p(i,a){a&1&&He(n,i[0])},d(i){i&&I(t)}}}function _f(r){let t,e=Ve(r[9]),n=[];for(let s=0;s<e.length;s+=1)n[s]=bo(mo(r,e,s));return{c(){t=Z("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){t=Q(s,"DIV",{class:!0});var i=U(t);for(let a=0;a<n.length;a+=1)n[a].l(i);i.forEach(I),this.h()},h(){C(t,"class","flex flex-col")},m(s,i){W(s,t,i);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(t,null)},p(s,i){if(i&10){e=Ve(s[9]);let a;for(a=0;a<e.length;a+=1){const o=mo(s,e,a);n[a]?n[a].p(o,i):(n[a]=bo(o),n[a].c(),n[a].m(t,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=e.length}},d(s){s&&I(t),It(n,s)}}}function bo(r){let t,e,n=r[10].title+"",s,i,a,o,l,f=r[10].artists.join(", ")+"",c,h,d,y,$;return{c(){t=Z("a"),e=me("♫ "),s=me(n),i=Te(),a=Z("br"),o=me(`\r
              (`),l=Z("span"),c=me(f),h=me(`)\r
              `),this.h()},l(v){t=Q(v,"A",{href:!0,class:!0});var A=U(t);e=de(A,"♫ "),s=de(A,n),i=Pe(A),a=Q(A,"BR",{}),o=de(A,`\r
              (`),l=Q(A,"SPAN",{class:!0});var x=U(l);c=de(x,f),x.forEach(I),h=de(A,`)\r
              `),A.forEach(I),this.h()},h(){C(l,"class","text-letkwet-600"),C(t,"href",d=`#/song/${r[10].key}`),C(t,"class","border-t py-4 px-6")},m(v,A){W(v,t,A),K(t,e),K(t,s),K(t,i),K(t,a),K(t,o),K(t,l),K(l,c),K(t,h),y||($=Ue(t,"click",r[3]),y=!0)},p(v,A){A&2&&n!==(n=v[10].title+"")&&He(s,n),A&2&&f!==(f=v[10].artists.join(", ")+"")&&He(c,f),A&2&&d!==(d=`#/song/${v[10].key}`)&&C(t,"href",d)},d(v){v&&I(t),y=!1,$()}}}function vf(r){return{c:H,l:H,m:H,p:H,d:H}}function $f(r){return{c:H,l:H,m:H,p:H,d:H}}function wf(r){let t,e,n="အဆိုတော်များ",s;function i(l,f){return l[5]&&l[5].length>0?Cf:Ef}let a=i(r),o=a(r);return{c(){t=Z("div"),e=Z("h3"),e.textContent=n,s=Te(),o.c(),this.h()},l(l){t=Q(l,"DIV",{});var f=U(t);e=Q(f,"H3",{class:!0,["data-svelte-h"]:!0}),jt(e)!=="svelte-acv08w"&&(e.textContent=n),s=Pe(f),o.l(f),f.forEach(I),this.h()},h(){C(e,"class","text-md font-bold my-4 mx-8")},m(l,f){W(l,t,f),K(t,e),K(t,s),o.m(t,null)},p(l,f){a===(a=i(l))&&o?o.p(l,f):(o.d(1),o=a(l),o&&(o.c(),o.m(t,null)))},d(l){l&&I(t),o.d()}}}function Ef(r){let t,e,n,s;return{c(){t=Z("div"),e=me('"'),n=me(r[0]),s=me('" အမည်ပါအဆိုတော် မတွေ့ပါ'),this.h()},l(i){t=Q(i,"DIV",{class:!0});var a=U(t);e=de(a,'"'),n=de(a,r[0]),s=de(a,'" အမည်ပါအဆိုတော် မတွေ့ပါ'),a.forEach(I),this.h()},h(){C(t,"class","text-gray-400 px-6 py-4")},m(i,a){W(i,t,a),K(t,e),K(t,n),K(t,s)},p(i,a){a&1&&He(n,i[0])},d(i){i&&I(t)}}}function Cf(r){let t,e=Ve(r[5]),n=[];for(let s=0;s<e.length;s+=1)n[s]=go(ho(r,e,s));return{c(){t=Z("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){t=Q(s,"DIV",{class:!0});var i=U(t);for(let a=0;a<n.length;a+=1)n[a].l(i);i.forEach(I),this.h()},h(){C(t,"class","flex flex-col")},m(s,i){W(s,t,i);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(t,null)},p(s,i){if(i&12){e=Ve(s[5]);let a;for(a=0;a<e.length;a+=1){const o=ho(s,e,a);n[a]?n[a].p(o,i):(n[a]=go(o),n[a].c(),n[a].m(t,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=e.length}},d(s){s&&I(t),It(n,s)}}}function go(r){let t,e,n=r[6]+"",s,i,a,o,l;return{c(){t=Z("a"),e=me("🎙 "),s=me(n),i=Te(),this.h()},l(f){t=Q(f,"A",{href:!0,class:!0});var c=U(t);e=de(c,"🎙 "),s=de(c,n),i=Pe(c),c.forEach(I),this.h()},h(){C(t,"href",a=`#/artist/${r[6]}`),C(t,"class","border-t py-4 px-6 text-letkwet-400 font-bold")},m(f,c){W(f,t,c),K(t,e),K(t,s),K(t,i),o||(l=Ue(t,"click",r[3]),o=!0)},p(f,c){c&4&&n!==(n=f[6]+"")&&He(s,n),c&4&&a!==(a=`#/artist/${f[6]}`)&&C(t,"href",a)},d(f){f&&I(t),o=!1,l()}}}function xf(r){return{c:H,l:H,m:H,p:H,d:H}}function kf(r){let t,e=r[1]!=null&&r[2]!=null&&po(r);return{c(){e&&e.c(),t=ve()},l(n){e&&e.l(n),t=ve()},m(n,s){e&&e.m(n,s),W(n,t,s)},p(n,[s]){n[1]!=null&&n[2]!=null?e?e.p(n,s):(e=po(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:H,o:H,d(n){n&&I(t),e&&e.d(n)}}}function Sf(r,t,e){let{query:n}=t;const s=Bn();function i(){s("selected")}let a=null,o=null;return r.$$set=l=>{"query"in l&&e(0,n=l.query)},r.$$.update=()=>{r.$$.dirty&1&&(n.length>=3?(e(1,a=kr.songs.where("title").startsWithIgnoreCase(n).limit(10).toArray()),e(2,o=kr.songs.where("artists").startsWithIgnoreCase(n).toArray().then(l=>Object.keys(l.reduce((f,c)=>(c.artists.forEach(h=>f[h]=h),f),{}))))):(e(1,a=null),e(2,o=null)))},[n,a,o,i]}class Af extends dt{constructor(t){super(),pt(this,t,Sf,kf,mt,{query:0})}}var ds=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Pf="Expected a function",Yl="__lodash_hash_undefined__",Xl=1/0,jf="[object Function]",If="[object GeneratorFunction]",Of="[object Symbol]",Lf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Df=/^\w*$/,Mf=/^\./,Nf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ff=/[\\^$.*+?()[\]{}|]/g,Kf=/\\(\\)?/g,Rf=/^\[object .+?Constructor\]$/,Bf=typeof ds=="object"&&ds&&ds.Object===Object&&ds,zf=typeof self=="object"&&self&&self.Object===Object&&self,da=Bf||zf||Function("return this")();function Vf(r,t){return r==null?void 0:r[t]}function Gf(r){var t=!1;if(r!=null&&typeof r.toString!="function")try{t=!!(r+"")}catch{}return t}var Uf=Array.prototype,qf=Function.prototype,Zl=Object.prototype,di=da["__core-js_shared__"],yo=function(){var r=/[^.]+$/.exec(di&&di.keys&&di.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Ql=qf.toString,pa=Zl.hasOwnProperty,Jl=Zl.toString,Hf=RegExp("^"+Ql.call(pa).replace(Ff,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_o=da.Symbol,Wf=Uf.splice,Yf=ec(da,"Map"),Nn=ec(Object,"create"),vo=_o?_o.prototype:void 0,$o=vo?vo.toString:void 0;function Tr(r){var t=-1,e=r?r.length:0;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}function Xf(){this.__data__=Nn?Nn(null):{}}function Zf(r){return this.has(r)&&delete this.__data__[r]}function Qf(r){var t=this.__data__;if(Nn){var e=t[r];return e===Yl?void 0:e}return pa.call(t,r)?t[r]:void 0}function Jf(r){var t=this.__data__;return Nn?t[r]!==void 0:pa.call(t,r)}function eh(r,t){var e=this.__data__;return e[r]=Nn&&t===void 0?Yl:t,this}Tr.prototype.clear=Xf;Tr.prototype.delete=Zf;Tr.prototype.get=Qf;Tr.prototype.has=Jf;Tr.prototype.set=eh;function on(r){var t=-1,e=r?r.length:0;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}function th(){this.__data__=[]}function rh(r){var t=this.__data__,e=Us(t,r);if(e<0)return!1;var n=t.length-1;return e==n?t.pop():Wf.call(t,e,1),!0}function nh(r){var t=this.__data__,e=Us(t,r);return e<0?void 0:t[e][1]}function sh(r){return Us(this.__data__,r)>-1}function ih(r,t){var e=this.__data__,n=Us(e,r);return n<0?e.push([r,t]):e[n][1]=t,this}on.prototype.clear=th;on.prototype.delete=rh;on.prototype.get=nh;on.prototype.has=sh;on.prototype.set=ih;function Ir(r){var t=-1,e=r?r.length:0;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}function ah(){this.__data__={hash:new Tr,map:new(Yf||on),string:new Tr}}function oh(r){return qs(this,r).delete(r)}function lh(r){return qs(this,r).get(r)}function ch(r){return qs(this,r).has(r)}function uh(r,t){return qs(this,r).set(r,t),this}Ir.prototype.clear=ah;Ir.prototype.delete=oh;Ir.prototype.get=lh;Ir.prototype.has=ch;Ir.prototype.set=uh;function Us(r,t){for(var e=r.length;e--;)if($h(r[e][0],t))return e;return-1}function fh(r,t){t=ph(t,r)?[t]:dh(t);for(var e=0,n=t.length;r!=null&&e<n;)r=r[_h(t[e++])];return e&&e==n?r:void 0}function hh(r){if(!rc(r)||gh(r))return!1;var t=wh(r)||Gf(r)?Hf:Rf;return t.test(vh(r))}function mh(r){if(typeof r=="string")return r;if(ga(r))return $o?$o.call(r):"";var t=r+"";return t=="0"&&1/r==-Xl?"-0":t}function dh(r){return tc(r)?r:yh(r)}function qs(r,t){var e=r.__data__;return bh(t)?e[typeof t=="string"?"string":"hash"]:e.map}function ec(r,t){var e=Vf(r,t);return hh(e)?e:void 0}function ph(r,t){if(tc(r))return!1;var e=typeof r;return e=="number"||e=="symbol"||e=="boolean"||r==null||ga(r)?!0:Df.test(r)||!Lf.test(r)||t!=null&&r in Object(t)}function bh(r){var t=typeof r;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?r!=="__proto__":r===null}function gh(r){return!!yo&&yo in r}var yh=ba(function(r){r=Ch(r);var t=[];return Mf.test(r)&&t.push(""),r.replace(Nf,function(e,n,s,i){t.push(s?i.replace(Kf,"$1"):n||e)}),t});function _h(r){if(typeof r=="string"||ga(r))return r;var t=r+"";return t=="0"&&1/r==-Xl?"-0":t}function vh(r){if(r!=null){try{return Ql.call(r)}catch{}try{return r+""}catch{}}return""}function ba(r,t){if(typeof r!="function"||t&&typeof t!="function")throw new TypeError(Pf);var e=function(){var n=arguments,s=t?t.apply(this,n):n[0],i=e.cache;if(i.has(s))return i.get(s);var a=r.apply(this,n);return e.cache=i.set(s,a),a};return e.cache=new(ba.Cache||Ir),e}ba.Cache=Ir;function $h(r,t){return r===t||r!==r&&t!==t}var tc=Array.isArray;function wh(r){var t=rc(r)?Jl.call(r):"";return t==jf||t==If}function rc(r){var t=typeof r;return!!r&&(t=="object"||t=="function")}function Eh(r){return!!r&&typeof r=="object"}function ga(r){return typeof r=="symbol"||Eh(r)&&Jl.call(r)==Of}function Ch(r){return r==null?"":mh(r)}function xh(r,t,e){var n=r==null?void 0:fh(r,t);return n===void 0?e:n}var kh=xh;const Sh=Tf(kh);function pi(r,t,e){return e=e||" ",r.length>t?r:(t-=r.length,e+=e.repeat(t),r+e.slice(0,t))}class Yr extends Error{static buildMessage(t,e){function n(f){return f.charCodeAt(0).toString(16).toUpperCase()}function s(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function i(f){return f.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function a(f){switch(f.type){case"literal":return'"'+s(f.text)+'"';case"class":const c=f.parts.map(h=>Array.isArray(h)?i(h[0])+"-"+i(h[1]):i(h));return"["+(f.inverted?"^":"")+c+"]";case"any":return"any character";case"end":return"end of input";case"other":return f.description}}function o(f){const c=f.map(a);let h,d;if(c.sort(),c.length>0){for(h=1,d=1;h<c.length;h++)c[h-1]!==c[h]&&(c[d]=c[h],d++);c.length=d}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}function l(f){return f?'"'+s(f)+'"':"end of input"}return"Expected "+o(t)+" but "+l(e)+" found."}constructor(t,e,n,s){super(),this.message=t,this.expected=e,this.found=n,this.location=s,this.name="PeggySyntaxError",typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(this,Yr.prototype):this.__proto__=Yr.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Yr)}format(t){let e="Error: "+this.message;if(this.location){let n=null,s;for(s=0;s<t.length;s++)if(t[s].grammarSource===this.location.source){n=t[s].text.split(/\r\n|\n|\r/g);break}let i=this.location.start,a=this.location.source+":"+i.line+":"+i.column;if(n){let o=this.location.end,l=pi("",i.line.toString().length," "),f=n[i.line-1],c=i.line===o.line?o.column:f.length+1;e+=`
 --> `+a+`
`+l+` |
`+i.line+" | "+f+`
`+l+" | "+pi("",i.column-1," ")+pi("",c-i.column,"^")}else e+=`
 at `+a}return e}}function Ah(r,t){t=t!==void 0?t:{};const e={},n=t.grammarSource,s={Chord:dr};let i=dr;const a=function(w){return{type:"chord",...w,column:Or().start.column}},o="#",l=Ne("#",!1),f="b",c=Ne("b",!1),h=/^[a-zA-Z0-9()#+]/,d=fr([["a","z"],["A","Z"],["0","9"],"(",")","#","+"],!1,!1),y=function(w,B,M,te){return{base:w,modifier:B,suffix:M,...te,chordType:"symbol"}},$=/^[A-Ga-g]/,v=fr([["A","G"],["a","g"]],!1,!1),A="/",x=Ne("/",!1),S=function(w,B){return{bassBase:w,bassModifier:B}},D=function(w,B,M,te){return{base:B,modifier:w,suffix:M,...te,chordType:"numeral"}},P="III",O=Ne("III",!1),j="iii",L=Ne("iii",!1),N="VII",F=Ne("VII",!1),V="vii",G=Ne("vii",!1),Y="II",pe=Ne("II",!1),ce="ii",$e=Ne("ii",!1),Ee="IV",Ce=Ne("IV",!1),ie="iv",Fe=Ne("iv",!1),Ke="VI",Me=Ne("VI",!1),ot="vi",yt=Ne("vi",!1),Lt="I",ue=Ne("I",!1),Se="i",We=Ne("i",!1),Dt="V",bt=Ne("V",!1),Xt="v",Zt=Ne("v",!1),kt=function(w,B){return{bassBase:B,bassModifier:w}},tt=function(w,B,M,te){return{base:B,modifier:w,suffix:M,...te,chordType:"numeric"}},_t=/^[1-7]/,Qt=fr([["1","7"]],!1,!1);let R=0,lt=0;const Mt=[{line:1,column:1}];let rt=0,ur=[],Nt;if(t.startRule!==void 0){if(!(t.startRule in s))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');i=s[t.startRule]}function Or(){return mr(lt,R)}function Ne(w,B){return{type:"literal",text:w,ignoreCase:B}}function fr(w,B,M){return{type:"class",parts:w,inverted:B,ignoreCase:M}}function Lr(){return{type:"end"}}function hr(w){let B=Mt[w],M;if(B)return B;for(M=w-1;!Mt[M];)M--;for(B=Mt[M],B={line:B.line,column:B.column};M<w;)r.charCodeAt(M)===10?(B.line++,B.column=1):B.column++,M++;return Mt[w]=B,B}function mr(w,B){const M=hr(w),te=hr(B);return{source:n,start:{offset:w,line:M.line,column:M.column},end:{offset:B,line:te.line,column:te.column}}}function xe(w){R<rt||(R>rt&&(rt=R,ur=[]),ur.push(w))}function ln(w,B,M){return new Yr(Yr.buildMessage(w,B),w,B,M)}function dr(){let w,B;return w=R,B=un(),B===e&&(B=_(),B===e&&(B=pr())),B!==e&&(lt=w,B=a(B)),w=B,w}function vt(){let w;return r.charCodeAt(R)===35?(w=o,R++):(w=e,xe(l)),w===e&&(r.charCodeAt(R)===98?(w=f,R++):(w=e,xe(c))),w}function Jt(){let w,B;for(w=[],h.test(r.charAt(R))?(B=r.charAt(R),R++):(B=e,xe(d));B!==e;)w.push(B),h.test(r.charAt(R))?(B=r.charAt(R),R++):(B=e,xe(d));return w}function pr(){let w,B,M,te,_e;return w=R,B=br(),B!==e?(M=vt(),M===e&&(M=null),M!==e?(te=R,_e=Jt(),_e!==e?te=r.substring(te,R):te=_e,te!==e?(_e=cn(),_e===e&&(_e=null),_e!==e?(lt=w,B=y(B,M,te,_e),w=B):(R=w,w=e)):(R=w,w=e)):(R=w,w=e)):(R=w,w=e),w}function br(){let w;return $.test(r.charAt(R))?(w=r.charAt(R),R++):(w=e,xe(v)),w}function cn(){let w,B,M,te;return w=R,r.charCodeAt(R)===47?(B=A,R++):(B=e,xe(x)),B!==e?(M=br(),M!==e?(te=vt(),te===e&&(te=null),te!==e?(lt=w,B=S(M,te),w=B):(R=w,w=e)):(R=w,w=e)):(R=w,w=e),w}function un(){let w,B,M,te,_e;return w=R,B=vt(),B===e&&(B=null),B!==e?(M=Dr(),M!==e?(te=R,_e=Jt(),_e!==e?te=r.substring(te,R):te=_e,te!==e?(_e=fn(),_e===e&&(_e=null),_e!==e?(lt=w,B=D(B,M,te,_e),w=B):(R=w,w=e)):(R=w,w=e)):(R=w,w=e)):(R=w,w=e),w}function Dr(){let w;return r.substr(R,3)===P?(w=P,R+=3):(w=e,xe(O)),w===e&&(r.substr(R,3)===j?(w=j,R+=3):(w=e,xe(L)),w===e&&(r.substr(R,3)===N?(w=N,R+=3):(w=e,xe(F)),w===e&&(r.substr(R,3)===V?(w=V,R+=3):(w=e,xe(G)),w===e&&(r.substr(R,2)===Y?(w=Y,R+=2):(w=e,xe(pe)),w===e&&(r.substr(R,2)===ce?(w=ce,R+=2):(w=e,xe($e)),w===e&&(r.substr(R,2)===Ee?(w=Ee,R+=2):(w=e,xe(Ce)),w===e&&(r.substr(R,2)===ie?(w=ie,R+=2):(w=e,xe(Fe)),w===e&&(r.substr(R,2)===Ke?(w=Ke,R+=2):(w=e,xe(Me)),w===e&&(r.substr(R,2)===ot?(w=ot,R+=2):(w=e,xe(yt)),w===e&&(r.charCodeAt(R)===73?(w=Lt,R++):(w=e,xe(ue)),w===e&&(r.charCodeAt(R)===105?(w=Se,R++):(w=e,xe(We)),w===e&&(r.charCodeAt(R)===86?(w=Dt,R++):(w=e,xe(bt)),w===e&&(r.charCodeAt(R)===118?(w=Xt,R++):(w=e,xe(Zt))))))))))))))),w}function fn(){let w,B,M,te;return w=R,r.charCodeAt(R)===47?(B=A,R++):(B=e,xe(x)),B!==e?(M=vt(),M===e&&(M=null),M!==e?(te=Dr(),te!==e?(lt=w,B=kt(M,te),w=B):(R=w,w=e)):(R=w,w=e)):(R=w,w=e),w}function _(){let w,B,M,te,_e;return w=R,B=vt(),B===e&&(B=null),B!==e?(M=he(),M!==e?(te=R,_e=Jt(),_e!==e?te=r.substring(te,R):te=_e,te!==e?(_e=Ft(),_e===e&&(_e=null),_e!==e?(lt=w,B=tt(B,M,te,_e),w=B):(R=w,w=e)):(R=w,w=e)):(R=w,w=e)):(R=w,w=e),w}function he(){let w;return _t.test(r.charAt(R))?(w=r.charAt(R),R++):(w=e,xe(Qt)),w}function Ft(){let w,B,M,te;return w=R,r.charCodeAt(R)===47?(B=A,R++):(B=e,xe(x)),B!==e?(M=vt(),M===e&&(M=null),M!==e?(te=he(),te!==e?(lt=w,B=kt(M,te),w=B):(R=w,w=e)):(R=w,w=e)):(R=w,w=e),w}if(Nt=i(),Nt!==e&&R===r.length)return Nt;throw Nt!==e&&R<r.length&&xe(Lr()),ln(ur,rt<r.length?r.charAt(rt):null,rt<r.length?mr(rt,rt+1):mr(rt,rt))}const Th=Ah,Pr="verse",ir="chorus",ar="none",ya="indeterminate",Hi="tab",Xr="symbol",Zr="numeric",$r="numeral",Wi=["I","II","III","IV","V","VI","VII"],Ph="A".charCodeAt(0),jh="G".charCodeAt(0),wo={1:0,2:2,3:4,4:5,5:7,6:9,7:11},Eo={1:0,2:2,3:3,4:5,5:7,6:8,7:11};function Ih(r){return r.toUpperCase().charCodeAt(0)}function Co(r,t,e){let n=r;return n<t?n+=7:n>e&&(n-=7),n}function Oh(r){for(let t=0,e=Wi.length;t<e;t+=1){const n=Wi[t];if(n===r||n.toLowerCase()===r)return t+1}return null}function Lh(r){return Wi[r-1]}class Gr{constructor({note:t,type:e,minor:n=!1}){X(this,"minor",!1);this._note=t,this.type=e,this.minor=n}static parse(t){const e=t.toString();if(/^[A-Ga-g]$/.test(e))return new Gr({note:e.toUpperCase(),type:Xr});if(/^[1-7]$/.test(e))return new Gr({note:parseInt(e,10),type:Zr});const n=Oh(e);if(n)return new Gr({note:n,type:$r,minor:e.toLowerCase()===t});throw new Error(`Invalid note ${t}`)}toNumeral(){if(this.isNumeral())return this.clone();if(this.isNumeric())return this.set({type:$r});throw new Error(`Converting a ${this.type} note to numeral is not supported`)}toNumeric(){if(this.isNumeric())return this.clone();if(this.isNumeral())return this.set({type:Zr});throw new Error(`Converting a ${this.type} note to numeric is not supported`)}isMinor(){return this.minor}equals(t){return this._note===t._note&&this.type===t.type&&this.minor===t.minor}clone(){return this.set({})}up(){return this.change(1)}down(){return this.change(-1)}isOneOf(...t){return t.includes(this._note)}isNumeric(){return this.is(Zr)}isChordSymbol(){return this.is(Xr)}isNumeral(){return this.is($r)}is(t){return this.type===t}getTransposeDistance(t){if(typeof this._note=="number"){if(t&&this._note in Eo)return Eo[this._note];if(this._note in wo)return wo[this._note]}return 0}change(t){if(this.isChordSymbol()){let n;return n=Ih(this._note),n+=t,n=Co(n,Ph,jh),this.set({note:String.fromCharCode(n)})}let e=Co(this._note+t,1,7);return e<1?e+=7:e>7&&(e-=7),this.set({note:e})}get note(){if(this.isNumeral()){const t=Lh(this._note);return this.isMinor()?t.toLowerCase():t}return this._note}toString(){const t=this.note;switch(this.type){case $r:return`${this.minor?t.toLowerCase():t.toUpperCase()}`;default:return`${this.note}`}}set(t){return new Gr({note:this._note,type:this.type,minor:this.minor,...t})}}var xo=Gr;const Dh={Ab:{B:"Cb"},Cb:{B:"Cb","A#":"Bb",E:"Fb"},C:{"C#":"Db","D#":"Eb","F#":"Gb","G#":"Ab","A#":"Bb"},"C#":{Eb:"D#",Bb:"A#"},Db:{B:"Cb","F#":"Gb"},D:{"D#":"Eb","A#":"Bb",Gb:"F#"},Eb:{"D#":"Eb","F#":"Gb","G#":"Ab","A#":"Bb"},E:{Ab:"G#","A#":"Bb","D#":"Eb",Db:"C#",Eb:"D#"},F:{"A#":"Bb","F#":"Gb","C#":"Db","D#":"Eb","G#":"Ab"},"F#":{Bb:"A#",Eb:"D#"},Gb:{"A#":"Bb","D#":"Eb","G#":"Ab",B:"Cb",E:"Fb"},G:{"A#":"Bb","D#":"Eb","G#":"Ab","C#":"Db"},"G#":{"A#":"Bb","D#":"Eb",Cb:"B#"},Am:{Gb:"G","G#":"Ab","F#":"Gb","C#":"Db","D#":"Eb","A#":"Bb"},Bbm:{Cb:"B",Gb:"F#"},Bm:{"A#":"Bb","D#":"Eb"},"C#m":{"A#":"Bb","D#":"Eb",Gb:"F#"},Cm:{"G#":"Ab","A#":"Bb","D#":"Eb","F#":"Gb","C#":"Db"},Dm:{"A#":"Bb","D#":"Eb","F#":"Gb","G#":"Ab","C#":"Db"},Em:{"A#":"Bb","D#":"Eb","C#":"Db"},"F#m":{"A#":"Bb","D#":"Eb",Gb:"F#",Ab:"G#",Db:"C#"},Fm:{"G#":"Ab","A#":"Bb","D#":"Eb","F#":"Gb","C#":"Db"},Gm:{"G#":"Ab","A#":"Bb","D#":"Eb","C#":"Db","F#":"Gb"},"G#m":{"A#":"Bb","D#":"Eb"},B:{Eb:"D#"}};var Mh=Dh;const nc=r=>r.items.some(t=>t instanceof Je&&!!t.chords),_a=r=>"evaluate"in r&&typeof r.evaluate=="function",ko=(r,t)=>{let e=r;for(let n=r.length;n<t;n+=1,e+=" ");return e};function Nh(r){return r.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function Fh(r,t=""){return Object.entries(r).map(([e,n])=>{const s=Object.entries(n).map(([a,o])=>`${Nh(a)}: ${o};`).join(`
  `);return`
${`${t} ${e}`.trim()} {
  ${s}
}`.substring(1)}).join(`

`)}function sc(r){try{throw new Error(`DEPRECATION: ${r}`)}catch(t){const e=t,n=globalThis.process;typeof n=="object"&&typeof n.emitWarning=="function"?n.emitWarning(`${r}
${e.stack}`):console.warn(`${r}
${e.stack}`)}}function So(r){throw new Error(`BREAKING CHANGE: ${r}`)}function Hs(r){return r==null||r===""}function Kh(r){return typeof r!="string"?!1:r[0]==="m"&&r.substring(0,3).toLowerCase()!=="maj"}function ic(r){return r.replace(/\r\n?/g,`
`)}const Bt="b",zt="#",Rh=/^(?<note>[A-G])(?<modifier>#|b)?(?<minor>m)?$/i,Bh=/^(?<modifier>#|b)?(?<note>[1-7])(?<minor>m)?$/,zh=/^(?<modifier>#|b)?(?<note>I{1,3}|IV|VI{0,2}|i{1,3}|iv|vi{0,2})$/,Ao=[Rh,Bh,zh];function Vh(r){switch(r){case zt:return 1;case Bt:return-1;default:return 0}}class Tt{constructor({note:t,modifier:e=null,minor:n=!1}){X(this,"modifier",null);X(this,"minor",!1);this.note=t instanceof xo?t:xo.parse(t),this.modifier=e||null,this.minor=n||!1,this.minor&&(this.note.minor=!0)}get unicodeModifier(){switch(this.modifier){case Bt:return"♭";case zt:return"♯";default:return null}}static parse(t){if(!t||Hs(t))return null;for(let e=0,n=Ao.length;e<n;e+=1){const s=t.match(Ao[e]);if(s){const{note:i,modifier:a,minor:o}=s.groups;return new Tt({note:i,modifier:a,minor:!!o})}}return null}static parseOrFail(t){const e=this.parse(t);if(!e)throw new Error(`Failed to parse ${t}`);return e}static wrap(t){return t instanceof Tt?t:this.parse(t)}static wrapOrFail(t=null){if(t===null)throw new Error("Unexpected null key");const e=this.wrap(t);if(e===null)throw new Error(`Failed: invalid key ${t}`);return e}static toString(t){return`${Tt.wrapOrFail(t)}`}static distance(t,e){return this.wrapOrFail(t).distanceTo(e)}distanceTo(t){const e=Tt.wrapOrFail(t);let n=this.useModifier(e.modifier),s=0;for(;!n.equals(e)&&s<20;)n=n.transposeUp().useModifier(e.modifier),s+=1;return s}isMinor(){return this.minor||this.note.isMinor()}clone(){return this.set({})}toChordSymbol(t){if(this.is(Xr))return this.clone();const e=this.note.getTransposeDistance(t.minor)+Vh(this.modifier);return t.transpose(e).normalize().useModifier(t.modifier)}toChordSymbolString(t){return this.toChordSymbol(t).toString()}is(t){return this.note.is(t)}isNumeric(){return this.is(Zr)}isChordSymbol(){return this.is(Xr)}isNumeral(){return this.is($r)}equals(t){return this.note.equals(t.note)&&this.modifier===t.modifier}toNumeric(t=null){if(this.isNumeric())return this.clone();if(this.isNumeral())return this.set({note:this.note.toNumeric()});if(!t)throw new Error("key is required");return this.transposeNoteUpToKey(1,t)}toNumericString(t=null){return this.toNumeric(t).toString()}toNumeral(t=null){return this.isNumeral()?this.clone():this.isNumeric()?this.set({note:this.note.toNumeral()}):t?this.transposeNoteUpToKey("I",t):this.clone()}toNumeralString(t=null){return this.toNumeral(t).toString()}toString({showMinor:t=!0,useUnicodeModifier:e=!1}={}){switch(this.note.type){case Xr:return this.formatChordSymbolString(t,e);case Zr:return this.formatNumericString(t);case $r:return this.formatNumeralString();default:throw new Error(`Unexpected note type ${this.note.type}`)}}formatChordSymbolString(t,e){const n=e?this.unicodeModifier:this.modifier;return`${this.note}${n||""}${this.minor&&t?"m":""}`}formatNumericString(t){return`${this.modifier||""}${this.note}${this.minor&&t?"m":""}`}formatNumeralString(){return`${this.modifier||""}${this.note}`}transpose(t){if(t===0)return this;const e=this.modifier;let n=this.clone();const s=t<0?"transposeDown":"transposeUp";for(let i=0,a=Math.abs(t);i<a;i+=1)n=n[s]();return n.useModifier(e)}transposeUp(){return this.modifier===Bt?this.set({modifier:null}):this.note.isOneOf(3,7,"E","B")?this.set({note:this.note.up()}):this.modifier===zt?this.set({note:this.note.up(),modifier:null}):this.set({modifier:zt})}transposeDown(){return this.modifier===zt?this.set({modifier:null}):this.note.isOneOf(1,4,"C","F")?this.set({note:this.note.down()}):this.modifier===Bt?this.set({note:this.note.down(),modifier:null}):this.set({modifier:Bt})}useModifier(t){return this.modifier===Bt&&t===zt?this.set({note:this.note.down(),modifier:zt}):this.modifier===zt&&t===Bt?this.set({note:this.note.up(),modifier:Bt}):this.clone()}normalize(){return this.modifier===zt&&this.note.isOneOf(3,7,"E","B")?this.set({note:this.note.up(),modifier:null}):this.modifier===Bt&&this.note.isOneOf(1,4,"C","F")?this.set({note:this.note.down(),modifier:null}):this.clone()}removeMinor(){return this.set({minor:!1})}normalizeEnharmonics(t){if(t){const e=Tt.wrapOrFail(t).toString({showMinor:!0}),n=Mh[e],s=this.toString({showMinor:!1});if(n&&n[s])return Tt.parseOrFail(n[s])}return this.clone()}set(t){return new Tt({note:this.note.clone(),modifier:this.modifier,minor:this.minor,...t})}transposeNoteUpToKey(t,e){let n=new Tt({note:t}),s=e.clone();const i=this.clone().normalize().useModifier(e.modifier).normalizeEnharmonics(e);for(;!s.equals(i);)n=n.transposeUp().useModifier(e.modifier),s=s.transposeUp().normalize().useModifier(e.modifier).normalizeEnharmonics(e);return n}}var wt=Tt;const Gh={2:"2",4:"sus",5:"5",6:"6",7:"7",9:"9",11:"11",13:"13",42:"4(2)",69:"6(9)","(#4)":"(#4)","#4":"(#4)","+4":"(#4)","(+4)":"(#4)","(11)":"(11)",add11:"(11)","(add11)":"(11)","(13)":"(13)",add13:"(13)","(add13)":"(13)","(2)":"(2)",add2:"(2)","(add2)":"(2)","(4)":"(4)",add4:"(4)","(add4)":"(4)","sus(4)":"(4)","(6)":"(6)",add6:"(6)","(add6)":"(6)","(7)":"(7)","(9)":"(9)",add9:"(9)","(add9)":"(9)","(b5)":"(b5)","-5":"(b5)","(-5)":"(b5)",b5:"(b5)","2(6)":"2(6)","(b6)":"(b6)","(unis)":"(unis)",unis:"(unis)","[blank]":"[blank]",maj:"[blank]",major:"[blank]",M:"[blank]",ma:"[blank]",Ma:"[blank]",Majj:"[blank]","+":"+",aug:"+","(#5)":"+","#5":"+","+5":"+","(+5)":"+",x:"+",dom11:"11","dom 11":"11","11(#5)":"11(#5)","11#5":"11(#5)","11+5":"11(#5)","11(+5)":"11(#5)","11(#9)":"11(#9)","11#9":"11(#9)","11+9":"11(#9)","11(+9)":"11(#9)","11(b13)":"11(b13)","11b13":"11(b13)","11-13":"11(b13)","11(-13)":"11(b13)","11(b5)":"11(b5)","11b5":"11(b5)","11-5":"11(b5)","11(-5)":"11(b5)","11(b9)":"11(b9)","11b9":"11(b9)","11-9":"11(b9)","11(-9)":"11(b9)","11sus4":"11sus4","11sus":"11sus4",m11sus4:"11sus4",m11sus:"11sus4",dom13:"13","dom 13":"13","13(#11)":"13(#11)","13#11":"13(#11)","13+11":"13(#11)","13(+11)":"13(#11)","13(#5)":"13(#5)","13#5":"13(#5)","13+5":"13(#5)","13(+5)":"13(#5)","13(#9)":"13(#9)","13#9":"13(#9)","13(+9)":"13(#9)","13+9":"13(#9)","13(#9#5)":"13(#9#5)","13#9#5":"13(#9#5)","13(+9+5)":"13(#9#5)","13+9+5":"13(#9#5)","13(#9b5)":"13(#9b5)","13#9b5":"13(#9b5)","13(+9-5)":"13(#9b5)","13+9-5":"13(#9b5)","13(add4)":"13(add4)","13(b5)":"13(b5)","13b5":"13(b5)","13-5":"13(b5)","13(-5)":"13(b5)","13(b9)":"13(b9)","13b9":"13(b9)","13-9":"13(b9)","13(-9)":"13(b9)","13(b9#5)":"13(b9#5)","13b9#5":"13(b9#5)","13-9+5":"13(b9#5)","13(-9+5)":"13(b9#5)","13(b9b5)":"13(b9b5)","13b9b5":"13(b9b5)","13-9-5":"13(b9b5)","13(-9-5)":"13(b9b5)","13sus4":"13sus4","13sus":"13sus4",m13sus4:"13sus4",m13sus:"13sus4",sus2:"2","add9(no3)":"2","2(#11)":"2(#11)","2(#4)":"2(#4)","2+4":"2(#4)","2#4":"2(#4)","2(+4)":"2(#4)","(#4)2":"2(#4)","2(#4)(#42)(2#4)":"2(#4)(#42)(2#4)","2(+7)":"2(+7)","2(4)":"2(4)","sus2(4)":"2(4)","2(ma7)":"2(ma7)","2(no3)":"2(no3)","4(2)":"4(2)",sus42:"4(2)",no3:"5","(no3)":"5","(no 3)":"5","(no 3rd)":"5","5(no3)":"5","6(2)":"6(2)","6(b9)":"6(b9)","6(no3)":"6(no3)","6(9)":"6(9)","6(add9)":"6(9)",dom7:"7","dom 7":"7","dom 7th":"7","7(#11)":"7(#11)","7#11":"7(#11)","7+11":"7(#11)","7(+11)":"7(#11)","7(#5)":"7(#5)",aug7:"7(#5)","7#5":"7(#5)","7+5":"7(#5)","7(+5)":"7(#5)",x7:"7(#5)","aug 7":"7(#5)","aug 7th":"7(#5)","7(#5#11)":"7(#5#11)","7#5#11":"7(#5#11)","7+5+11":"7(#5#11)","7(+5+11)":"7(#5#11)","7(#9)":"7(#9)","7#9":"7(#9)","7+9":"7(#9)","7(+9)":"7(#9)","7(#9#5)":"7(#9#5)","7(#5#9)":"7(#9#5)","7#5#9":"7(#9#5)","7+5+9":"7(#9#5)","7(+5+9)":"7(#9#5)","7(#9b13)":"7(#9b13)","7#9b13":"7(#9b13)","7(+9-13)":"7(#9b13)","7+9-13":"7(#9b13)","7(b13#9)":"7(#9b13)","7b13#9":"7(#9b13)","7-13+9":"7(#9b13)","7(-13+9)":"7(#9b13)","7(#9b5)":"7(#9b5)","7(6)":"7(6)","7(b13)":"7(b13)","7b13":"7(b13)","7-13":"7(b13)","7(-13)":"7(b13)","7(b5)":"7(b5)","7b5":"7(b5)","7-5":"7(b5)","7(-5)":"7(b5)","7(b5#11)":"7(b5#11)","7b5#11":"7(b5#11)","7-5+11":"7(b5#11)","7(-5+11)":"7(b5#11)","7(b5#9)":"7(b5#9)","7b5#9":"7(b5#9)","7-5+9":"7(b5#9)","7(-5+9)":"7(b5#9)","7(b5b9)":"7(b5b9)","7b5b9":"7(b5b9)","7-5-9":"7(b5b9)","7(-5-9)":"7(b5b9)","7(b9)":"7(b9)","7b9":"7(b9)","7-9":"7(b9)","7(-9)":"7(b9)","7(b9#5)":"7(b9#5)","7(#5b9)":"7(b9#5)","7#5b9":"7(b9#5)","7+5-9":"7(b9#5)","7(+5-9)":"7(b9#5)","7(b9b13)":"7(b9b13)","7b9b13":"7(b9b13)","7-9-13":"7(b9b13)","7(-9-13)":"7(b9b13)","7(b13b9)":"7(b9b13)","7b13b9":"7(b9b13)","7-13-9":"7(b9b13)","7(-13-9)":"7(b9b13)","7(b9b5)":"7(b9b5)","7(no3)":"7(no3)","7aug5":"7aug5","7b9sus4":"7b9sus4","7sus(6)":"7sus(6)","7sus(b9)":"7sus(b9)","7sus4":"7sus4","7sus":"7sus4",dom9:"9","dom 9":"9","9(#11)":"9(#11)","9#11":"9(#11)","9+11":"9(#11)","9(+11)":"9(#11)","9(#5)":"9(#5)","9#5":"9(#5)","9+5":"9(#5)","9(+5)":"9(#5)",aug9:"9(#5)",x9:"9(#5)","9(b13)":"9(b13)","9b13":"9(b13)","9-13":"9(b13)","9(-13)":"9(b13)","9(b5)":"9(b5)","9b5":"9(b5)","9-5":"9(b5)","9(-5)":"9(b5)","9aug":"9aug","9sus4":"9sus4","9sus":"9sus4",m9sus4:"9sus4",m9sus:"9sus4","b69(#11)":"b69(#11)",b69sus:"b69sus",b9sus:"b9sus",dim:"dim","m(b5)":"dim",mb5:"dim","m-5":"dim","m(-5)":"dim","-(b5)":"dim","-b5":"dim",dim7:"dim7",o7:"dim7","dim 7":"dim7","dim 7th":"dim7",m:"m",mi:"m",min:"m",minor:"m","-":"m","m(11)":"m(11)","m(add11)":"m(11)","m(4)":"m(4)","m(add4)":"m(4)","m(9)":"m(9)","m(add9)":"m(9)","m(ma7)":"m(ma7)","m(M7)":"m(ma7)","mi(maj7)":"m(ma7)","min(maj7)":"m(ma7)","m(maj7)":"m(ma7)","m(+7)":"m(ma7)","m+7":"m(ma7)","m(ma9)":"m(ma9)","m(M9)":"m(ma9)","mi(maj9)":"m(ma9)","min(maj9)":"m(ma9)","m(maj9)":"m(ma9)","m(+9)":"m(ma9)","m+9":"m(ma9)","m(no5)":"m(no5)",m11:"m11",mi11:"m11",min11:"m11","-11":"m11","m11(#5)":"m11(#5)","m11#5":"m11(#5)","m11+5":"m11(#5)","m11(+5)":"m11(#5)","-11(#5)":"m11(#5)","-11#5":"m11(#5)","m9+5":"m9(#5)","-11(+5)":"m11(#5)","m11(#9)":"m11(#9)","m11#9":"m11(#9)","m11+9":"m11(#9)","m11(+9)":"m11(#9)","-11(#9)":"m11(#9)","-11#9":"m11(#9)","-11+9":"m11(#9)","-11(+9)":"m11(#9)","m11(#9#5)":"m11(#9#5)","m11(#5#9)":"m11(#9#5)","m11#5#9":"m11(#9#5)","m11+5+9":"m11(#9#5)","m11(+5+9)":"m11(#9#5)","-11(#5#9)":"m11(#9#5)","-11#5#9":"m11(#9#5)","m9+5+9":"m11(#9#5)","-11(+5+9)":"m11(#9#5)","m11(#9b13)":"m11(#9b13)","m11#9b13":"m11(#9b13)","m11+9-13":"m11(#9b13)","m11(+9-13)":"m11(#9b13)","-11(#9b13)":"m11(#9b13)","-11#9b13":"m11(#9b13)","-11+9-13":"m11(#9b13)","-11(+9-13)":"m11(#9b13)","m11(b13)":"m11(b13)",m11b13:"m11(b13)","m11-13":"m11(b13)","m11(-13)":"m11(b13)","-11(b13)":"m11(b13)","-11b13":"m11(b13)","-11-13":"m11(b13)","-11(-13)":"m11(b13)","m11(b13#5)":"m11(b13#5)","m11(#5b13)":"m11(b13#5)","m11#5b13":"m11(b13#5)","m11+5-13":"m11(b13#5)","m11(+5-13)":"m11(b13#5)","-11(#5b13)":"m11(b13#5)","-11#5b13":"m11(b13#5)","-11+5-13":"m11(b13#5)","-11(+5-13)":"m11(b13#5)","m11(b5)":"m11(b5)",m11b5:"m11(b5)","m11-5":"m11(b5)","m11(-5)":"m11(b5)","-11(b5)":"m11(b5)","-11b5":"m11(b5)","-9-5":"m9(b5)","-11(-5)":"m11(b5)","m11(b5#9)":"m11(b5#9)","m11b5#9":"m11(b5#9)","m11-5+9":"m11(b5#9)","m11(-5+9)":"m11(b5#9)","-11(b5#9)":"m11(b5#9)","-11b5#9":"m11(b5#9)","-11-5+9":"m11(b5#9)","-11(-5+9)":"m11(b5#9)","m11(b5b13)":"m11(b5b13)",m11b5b13:"m11(b5b13)","m11(-5-13)":"m11(b5b13)","m11-5-13":"m11(b5b13)","-11(b5b13)":"m11(b5b13)","-11b5b13":"m11(b5b13)","-11(-5-13)":"m11(b5b13)","-11-5-13":"m11(b5b13)","m11(b5b9)":"m11(b5b9)",m11b5b9:"m11(b5b9)","m11-5-9":"m11(b5b9)","m11(-5-9)":"m11(b5b9)","-11(b5b9)":"m11(b5b9)","-11b5b9":"m11(b5b9)","-11-5-9":"m11(b5b9)","-11(-5-9)":"m11(b5b9)","m11(b9)":"m11(b9)",m11b9:"m11(b9)","m11(-9)":"m11(b9)","m11-9":"m11(b9)","-11(b9)":"m11(b9)","-11b9":"m11(b9)","-11(-9)":"m11(b9)","-11-9":"m11(b9)","m11(b9#5)":"m11(b9#5)","m11(#5b9)":"m11(b9#5)","m11#5b9":"m11(b9#5)","m11+5-9":"m11(b9#5)","m11(+5-9)":"m11(b9#5)","-11(#5b9)":"m11(b9#5)","-11#5b9":"m11(b9#5)","m9+5-9":"m11(b9#5)","-11(+5-9)":"m11(b9#5)","m11(b9b13)":"m11(b9b13)",m11b9b13:"m11(b9b13)","m11(-9-13)":"m11(b9b13)","m11-9-13":"m11(b9b13)","-11(b9b13)":"m11(b9b13)","-11b9b13":"m11(b9b13)","-11(-9-13)":"m11(b9b13)","-11-9-13":"m11(b9b13)",m13:"m13",mi13:"m13",min13:"m13","-13":"m13","m13(#11)":"m13(#11)","m13#11":"m13(#11)","m13+11":"m13(#11)","m13(+11)":"m13(#11)","-13(#11)":"m13(#11)","-13#11":"m13(#11)","-13+11":"m13(#11)","-13(+11)":"m13(#11)","m13(#5)":"m13(#5)","m13#5":"m13(#5)","m13+5":"m13(#5)","m13(+5)":"m13(#5)","-13(#5)":"m13(#5)","-13#5":"m13(#5)","-13(+5)":"m13(#5)","m13(#9)":"m13(#9)","m13#9":"m13(#9)","m13(+9)":"m13(#9)","m13+9":"m13(#9)","-13(#9)":"m13(#9)","-13#9":"m13(#9)","-13(+9)":"m13(#9)","-13+9":"m13(#9)","m13(b5)":"m13(b5)",m13b5:"m13(b5)","m13-5":"m13(b5)","m13(-5)":"m13(b5)","-13(b5)":"m13(b5)","-13b5":"m13(b5)","-13-5":"m13(b5)","-13(-5)":"m13(b5)","m13(b9)":"m13(b9)",m13b9:"m13(b9)","m13-9":"m13(b9)","m13(-9)":"m13(b9)","-13(b13)":"m13(b9)","-13b13":"m13(b9)","-13-13":"m13(b9)","-13(-13)":"m13(b9)",m2:"m2",mi2:"m2",min2:"m2","m(add2)":"m2",madd2:"m2",m4:"m4",m6:"m6",mi6:"m6",min6:"m6","-6":"m6","m6(#5)":"m6(#5)","m6(9)":"m6(9)",m6add9:"m6(9)","m6(add9)":"m6(9)",m69:"m6(9)","m6(ma7)":"m6(ma7)","m6(M7)":"m6(ma7)","m6(+7)":"m6(ma7)",m6M7:"m6(ma7)","m6+7":"m6(ma7)",m7:"m7",mi7:"m7",min7:"m7","-7":"m7","m7(#11)":"m7(#11)","m7#11":"m7(#11)","m7+11":"m7(#11)","m7(+11)":"m7(#11)","-7(#11)":"m7(#11)","-7#11":"m7(#11)","-7+11":"m7(#11)","-7(+11)":"m7(#11)","m7(#5)":"m7(#5)","m7#5":"m7(#5)","m7+5":"m7(#5)","m7(+5)":"m7(#5)","-7(#5)":"m7(#5)","-7#5":"m7(#5)","-7(+5)":"m7(#5)","m7(#9)":"m7(#9)","m7#9":"m7(#9)","m7+9":"m7(#9)","m7(+9)":"m7(#9)","-7(#9)":"m7(#9)","-7#9":"m7(#9)","-7(+9)":"m7(#9)","m7(11)":"m7(11)","m7(4)":"m7(4)","m7(add4)":"m7(4)","m7(add11)":"m7(4)",m74:"m7(4)","m7(6)":"m7(6)","m7(add6)":"m7(add6)","m7(b13)":"m7(b13)",m7b13:"m7(b13)","m7-13":"m7(b13)","m7(-13)":"m7(b13)","-7(b13)":"m7(b13)","-7b13":"m7(b13)","-7-13":"m7(b13)","-7(-13)":"m7(b13)","m7(b5)":"m7(b5)",m7b5:"m7(b5)","m7-5":"m7(b5)","m7(-5)":"m7(b5)","-7(b5)":"m7(b5)","-7b5":"m7(b5)","-7(-5)":"m7(b5)","m7(b9)":"m7(b9)",m7b9:"m7(b9)","m7-9":"m7(b9)","m7(-9)":"m7(b9)","-7(b9)":"m7(b9)","-7b9":"m7(b9)","-7(-9)":"m7(b9)","m7(no3)":"m7(no3)","min7(no3)":"m7(no3)",m7sus4:"m7sus4",m7sus:"m7sus4",m9:"m9",mi9:"m9",min9:"m9","-9":"m9","m9(#11)":"m9(#11)","m9#11":"m9(#11)","m9+11":"m9(#11)","m9(+11)":"m9(#11)","-9(#11)":"m9(#11)","-9#11":"m9(#11)","-9+11":"m9(#11)","-9(+11)":"m9(#11)","m9(#5)":"m9(#5)","m9#5":"m9(#5)","m9(+5)":"m9(#5)","-9(#5)":"m9(#5)","-9#5":"m9(#5)","-9(+5)":"m9(#5)","m9(#7)":"m9(#7)","m9(b13)":"m9(b13)",m9b13:"m9(b13)","m9-13":"m9(b13)","m9(-13)":"m9(b13)","-9(b13)":"m9(b13)","-9b13":"m9(b13)","-9-13":"m9(b13)","-9(-13)":"m9(b13)","m9(b5)":"m9(b5)",m9b5:"m9(b5)","m9-5":"m9(b5)","m9(-5)":"m9(b5)","-9(b5)":"m9(b5)","-9b5":"m9(b5)","-9(-5)":"m9(b5)","m9(ma7)":"m9(ma7)","m9(maj7)":"m9(ma7)","m9(+7)":"m9(ma7)","m9(M7)":"m9(ma7)",m9M7:"m9(ma7)",ma9:"ma9",maj9:"ma9",ma11:"ma11","11(#7)":"ma11","11#7":"ma11","11+7":"ma11","11(+7)":"ma11","+11":"ma11",M11:"ma11","ma11(#5)":"ma11(#5)","maj11#5":"ma11(#5)","maj11+5":"ma11(#5)","maj11(+5)":"ma11(#5)","+11(#5)":"ma11(#5)","+11#5":"ma11(#5)","M11+5":"ma11(#5)","+11(+5)":"ma11(#5)","maj11(#5)":"ma11(#5)","ma11#5":"ma11(#5)","ma11+5":"ma11(#5)","ma11(+5)":"ma11(#5)","ma11(#9)":"ma11(#9)","maj11#9":"ma11(#9)","maj11+9":"ma11(#9)","maj11(+9)":"ma11(#9)","+11(#9)":"ma11(#9)","+11#9":"ma11(#9)","M11+9":"ma11(#9)","+11(+9)":"ma11(#9)","maj11(#9)":"ma11(#9)","ma11#9":"ma11(#9)","ma11+9":"ma11(#9)","ma11(+9)":"ma11(#9)","ma11(b13)":"ma11(b13)",maj11b13:"ma11(b13)","maj11-13":"ma11(b13)","maj11(-13)":"ma11(b13)","+11(b13)":"ma11(b13)","+11b13":"ma11(b13)","M11-13":"ma11(b13)","+11(-13)":"ma11(b13)","maj11(b13)":"ma11(b13)",ma11b13:"ma11(b13)","ma11-13":"ma11(b13)","ma11(-13)":"ma11(b13)","ma11(b5)":"ma11(b5)",maj11b5:"ma11(b5)","maj11-5":"ma11(b5)","maj11(-5)":"ma11(b5)","+11(b5)":"ma11(b5)","+11b5":"ma11(b5)","M11-5":"ma11(b5)","+11(-5)":"ma11(b5)","maj11(b5)":"ma11(b5)",ma11b5:"ma11(b5)","ma11-5":"ma11(b5)","ma11(-5)":"ma11(b5)","ma11(b9)":"ma11(b9)",maj11b9:"ma11(b9)","maj11(-9)":"ma11(b9)","maj11-9":"ma11(b9)","+11(b9)":"ma11(b9)","+11b9":"ma11(b9)","M11(-9)":"ma11(b9)","+11-9":"ma11(b9)","maj11(b9)":"ma11(b9)",ma11b9:"ma11(b9)","ma11(-9)":"ma11(b9)","ma11-9":"ma11(b9)",ma13:"ma13","13(#7)":"ma13","+13":"ma13",M13:"ma13","ma13(#11)":"ma13(#11)","maj13#11":"ma13(#11)","maj13+11":"ma13(#11)","maj13(+11)":"ma13(#11)","+13(#11)":"ma13(#11)","+13#11":"ma13(#11)","M13+11":"ma13(#11)","+13(+11)":"ma13(#11)","maj13(#11)":"ma13(#11)","ma7#11":"ma9(#11)","ma13+11":"ma13(#11)","ma13(+11)":"ma13(#11)","ma13(#11#5)":"ma13(#11#5)","maj13#11#5":"ma13(#11#5)","maj13+11+5":"ma13(#11#5)","maj13(+11+5)":"ma13(#11#5)","+13(#11#5)":"ma13(#11#5)","+13#11#5":"ma13(#11#5)","M13+11+5":"ma13(#11#5)","+13(+11+5)":"ma13(#11#5)","maj13(#11#5)":"ma13(#11#5)","ma7#11#5":"ma9(#11#5)","ma13+11+5":"ma13(#11#5)","ma13(+11+5)":"ma13(#11#5)","ma13(#5)":"ma13(#5)","maj13#5":"ma13(#5)","maj13+5":"ma13(#5)","maj13(+5)":"ma13(#5)","+13(#5)":"ma13(#5)","+13#5":"ma13(#5)","M13+5":"ma13(#5)","+13(+5)":"ma13(#5)","maj13(#5)":"ma13(#5)","ma13#5":"ma13(#5)","ma13+5":"ma13(#5)","ma13(+5)":"ma13(#5)","ma13(#9)":"ma13(#9)","maj13#9":"ma13(#9)","maj13(+9)":"ma13(#9)","maj13+9":"ma13(#9)","+13(#9)":"ma13(#9)","+13#9":"ma13(#9)","M13(+9)":"ma13(#9)","+13+9":"ma13(#9)","maj13(#9)":"ma13(#9)","ma13#9":"ma13(#9)","ma13(+9)":"ma13(#9)","ma13+9":"ma13(#9)","ma13(#9#5)":"ma13(#9#5)","maj13#9#5":"ma13(#9#5)","maj13(+9+5)":"ma13(#9#5)","maj13+9+5":"ma13(#9#5)","+13(#9#5)":"ma13(#9#5)","+13#9#5":"ma13(#9#5)","M13(+9+5)":"ma13(#9#5)","+13+9+5":"ma13(#9#5)","maj13(#9#5)":"ma13(#9#5)","ma7#9#5":"ma13(#9#5)","ma13(+9+5)":"ma13(#9#5)","ma13+9+5":"ma13(#9#5)","ma13(b5)":"ma13(b5)",maj13b5:"ma13(b5)","maj13-5":"ma13(b5)","maj13(-5)":"ma13(b5)","+13(b5)":"ma13(b5)","+13b5":"ma13(b5)","M13-5":"ma13(b5)","+13(-5)":"ma13(b5)","maj13(b5)":"ma13(b5)",ma13b5:"ma13(b5)","ma13-5":"ma13(b5)","ma13(-5)":"ma13(b5)","ma13(b9)":"ma13(b9)",maj13b9:"ma13(b9)","maj13-9":"ma13(b9)","maj13(-9)":"ma13(b9)","+13(b9)":"ma13(b9)","+13b9":"ma13(b9)","M13-9":"ma13(b9)","+13(-9)":"ma13(b9)","maj13(b9)":"ma13(b9)",ma13b9:"ma13(b9)","ma13-9":"ma13(b9)","ma13(-9)":"ma13(b9)","ma13(b9#5)":"ma13(b9#5)","maj13b9#5":"ma13(b9#5)","maj13-9+5":"ma13(b9#5)","maj13(-9+5)":"ma13(b9#5)","+13(b9#5)":"ma13(b9#5)","+13b9#5":"ma13(b9#5)","M13-9+5":"ma13(b9#5)","+13(-9+5)":"ma13(b9#5)","maj13(b9#5)":"ma13(b9#5)","ma7b9#5":"ma13(b9#5)","ma13-9+5":"ma13(b9#5)","ma13(-9+5)":"ma13(b9#5)",ma6:"ma6","ma6(9)":"ma6(9)",ma69:"ma6(9)",ma7:"ma7","+7":"ma7","#7":"ma7",M7:"ma7",Maj7:"ma7",maj7:"ma7","(triangle)":"ma7","ma7(#11)":"ma7(#11)","maj7#11":"ma7(#11)","maj7+11":"ma7(#11)","maj7(+11)":"ma7(#11)","+7(#11)":"ma7(#11)","+7#11":"ma7(#11)","M7+11":"ma7(#11)","+7(+11)":"ma7(#11)","maj7(#11)":"ma7(#11)","ma7+11":"ma7(#11)","ma7(+11)":"ma7(#11)","ma7(#4)":"ma7(#4)","ma7(#5)":"ma7(#5)","maj7#5":"ma7(#5)","maj7+5":"ma7(#5)","maj7(+5)":"ma7(#5)","+7(#5)":"ma7(#5)","+7#5":"ma7(#5)","M7+5":"ma7(#5)","+7(+5)":"ma7(#5)","maj7(#5)":"ma7(#5)","ma7#5":"ma7(#5)","ma7+5":"ma7(#5)","ma7(+5)":"ma7(#5)","aug(M7)":"ma7(#5)","aug(+7)":"ma7(#5)","aug(ma7)":"ma7(#5)","aug(maj7)":"ma7(#5)","ma7(#9)":"ma7(#9)","maj7#9":"ma7(#9)","maj7+9":"ma7(#9)","maj7(+9)":"ma7(#9)","+7(#9)":"ma7(#9)","+7#9":"ma7(#9)","M7+9":"ma7(#9)","+7(+9)":"ma7(#9)","maj7(#9)":"ma7(#9)","ma7#9":"ma7(#9)","ma7+9":"ma7(#9)","ma7(+9)":"ma7(#9)","ma7(b13)":"ma7(b13)",maj7b13:"ma7(b13)","maj7-13":"ma7(b13)","maj7(-13)":"ma7(b13)","+7(b13)":"ma7(b13)","+7b13":"ma7(b13)","M7-13":"ma7(b13)","+7(-13)":"ma7(b13)","maj7(b13)":"ma7(b13)",ma7b13:"ma9(b13)","ma7-13":"ma7(b13)","ma7(-13)":"ma7(b13)","ma7(b5)":"ma7(b5)",maj7b5:"ma7(b5)","maj7-5":"ma7(b5)","maj7(-5)":"ma7(b5)","+7(b5)":"ma7(b5)","+7b5":"ma7(b5)","M7-5":"ma7(b5)","+7(-5)":"ma7(b5)","maj7(b5)":"ma7(b5)",ma7b5:"ma7(b5)","ma7-5":"ma7(b5)","ma7(-5)":"ma7(b5)","ma7(b9)":"ma7(b9)",maj7b9:"ma7(b9)","maj7-9":"ma7(b9)","maj7(-9)":"ma7(b9)","+7(b9)":"ma7(b9)","+7b9":"ma7(b9)","M7-9":"ma7(b9)","+7(-9)":"ma7(b9)","maj7(b9)":"ma7(b9)",ma7b9:"ma7(b9)","ma7-9":"ma7(b9)","ma7(-9)":"ma7(b9)","ma7(no3)":"ma7(no3)","9(#7)":"ma9","+9":"ma9",M9:"ma9","ma9(#11)":"ma9(#11)","maj9#11":"ma9(#11)","maj9+11":"ma9(#11)","maj9(+11)":"ma9(#11)","+9(#11)":"ma9(#11)","+9#11":"ma9(#11)","M9+11":"ma9(#11)","+9(+11)":"ma9(#11)","maj9(#11)":"ma9(#11)","ma9+11":"ma9(#11)","ma9(+11)":"ma9(#11)","ma9(#11#5)":"ma9(#11#5)","maj9#11#5":"ma9(#11#5)","maj9+11+5":"ma9(#11#5)","maj9(+11+5)":"ma9(#11#5)","+9(#11#5)":"ma9(#11#5)","+9#11#5":"ma9(#11#5)","M9+11+5":"ma9(#11#5)","+9(+11+5)":"ma9(#11#5)","maj9(#11#5)":"ma9(#11#5)","ma9+11+5":"ma9(#11#5)","ma9(+11+5)":"ma9(#11#5)","ma9(#4)":"ma9(#4)","ma9(#5)":"ma9(#5)","maj9#5":"ma9(#5)","maj9+5":"ma9(#5)","maj9(+5)":"ma9(#5)","+9(#5)":"ma9(#5)","+9#5":"ma9(#5)","M9+5":"ma9(#5)","+9(+5)":"ma9(#5)","maj9(#5)":"ma9(#5)","ma9#5":"ma9(#5)","ma9+5":"ma9(#5)","ma9(+5)":"ma9(#5)","ma9(13)":"ma9(13)","ma9(b13)":"ma9(b13)",maj9b13:"ma9(b13)","maj9-13":"ma9(b13)","maj9(-13)":"ma9(b13)","+9(b13)":"ma9(b13)","+9b13":"ma9(b13)","M9-13":"ma9(b13)","+9(-13)":"ma9(b13)","maj9(b13)":"ma9(b13)","ma9-13":"ma9(b13)","ma9(-13)":"ma9(b13)","ma9(b13#5)":"ma9(b13#5)","maj9b13#5":"ma9(b13#5)","maj9-13+5":"ma9(b13#5)","maj9(-13+5)":"ma9(b13#5)","+9(b13#5)":"ma9(b13#5)","+9b13#5":"ma9(b13#5)","M9-13+5":"ma9(b13#5)","+9(-13+5)":"ma9(b13#5)","maj9(b13#5)":"ma9(b13#5)","ma7b13#5":"ma9(b13#5)","ma9-13+5":"ma9(b13#5)","ma9(-13+5)":"ma9(b13#5)","ma9(b5)":"ma9(b5)",maj9b5:"ma9(b5)","maj9-5":"ma9(b5)","maj9(-5)":"ma9(b5)","+9(b5)":"ma9(b5)","+9b5":"ma9(b5)","M9-5":"ma9(b5)","+9(-5)":"ma9(b5)","maj9(b5)":"ma9(b5)",ma9b5:"ma9(b5)","ma9-5":"ma9(b5)","ma9(-5)":"ma9(b5)",sus:"sus",sus4:"sus","sus(no5)":"sus(no5)","sus#42":"sus#42"};var To=Gh;function ps(r){return r===null||To[r]==="[blank]"?null:To[r]||r}class yr{static parse(t){try{return this.parseOrFail(t)}catch{return null}}static parseOrFail(t){const e=Th(t.trim());return new yr(e)}clone(){return this.set({})}toChordSymbol(t=null){var s;if(this.isChordSymbol())return this.clone();const e=wt.wrapOrFail(t);let n=new yr({suffix:this.suffix?ps(this.suffix):null,root:this.root.toChordSymbol(e),bass:((s=this.bass)==null?void 0:s.toChordSymbol(e))||null});return this.root.isMinor()&&(n=n.makeMinor()),n=n.normalize(t),n}toChordSymbolString(t=null){return this.toChordSymbol(t).toString()}isChordSymbol(){return this.is(Xr)}toNumeric(t=null){var n;if(this.isNumeric())return this.clone();if(this.isNumeral())return this.transform(s=>s.toNumeric());const e=wt.wrapOrFail(t);return new yr({suffix:ps(this.suffix),root:this.root.toNumeric(e),bass:((n=this.bass)==null?void 0:n.toNumeric(e))||null})}toNumeral(t=null){var n;if(this.isNumeral())return this.clone();if(this.isNumeric())return this.transform(s=>s.toNumeral());const e=wt.wrapOrFail(t);return new yr({suffix:ps(this.suffix),root:e?this.root.toNumeral(e):null,bass:((n=this.bass)==null?void 0:n.toNumeral(e))||null})}toNumeralString(t=null){return this.toNumeral(t).toString()}isNumeric(){return this.is(Zr)}toNumericString(t=null){return this.toNumeric(t).toString()}isNumeral(){return this.is($r)}toString({useUnicodeModifier:t=!1}={}){const e=this.root.toString({showMinor:!1,useUnicodeModifier:t})+(this.suffix||"");return this.bass?`${e}/${this.bass.toString({useUnicodeModifier:t})}`:e}normalize(t=null,{normalizeSuffix:e=!0}={}){const n=e?ps(this.suffix):this.suffix;let s=this.root.normalize().normalizeEnharmonics(t);return this.root.isMinor()&&this.bass&&(s=this.root.transpose(3).removeMinor().normalize()),this.set({suffix:n,root:this.root.normalize().normalizeEnharmonics(t),bass:this.bass?this.bass.normalize().normalizeEnharmonics(s):null})}useModifier(t){return this.transform(e=>e.useModifier(t))}transposeUp(){return this.transform(t=>t.transposeUp())}transposeDown(){return this.transform(t=>t.transposeDown())}transpose(t){return this.transform(e=>e.transpose(t))}constructor({base:t=null,modifier:e=null,suffix:n=null,bassBase:s=null,bassModifier:i=null,root:a=null,bass:o=null}){this.suffix=n||null,this.root=this.determineRoot(a,t,e,n),this.bass=this.determineBass(o,s,i)}determineRoot(t,e,n,s){if(t)return t;if(!e)throw new Error("Expected base");return new wt({note:e,modifier:n,minor:Kh(s)})}determineBass(t,e,n){return t||(e?new wt({note:e,modifier:n||null,minor:!1}):null)}makeMinor(){return!this.suffix||this.suffix[0]!=="m"?this.set({suffix:`m${this.suffix||""}`}):this.clone()}set(t){var e;return new yr({root:this.root.clone(),suffix:this.suffix,bass:((e=this.bass)==null?void 0:e.clone())||null,...t})}is(t){return this.root.is(t)&&(!this.bass||this.bass.is(t))}transform(t){return this.set({root:t(this.root),bass:this.bass?t(this.bass):null})}}var Ws=yr;class Ds{constructor(t="",e=null){this.chords=t||"",this.lyrics=e||""}isRenderable(){return!0}clone(){return new Ds(this.chords,this.lyrics)}toString(){return`ChordLyricsPair(chords=${this.chords}, lyrics=${this.lyrics})`}set({chords:t,lyrics:e}){return new Ds(t||this.chords,e||this.lyrics)}setLyrics(t){return this.set({lyrics:t})}transpose(t,e=null,{normalizeChordSuffix:n}={normalizeChordSuffix:!1}){const s=Ws.parse(this.chords.trim());if(s){let i=s.transpose(t);return e&&(i=i.normalize(e,{normalizeSuffix:n})),this.set({chords:i.toString()})}return this.clone()}}var Je=Ds;const Uh={separator:","};class qh{constructor(t=Uh){this.separator=t.separator}}var Hh=qh;const Po={evaluate:!1,metadata:{separator:","},key:null,expandChorusDirective:!1,useUnicodeModifiers:!1,normalizeChords:!0};class Wh{constructor(t=Po){const e={...Po,...t};this.evaluate=!!e.evaluate,this.expandChorusDirective=!!e.expandChorusDirective,this.useUnicodeModifiers=!!e.useUnicodeModifiers,this.normalizeChords=!!e.normalizeChords,this.metadata=new Hh(t.metadata),this.key=t.key?wt.wrap(t.key):null,this.configuration=t}get(t){return Sh(this,t)}}var Yh=Wh;class Xh{constructor(t=null){this.configuration=new Yh(t||{})}}var va=Xh;class Zh{constructor(t=null){X(this,"line",null);X(this,"column",null);X(this,"offset",null);t&&(this.line=t.line||null,this.column=t.column||null,this.offset=t.offset||null)}}var ac=Zh;const oc="album",lc="artist",qn="capo",$a="comment",cc="composer",uc="copyright",fc="duration",Fn="end_of_chorus",wa="end_of_tab",Ea="end_of_verse",Qr="key",hc="_key",mc="lyricist",Qh="start_of_bridge",rn="start_of_chorus",Ys="start_of_tab",Xs="start_of_verse",Ca="subtitle",dc="tempo",pc="time",xa="title",Jh="transpose",bc="new_key",gc="year",Ms="chordfont",Ns="chordsize",Yi="chordcolour",Fs="textfont",Ks="textsize",Xi="textcolour",yc="chorus",e1="t",t1="st",r1="c",n1="soc",s1="eoc",i1="sot",a1="eot",o1="nk",l1="cf",c1="cs",u1="tf",f1="ts",h1=[$a],m1=[oc,lc,qn,cc,uc,fc,Qr,mc,dc,pc,xa,Ca,gc],d1=[hc],p1=[rn,Fn,Ys,wa,Xs,Ea],b1=[Ms,Ns,Yi,Fs,Ks,Xi],g1=[Xs,rn,Qh,Ys,yc],jo={[e1]:xa,[t1]:Ca,[r1]:$a,[n1]:rn,[s1]:Fn,[i1]:Ys,[a1]:wa,[o1]:bc,[l1]:Ms,[c1]:Ns,[u1]:Fs,[f1]:Ks},y1=/^([^:\s]+)(:?\s*(.+))?$/,_1=/^x_(.+)$/;function Io(r){return d1.includes(r)}const v1=r=>{if(!r)return r;const t=r.trim();return t in jo?jo[t]:t};class Ur extends ac{constructor(e,n=null,s=null){super(s);X(this,"_originalName","");X(this,"_name","");X(this,"_value","");X(this,"_isMetaTag",!1);this.parseNameValue(e,n)}parseNameValue(e,n){e==="meta"?this.parseMetaTag(n):(this.name=e,this.value=n||"")}parseMetaTag(e){if(!e)throw new Error("Expected value");const[n,s]=e.split(/\s(.+)/);this.name=n,this.value=s||"",this._isMetaTag=!0}static parse(e){return e instanceof Ur?e:this.parseWithRegex(e,y1)}static parseWithRegex(e,n){const s=e.match(n);return s!==null?new Ur(s[1],s[3]||null):null}static parseOrFail(e){const n=this.parse(e);if(!n)throw new Error(`Failed to parse ${e}`);return n}isSectionDelimiter(){return p1.includes(this.name)}isInlineFontTag(){return b1.includes(this.name)}set name(e){this._name=v1(e),this._originalName=e}get name(){return this._name.trim()}get originalName(){return this._originalName.trim()}set value(e){this._value=e||""}get value(){return`${this._value}`.trim()}hasValue(){return this.value.length>0}isRenderable(){return h1.includes(this.name)||this.hasRenderableLabel()}hasRenderableLabel(){return g1.includes(this.name)&&this.hasValue()}isMetaTag(){return this._isMetaTag||_1.test(this.name)||m1.indexOf(this.name)!==-1}clone(){return new Ur(this._originalName,this.value)}toString(){return`Tag(name=${this.name}, value=${this.value})`}set({value:e}){return new Ur(this._originalName,e)}}var De=Ur;class $1 extends Error{constructor(e,n=null,s=null,i=null){super(`${e} on line ${n} column ${s}`);X(this,"line",null);X(this,"column",null);X(this,"offset",null);this.name="ExpressionError",this.line=n,this.column=s,this.offset=i}}var w1=$1;class E1 extends ac{}var ka=E1;class Sa extends ka{constructor(e,n=null){super();X(this,"expressions",[]);this.expressions=e,this.variable=n}evaluate(e,n){return this.expressions.map(s=>s.evaluate(e,n,this.variable)).join("")}isRenderable(){return!0}clone(){return new Sa(this.expressions.map(e=>e.clone()),this.variable)}}var Zi=Sa;class Aa extends ka{constructor({variable:e=null,valueTest:n=null,trueExpression:s=[],falseExpression:i=[],line:a=null,column:o=null,offset:l=null}){super({line:a,column:o,offset:l});X(this,"trueExpression",[]);X(this,"falseExpression",[]);this.variable=e||null,this.valueTest=n||null,this.trueExpression=s,this.falseExpression=i}evaluate(e,n,s=null){if(this.variable)return this.evaluateWithVariable(e,n);if(!s)throw new w1("Unexpected empty expression",this.line,this.column,this.offset);return this.evaluateToString(e.get(s)||"",n)}evaluateToString(e,n){return Array.isArray(e)?e.join(n):e}evaluateWithVariable(e,n){if(!this.variable)throw new Error("Expected this.variable to be present");const s=e.get(this.variable);return s&&(Hs(this.valueTest)||s===this.valueTest)?this.evaluateForTruthyValue(e,n,s):this.falseExpression.length?new Zi(this.falseExpression,this.variable).evaluate(e,n):""}evaluateForTruthyValue(e,n,s){return this.trueExpression.length?new Zi(this.trueExpression,this.variable).evaluate(e,n):this.evaluateToString(s,n)}isRenderable(){return!0}clone(){return new Aa({variable:this.variable,valueTest:this.valueTest,trueExpression:this.trueExpression.map(e=>e.clone()),falseExpression:this.falseExpression.map(e=>e.clone()),line:this.line,column:this.column,offset:this.offset})}}var Kn=Aa;class Ta extends ka{constructor(t){super(),this.string=t}evaluate(){return this.string}isRenderable(){return!0}clone(){return new Ta(this.string)}}var Rn=Ta;const C1=`
`;class x1 extends va{format(t){const{lines:e,metadata:n}=t;return e.map(s=>this.formatLine(s,n)).join(C1)}formatLine(t,e){return t.items.map(n=>this.formatItem(n,e)).join("")}formatItem(t,e){if(t instanceof De)return this.formatTag(t);if(t instanceof Je)return this.formatChordLyricsPair(t);if("evaluate"in t)return this.formatOrEvaluateItem(t,e);throw new Error(`Don't know how to format a ${t.constructor.name}`)}formatOrEvaluateItem(t,e){if(this.configuration.evaluate)return t.evaluate(e,this.configuration.get("metadata.separator"));if(t instanceof Kn)return this.formatTernary(t);if(t instanceof Rn)return t.evaluate();throw new Error(`Don't know how to format a ${t.constructor.name}`)}formatTernary(t){const{variable:e,valueTest:n,trueExpression:s,falseExpression:i}=t;return["%{",e||"",this.formatValueTest(n),this.formatExpressionRange(s),this.formatExpressionRange(i),"}"].join("")}formatValueTest(t){return t?`=${t}`:""}formatExpressionRange(t){return t.length?`|${t.map(e=>this.formatExpression(e)).join("")}`:""}formatExpression(t){return t instanceof Kn?this.formatTernary(t):t instanceof Rn?t.string:""}formatTag(t){return t.hasValue()?`{${t.originalName}: ${t.value}}`:`{${t.originalName}}`}formatChordLyricsPair(t){return[this.formatChordLyricsPairChords(t),this.formatChordLyricsPairLyrics(t)].join("")}formatChordLyricsPairChords(t){return t.chords?`[${t.chords}]`:""}formatChordLyricsPairLyrics(t){return t.lyrics||""}}var k1=x1;class Pa{constructor(t){this.content=t}isRenderable(){return!1}clone(){return new Pa(this.content)}toString(){return`Comment(content=${this.content})`}}var An=Pa;class ja{constructor({font:t,size:e,colour:n}={font:null,size:null,colour:null}){X(this,"font",null);X(this,"size",null);X(this,"colour",null);this.font=t?t.replace(/"/g,"'"):null,this.size=e||null,this.colour=n||null}clone(){return new ja({font:this.font,size:this.size,colour:this.colour})}toCssString(){const t={};return this.colour&&(t.color=this.colour),this.font&&this.size?t.font=`${this.size} ${this.font}`:this.font?t["font-family"]=this.font:this.size&&(t["font-size"]=`${this.size}`),Object.keys(t).map(e=>`${e}: ${t[e]}`).join("; ")}}var Rs=ja;class Bs{constructor({type:t,items:e}={type:ar,items:[]}){X(this,"items",[]);X(this,"type",ar);X(this,"currentChordLyricsPair",new Je);X(this,"key",null);X(this,"transposeKey",null);X(this,"lineNumber",null);X(this,"textFont",new Rs);X(this,"chordFont",new Rs);this.type=t,this.items=e}isEmpty(){return this.items.length===0}isNotEmpty(){return!this.isEmpty()}addItem(t){t instanceof De?this.addTag(t):t instanceof Je?this.addChordLyricsPair(t):t instanceof An?this.addComment(t):this.items.push(t)}hasRenderableItems(){return this.items.some(t=>t.isRenderable())}clone(){return this.mapItems(null)}mapItems(t){const e=new Bs;return e.items=this.items.map(n=>{const s=n.clone();return t?t(s):s}).filter(n=>n!==null),e.type=this.type,e}isVerse(){return this.type===Pr}isChorus(){return this.type===ir}hasContent(){return this.hasRenderableItems()}addChordLyricsPair(t=null,e=null){return t instanceof Je?this.currentChordLyricsPair=t:this.currentChordLyricsPair=new Je(t||"",e||""),this.items.push(this.currentChordLyricsPair),this.currentChordLyricsPair}ensureChordLyricsPair(){this.currentChordLyricsPair||this.addChordLyricsPair()}chords(t){this.ensureChordLyricsPair(),this.currentChordLyricsPair.chords+=t}lyrics(t){this.ensureChordLyricsPair(),this.currentChordLyricsPair.lyrics+=t}addTag(t,e=null){const n=t instanceof De?t:new De(t,e);return this.items.push(n),n}addComment(t){const e=t instanceof An?t:new An(t);return this.items.push(e),e}set(t){return new Bs({type:this.type,items:this.items,...t})}}var Qi=Bs;class S1{constructor(){X(this,"lines",[])}addLine(t){this.lines.push(t)}get type(){const t=this.lines.map(n=>n.type),e=[...new Set(t)];return e.length===1?e[0]:ya}hasRenderableItems(){return this.lines.some(t=>t.hasRenderableItems())}}var Ji=S1;class A1{get key(){return this.getSingleMetadata(Qr)}get title(){return this.getSingleMetadata(xa)}get subtitle(){return this.getSingleMetadata(Ca)}get capo(){return this.getMetadata(qn)}get duration(){return this.getSingleMetadata(fc)}get tempo(){return this.getSingleMetadata(dc)}get time(){return this.getMetadata(pc)}get year(){return this.getSingleMetadata(gc)}get album(){return this.getMetadata(oc)}get copyright(){return this.getSingleMetadata(uc)}get lyricist(){return this.getMetadata(mc)}get artist(){return this.getMetadata(lc)}get composer(){return this.getMetadata(cc)}}var _c=A1;function T1(r,t){r.includes(t)||r.push(t)}class Ia extends _c{constructor(e={}){super();X(this,"metadata",{});e&&this.assign(e)}merge(e){const n=this.clone();return n.assign(e),n}contains(e){return e in this.metadata}add(e,n){if(Io(e))return;if(!(e in this.metadata)){this.metadata[e]=n;return}const s=this.metadata[e];if(s!==n){if(s instanceof Array){T1(s,n);return}this.metadata[e]=[s,n]}}set(e,n){n?this.metadata[e]=n:delete this.metadata[e]}getMetadata(e){return this.get(e)}getSingleMetadata(e){return this.getSingle(e)}get(e){return e===hc?this.calculateKeyFromCapo():e in this.metadata?this.metadata[e]:this.getArrayItem(e)}getSingle(e){const n=this.get(e);return Array.isArray(n)?n[0]:n}parseArrayKey(e){const n=e.match(/(.+)\.(-?\d+)$/);if(!n)return null;const s=n[1],i=parseInt(n[2],10);return[s,i]}getArrayItem(e){const n=this.parseArrayKey(e);if(n===null)return;const[s,i]=n,a=this.metadata[s]||[];let o=i;return o<0?o=a.length+o:o>0&&(o-=1),a[o]}clone(){return new Ia(this.metadata)}calculateKeyFromCapo(){const e=this.getSingle(qn),n=this.getSingle(Qr);if(e&&n){const s=Ws.parse(n);if(!s)throw new Error(`Could not parse ${n}`);return s.transpose(parseInt(e,10)).toString()}}assign(e){Object.keys(e).filter(n=>!Io(n)).forEach(n=>{const s=e[n];s instanceof Array?this.metadata[n]=[...s]:this.metadata[n]=s})}}var vc=Ia;class P1{constructor(t,e,n){X(this,"lineNumber",null);X(this,"column",null);this.message=t,this.lineNumber=e,this.column=n}toString(){return`Warning: ${this.message} on line ${this.lineNumber||"?"} column ${this.column||"?"}`}}var j1=P1;class _r{constructor(t,e){this.fontSize=t,this.unit=e}clone(){return new _r(this.fontSize,this.unit)}multiply(t){return new _r(this.fontSize*t/100,this.unit)}toString(){return`${this.fontSize}${this.unit}`}static parse(t,e){const n=t.trim(),s=parseFloat(n);return Number.isNaN(s)?this.parseNotANumber(e):n.slice(-1)==="%"?this.parsePercentage(s,e):new _r(s,"px")}static parseNotANumber(t){return t?t.clone():new _r(100,"%")}static parsePercentage(t,e){return e?e.multiply(t):new _r(t,"%")}}var I1=_r;class O1{constructor(){X(this,"fontAndColourStacks",{[Yi]:[],[Ms]:[],[Xi]:[],[Fs]:[]});X(this,"sizeStacks",{[Ns]:[],[Ks]:[]});X(this,"textFont",new Rs);X(this,"chordFont",new Rs)}applyTag(t){switch(t.name){case Fs:this.textFont.font=this.pushOrPopTag(t);break;case Ks:this.textFont.size=this.pushOrPopSizeTag(t);break;case Xi:this.textFont.colour=this.pushOrPopTag(t);break;case Ms:this.chordFont.font=this.pushOrPopTag(t);break;case Ns:this.chordFont.size=this.pushOrPopSizeTag(t);break;case Yi:this.chordFont.colour=this.pushOrPopTag(t);break}}pushOrPopTag(t){let{value:e}=t;return t.hasValue()?this.fontAndColourStacks[t.name].push(e):(this.fontAndColourStacks[t.name].pop(),e=this.fontAndColourStacks[t.name].slice(-1)[0]||null),e}pushOrPopSizeTag(t){const{value:e}=t;if(t.hasValue()){const n=this.sizeStacks[t.name].slice(-1)[0]||null,s=I1.parse(e,n);return this.sizeStacks[t.name].push(s),s}return this.sizeStacks[t.name].pop(),this.sizeStacks[t.name].slice(-1)[0]||null}}var L1=O1;class zs extends _c{constructor(e={}){super();X(this,"lines",[]);X(this,"currentLine",null);X(this,"warnings",[]);X(this,"sectionType",ar);X(this,"fontStack",new L1);X(this,"currentKey",null);X(this,"transposeKey",null);X(this,"_bodyParagraphs",null);X(this,"_bodyLines",null);this.metadata=new vc(e)}get previousLine(){const e=this.lines.length;return e>=2?this.lines[e-2]:null}get bodyLines(){return this._bodyLines||(this._bodyLines=this.selectRenderableItems(this.lines)),this._bodyLines}get bodyParagraphs(){return this._bodyParagraphs||(this._bodyParagraphs=this.selectRenderableItems(this.paragraphs)),this._bodyParagraphs}selectRenderableItems(e){const n=[...e];for(;n.length&&!n[0].hasRenderableItems();)n.shift();return n}chords(e){if(!this.currentLine)throw new Error("Expected this.currentLine to be present");this.currentLine.chords(e)}lyrics(e){if(this.ensureLine(),!this.currentLine)throw new Error("Expected this.currentLine to be present");this.currentLine.lyrics(e)}addLine(e){return e?this.currentLine=e:(this.currentLine=new Qi,this.lines.push(this.currentLine)),this.setCurrentProperties(this.sectionType),this.currentLine.transposeKey=this.transposeKey??this.currentKey,this.currentLine.key=this.currentKey||this.metadata.getSingle(Qr),this.currentLine.lineNumber=this.lines.length-1,this.currentLine}expandLine(e){const n=e.items.flatMap(s=>s instanceof De&&s.name===yc?this.getLastChorusBefore(e.lineNumber):[]);return[e,...n]}getLastChorusBefore(e){const n=[];if(!e)return n;for(let s=e-1;s>=0;s-=1){const i=this.lines[s];if(i.type===ir){const a=this.filterChorusStartEndDirectives(i);i.isNotEmpty()&&a.isEmpty()||n.unshift(i)}else if(n.length>0)break}return n}filterChorusStartEndDirectives(e){return e.mapItems(n=>n instanceof De&&(n.name===rn||n.name===Fn)?null:n)}get paragraphs(){return this.linesToParagraphs(this.lines)}get expandedBodyParagraphs(){return this.selectRenderableItems(this.linesToParagraphs(this.lines.flatMap(e=>this.expandLine(e))))}linesToParagraphs(e){let n=new Ji;const s=[n];return e.forEach(i=>{i.isEmpty()?(n=new Ji,s.push(n)):i.hasRenderableItems()&&n.addLine(i)}),s}setCurrentProperties(e){if(!this.currentLine)throw new Error("Expected this.currentLine to be present");this.currentLine.type=e,this.currentLine.textFont=this.fontStack.textFont.clone(),this.currentLine.chordFont=this.fontStack.chordFont.clone()}ensureLine(){this.currentLine===null&&this.addLine()}addTag(e){const n=De.parseOrFail(e);return this.applyTagOnSong(n),this.applyTagOnLine(n),n}applyTagOnLine(e){if(this.ensureLine(),!this.currentLine)throw new Error("Expected this.currentLine to be present");this.currentLine.addTag(e)}applyTagOnSong(e){e.isMetaTag()?this.setMetadata(e.name,e.value||""):e.name===Jh?this.transposeKey=e.value:e.name===bc?this.currentKey=e.value:e.isSectionDelimiter()?this.setSectionTypeFromTag(e):e.isInlineFontTag()&&this.fontStack.applyTag(e)}setSectionTypeFromTag(e){switch(e.name){case rn:this.startSection(ir,e);break;case Fn:this.endSection(ir,e);break;case Ys:this.startSection(Hi,e);break;case wa:this.endSection(Hi,e);break;case Xs:this.startSection(Pr,e);break;case Ea:this.endSection(Pr,e);break}}startSection(e,n){this.checkCurrentSectionType(ar,n),this.sectionType=e,this.setCurrentProperties(e)}endSection(e,n){this.checkCurrentSectionType(e,n),this.sectionType=ar}checkCurrentSectionType(e,n){this.sectionType!==e&&this.addWarning(`Unexpected tag {${n.originalName}, current section is: ${this.sectionType}`,n)}addWarning(e,{line:n,column:s}){const i=new j1(e,n||null,s||null);this.warnings.push(i)}addItem(e){if(e instanceof De)this.addTag(e);else{if(this.ensureLine(),!this.currentLine)throw new Error("Expected this.currentLine to be present");this.currentLine.addItem(e)}}clone(){return this.mapItems(e=>e)}setMetadata(e,n){this.metadata.add(e,n)}get metaData(){return sc('metaData has been deprecated, please use metadata instead (notice the lowercase "d")'),this.metadata}getMetadata(e){return this.metadata.getMetadata(e)}getSingleMetadata(e){return this.metadata.getSingleMetadata(e)}setKey(e){const n=e?e.toString():null;return this.changeMetadata(Qr,n)}setCapo(e){const n=e?e.toString():null;return this.changeMetadata(qn,n)}setDirective(e,n){return n===null?this.removeItem(s=>s instanceof De&&s.name===e):this.updateItem(s=>s instanceof De&&s.name===e,s=>"set"in s?s.set({value:n}):s,s=>s.insertDirective(e,n))}transpose(e,{normalizeChordSuffix:n=!1}={}){const s=wt.wrap(this.key);let i=null,a=this;return s&&(i=s.transpose(e),a=a.setKey(i.toString())),a.mapItems(o=>o instanceof Je?o.transpose(e,i,{normalizeChordSuffix:n}):o)}transposeUp({normalizeChordSuffix:e=!1}={}){return this.transpose(1,{normalizeChordSuffix:e})}transposeDown({normalizeChordSuffix:e=!1}={}){return this.transpose(-1,{normalizeChordSuffix:e})}changeKey(e){const n=this.getTransposeDistance(e),s=this.mapItems(i=>i instanceof De&&i.name===Qr?i.set({value:e.toString()}):i instanceof Je?i.transpose(n,e):i);return this.setKey(e.toString()),s}getTransposeDistance(e){const n=wt.wrap(this.key);if(!n)throw new Error(`
Cannot change song key, the original key is unknown.

Either ensure a key directive is present in the song (when using chordpro):
  \`{key: C}\`

Or set the song key before changing key:
  \`song.setKey('C');\``.substring(1));return n.distanceTo(e)}changeMetadata(e,n){const s=this.setDirective(e,n);return s.metadata.set(e,n),s}insertDirective(e,n,{after:s=null}={}){const i=this.lines.findIndex(f=>f.items.some(c=>!(c instanceof De)||s&&c instanceof De&&c.name===s)),a=new Qi;a.addTag(e,n);const o=this.clone(),{lines:l}=o;return o.lines=[...l.slice(0,i),a,...l.slice(i)],o}mapItems(e){const n=new zs;return this.lines.forEach(s=>{n.addLine(),s.items.forEach(i=>{const a=e(i);a&&n.addItem(a)})}),n}mapLines(e){const n=new zs;return this.lines.forEach(s=>{const i=e(s);i&&(n.addLine(),i.items.forEach(a=>n.addItem(a)))}),n}updateItem(e,n,s){let i=!1;const a=this.mapItems(o=>e(o)?(i=!0,n(o)):o);return i?a:s(a)}removeItem(e){return this.mapLines(n=>{const{items:s}=n,i=s.findIndex(e);return i===-1?n:s.length===1?null:n.set({items:[...s.slice(0,i),...s.slice(i+1)]})})}}var nn=zs;const Oo="chordSheet",Lo="chordLyricsPair",Do="tag",D1="comment",Mo="ternary",M1="line";class N1{constructor(){X(this,"song",new nn)}serialize(t){return{type:Oo,lines:t.lines.map(e=>this.serializeLine(e))}}serializeLine(t){return{type:M1,items:t.items.map(e=>this.serializeItem(e))}}serializeItem(t){if(t instanceof De)return this.serializeTag(t);if(t instanceof Je)return this.serializeChordLyricsPair(t);if(t instanceof Kn)return this.serializeTernary(t);if(t instanceof Rn)return this.serializeLiteral(t);throw new Error(`Don't know how to serialize ${t.constructor.name}`)}serializeTag(t){return{type:Do,name:t.originalName,value:t.value}}serializeChordLyricsPair(t){return{type:Lo,chords:t.chords,chord:null,lyrics:t.lyrics}}serializeTernary(t){return{type:Mo,variable:t.variable,valueTest:t.valueTest,trueExpression:this.serializeExpression(t.trueExpression),falseExpression:this.serializeExpression(t.falseExpression)}}serializeLiteral(t){return t.string}serializeExpression(t){return t.map(e=>this.serializeItem(e))}deserialize(t){return this.parseAstComponent(t),this.song}parseAstComponent(t){if(!t)return null;if(typeof t=="string")return new Rn(t);const{type:e}=t;switch(e){case Oo:this.parseChordSheet(t);break;case Lo:return this.parseChordLyricsPair(t);case Do:return this.parseTag(t);case D1:return this.parseComment(t);case Mo:return this.parseTernary(t);default:console.warn(`Unhandled AST component "${e}"`,t)}return null}parseChordSheet(t){const{lines:e}=t;this.song=new nn,e.forEach(n=>this.parseLine(n))}parseLine(t){const{items:e}=t;this.song.addLine(),e.forEach(n=>{const s=this.parseAstComponent(n);this.song.addItem(s)})}parseChordLyricsPair(t){const{chord:e,chords:n,lyrics:s}=t;return new Je(e?new Ws(e).toString():n,s)}parseTag(t){const{name:e,value:n,location:{offset:s=null,line:i=null,column:a=null}={}}=t;return new De(e,n,{line:i,column:a,offset:s})}parseComment(t){const{comment:e}=t;return new An(e)}parseTernary(t){const{variable:e,valueTest:n,trueExpression:s,falseExpression:i,location:{offset:a=null,line:o=null,column:l=null}={}}=t;return new Kn({variable:e,valueTest:n,trueExpression:this.parseExpression(s),falseExpression:this.parseExpression(i),offset:a,line:o,column:l})}parseExpression(t){return(t||[]).map(e=>this.parseAstComponent(e)).filter(e=>e!==null)}}var $c=N1;class F1{constructor(){X(this,"song",new nn)}get warnings(){return this.song.warnings}parseWithParser(t,e){const n=e(ic(t));return this.song=new $c().deserialize(n),this.song}}var wc=F1;function bi(r,t,e){return e=e||" ",r.length>t?r:(t-=r.length,e+=e.repeat(t),r+e.slice(0,t))}class Jr extends Error{static buildMessage(t,e){function n(f){return f.charCodeAt(0).toString(16).toUpperCase()}function s(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function i(f){return f.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function a(f){switch(f.type){case"literal":return'"'+s(f.text)+'"';case"class":const c=f.parts.map(h=>Array.isArray(h)?i(h[0])+"-"+i(h[1]):i(h));return"["+(f.inverted?"^":"")+c+"]";case"any":return"any character";case"end":return"end of input";case"other":return f.description}}function o(f){const c=f.map(a);let h,d;if(c.sort(),c.length>0){for(h=1,d=1;h<c.length;h++)c[h-1]!==c[h]&&(c[d]=c[h],d++);c.length=d}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}function l(f){return f?'"'+s(f)+'"':"end of input"}return"Expected "+o(t)+" but "+l(e)+" found."}constructor(t,e,n,s){super(),this.message=t,this.expected=e,this.found=n,this.location=s,this.name="PeggySyntaxError",typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(this,Jr.prototype):this.__proto__=Jr.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Jr)}format(t){let e="Error: "+this.message;if(this.location){let n=null,s;for(s=0;s<t.length;s++)if(t[s].grammarSource===this.location.source){n=t[s].text.split(/\r\n|\n|\r/g);break}let i=this.location.start,a=this.location.source+":"+i.line+":"+i.column;if(n){let o=this.location.end,l=bi("",i.line.toString().length," "),f=n[i.line-1],c=i.line===o.line?o.column:f.length+1;e+=`
 --> `+a+`
`+l+` |
`+i.line+" | "+f+`
`+l+" | "+bi("",i.column-1," ")+bi("",c-i.column,"^")}else e+=`
 at `+a}return e}}function K1(r,t){t=t!==void 0?t:{};const e={},n=t.grammarSource,s={ChordSheet:dn};let i=dn;const a=function(m,b){return{type:"chordSheet",lines:[...m,b]}},o=function(m){return m},l=function(m,b,E,T){return{type:"line",items:[m?{type:"chordLyricsPair",chords:"",lyrics:m}:null,...b,E?{type:"chordLyricsPair",chords:E,lyrics:""}:null,T?{type:"comment",comment:T}:null].filter(se=>se)}},f=function(m){return{type:"chordLyricsPair",chords:"",lyrics:m}},c="#",h=Ye("#",!1),d=/^[^\r\n]/,y=St(["\r",`
`],!0,!1),$=function(m){return m},v=function(m,b,E){return{type:"chordLyricsPair",chords:m||"",lyrics:b+(E||"")}},A=function(m){return m.map(b=>b.char||b).join("")},x="[",S=Ye("[",!1),D="]",P=Ye("]",!1),O=function(m){return m.map(b=>b.char||b).join("")},j=/^[^\]\r\n]/,L=St(["]","\r",`
`],!0,!1),N="\\",F=Ye("\\",!1),V=function(){return{type:"char",char:"\\"}},G=function(){return{type:"char",char:"]"}},Y=function(m){return m},pe="%{",ce=Ye("%{",!1),$e="}",Ee=Ye("}",!1),Ce=function(m,b,E){return{type:"ternary",variable:m.length>0?m:null,valueTest:b,...E,location:_e().start}},ie="=",Fe=Ye("=",!1),Ke=function(m){return m},Me="|",ot=Ye("|",!1),yt=function(m,b){return{type:"ternary",trueExpression:m,falseExpression:b,location:_e().start}},Lt=function(m){return m},ue=/^[a-zA-Z0-9\-_]/,Se=St([["a","z"],["A","Z"],["0","9"],"-","_"],!1,!1),We=function(){return{type:"char",char:"]"}},Dt=function(){return{type:"char",char:"|"}},bt=function(){return{type:"char",char:"}"}},Xt=/^[^|[\]\\{}%#\r\n\t ]/,Zt=St(["|","[","]","\\","{","}","%","#","\r",`
`,"	"," "],!0,!1),kt=function(){return{type:"char",char:"\\"}},tt=function(){return{type:"char",char:"["}},_t="{",Qt=Ye("{",!1),R=function(){return{type:"char",char:"{"}},lt="%",Mt=Ye("%",!1),rt=function(){return{type:"char",char:"%"}},ur=function(){return{type:"char",char:"#"}},Nt=function(m,b){return{type:"tag",name:m,value:b,location:_e().start}},Or=":",Ne=Ye(":",!1),fr=function(m){return m.map(b=>b.char||b).join("")},Lr=/^[a-zA-Z\-_]/,hr=St([["a","z"],["A","Z"],"-","_"],!1,!1),mr=/^[^}\\\r\n]/,xe=St(["}","\\","\r",`
`],!0,!1),ln=Wn("whitespace"),dr=/^[ \t\n\r]/,vt=St([" ","	",`
`,"\r"],!1,!1),Jt=Wn("space"),pr=/^[ \t]/,br=St([" ","	"],!1,!1),cn=`
`,un=Ye(`
`,!1),Dr="\r",fn=Ye("\r",!1);let _=0,he=0;const Ft=[{line:1,column:1}];let w=0,B=[],M=0,te;if(t.startRule!==void 0){if(!(t.startRule in s))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');i=s[t.startRule]}function _e(){return mn(he,_)}function Ye(m,b){return{type:"literal",text:m,ignoreCase:b}}function St(m,b,E){return{type:"class",parts:m,inverted:b,ignoreCase:E}}function Hn(){return{type:"end"}}function Wn(m){return{type:"other",description:m}}function hn(m){let b=Ft[m],E;if(b)return b;for(E=m-1;!Ft[E];)E--;for(b=Ft[E],b={line:b.line,column:b.column};E<m;)r.charCodeAt(E)===10?(b.line++,b.column=1):b.column++,E++;return Ft[m]=b,b}function mn(m,b){const E=hn(m),T=hn(b);return{source:n,start:{offset:m,line:E.line,column:E.column},end:{offset:b,line:T.line,column:T.column}}}function ae(m){_<w||(_>w&&(w=_,B=[]),B.push(m))}function Zs(m,b,E){return new Jr(Jr.buildMessage(m,b),m,b,E)}function dn(){let m,b,E;for(m=_,b=[],E=Yn();E!==e;)b.push(E),E=Yn();return b!==e?(E=pn(),E===e&&(E=null),E!==e?(he=m,b=a(b,E),m=b):(_=m,m=e)):(_=m,m=e),m}function Yn(){let m,b,E;return m=_,b=pn(),b!==e?(E=si(),E!==e?(he=m,b=o(b),m=b):(_=m,m=e)):(_=m,m=e),m}function pn(){let m,b,E,T,se,ye,Ge;if(m=_,b=_,E=Zn(),E===e&&(E=null),E!==e?b=r.substring(b,_):b=E,b!==e){for(E=[],T=Xn();T!==e;)E.push(T),T=Xn();if(E!==e)if(T=Jn(),T===e&&(T=null),T!==e)if(se=Qs(),se===e&&(se=null),se!==e){for(ye=[],Ge=Kt();Ge!==e;)ye.push(Ge),Ge=Kt();ye!==e?(he=m,b=l(b,E,T,se),m=b):(_=m,m=e)}else _=m,m=e;else _=m,m=e;else _=m,m=e}else _=m,m=e;return m}function Xn(){let m,b;return m=gn(),m===e&&(m=Js(),m===e&&(m=bn(),m===e&&(m=_,b=Zn(),b!==e&&(he=m,b=f(b)),m=b))),m}function Qs(){let m,b,E,T,se,ye;if(m=_,b=Kt(),b===e&&(b=null),b!==e)if(r.charCodeAt(_)===35?(E=c,_++):(E=e,M===0&&ae(h)),E!==e){for(T=_,se=[],d.test(r.charAt(_))?(ye=r.charAt(_),_++):(ye=e,M===0&&ae(y));ye!==e;)se.push(ye),d.test(r.charAt(_))?(ye=r.charAt(_),_++):(ye=e,M===0&&ae(y));se!==e?T=r.substring(T,_):T=se,T!==e?(he=m,b=$(T),m=b):(_=m,m=e)}else _=m,m=e;else _=m,m=e;return m}function Js(){let m,b,E,T,se,ye;if(m=_,b=Jn(),b!==e){for(E=_,T=[],se=ke();se!==e;)T.push(se),se=ke();if(T!==e?E=r.substring(E,_):E=T,E!==e){for(T=_,se=[],ye=Kt();ye!==e;)se.push(ye),ye=Kt();se!==e?T=r.substring(T,_):T=se,T!==e?(he=m,b=v(b,E,T),m=b):(_=m,m=e)}else _=m,m=e}else _=m,m=e;return m}function Zn(){let m,b,E;if(m=_,b=[],E=Qn(),E!==e)for(;E!==e;)b.push(E),E=Qn();else b=e;return b!==e&&(he=m,b=A(b)),m=b,m}function Qn(){let m;return m=ke(),m===e&&(m=Kt()),m}function Jn(){let m,b,E,T,se;if(m=_,b=_,M++,E=Fr(),M--,E===e?b=void 0:(_=b,b=e),b!==e)if(r.charCodeAt(_)===91?(E=x,_++):(E=e,M===0&&ae(S)),E!==e){for(T=[],se=es();se!==e;)T.push(se),se=es();T!==e?(r.charCodeAt(_)===93?(se=D,_++):(se=e,M===0&&ae(P)),se!==e?(he=m,b=O(T),m=b):(_=m,m=e)):(_=m,m=e)}else _=m,m=e;else _=m,m=e;return m}function es(){let m,b,E,T;return j.test(r.charAt(_))?(m=r.charAt(_),_++):(m=e,M===0&&ae(L)),m===e&&(m=_,b=Fr(),b!==e?(E=_,r.charCodeAt(_)===92?(T=N,_++):(T=e,M===0&&ae(F)),T!==e&&(he=E,T=V()),E=T,E===e&&(E=_,r.charCodeAt(_)===93?(T=D,_++):(T=e,M===0&&ae(P)),T!==e&&(he=E,T=G()),E=T),E!==e?(he=m,b=Y(E),m=b):(_=m,m=e)):(_=m,m=e)),m}function bn(){let m,b,E,T,se,ye,Ge,er,yn;return m=_,r.substr(_,2)===pe?(b=pe,_+=2):(b=e,M===0&&ae(ce)),b!==e?(E=Re(),E!==e?(T=_,se=ni(),se===e&&(se=null),se!==e?T=r.substring(T,_):T=se,T!==e?(se=ei(),se===e&&(se=null),se!==e?(ye=Re(),ye!==e?(Ge=ti(),Ge===e&&(Ge=null),Ge!==e?(er=Re(),er!==e?(r.charCodeAt(_)===125?(yn=$e,_++):(yn=e,M===0&&ae(Ee)),yn!==e?(he=m,b=Ce(T,se,Ge),m=b):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e),m}function ei(){let m,b,E,T;return m=_,r.charCodeAt(_)===61?(b=ie,_++):(b=e,M===0&&ae(Fe)),b!==e?(E=Re(),E!==e?(T=ts(),T!==e?(he=m,b=Ke(T),m=b):(_=m,m=e)):(_=m,m=e)):(_=m,m=e),m}function ts(){let m,b,E;if(m=_,b=[],E=$t(),E!==e)for(;E!==e;)b.push(E),E=$t();else b=e;return b!==e?m=r.substring(m,_):m=b,m}function ti(){let m,b,E,T,se,ye,Ge;return m=_,r.charCodeAt(_)===124?(b=Me,_++):(b=e,M===0&&ae(ot)),b!==e?(E=Re(),E!==e?(T=g(),T!==e?(se=Re(),se!==e?(ye=ri(),ye===e&&(ye=null),ye!==e?(Ge=Re(),Ge!==e?(he=m,b=yt(T,ye),m=b):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e),m}function ri(){let m,b,E,T;return m=_,r.charCodeAt(_)===124?(b=Me,_++):(b=e,M===0&&ae(ot)),b!==e?(E=Re(),E!==e?(T=g(),T!==e?(he=m,b=Lt(T),m=b):(_=m,m=e)):(_=m,m=e)):(_=m,m=e),m}function ni(){let m,b;if(m=[],ue.test(r.charAt(_))?(b=r.charAt(_),_++):(b=e,M===0&&ae(Se)),b!==e)for(;b!==e;)m.push(b),ue.test(r.charAt(_))?(b=r.charAt(_),_++):(b=e,M===0&&ae(Se));else m=e;return m}function g(){let m,b,E,T;if(m=[],b=_,E=[],T=$t(),T!==e)for(;T!==e;)E.push(T),T=$t();else E=e;if(E!==e?b=r.substring(b,_):b=E,b===e&&(b=bn()),b!==e)for(;b!==e;){if(m.push(b),b=_,E=[],T=$t(),T!==e)for(;T!==e;)E.push(T),T=$t();else E=e;E!==e?b=r.substring(b,_):b=E,b===e&&(b=bn())}else m=e;return m}function ke(){let m,b;return m=ct(),m===e&&(m=_,r.charCodeAt(_)===93?(b=D,_++):(b=e,M===0&&ae(P)),b!==e&&(he=m,b=We()),m=b,m===e&&(m=_,r.charCodeAt(_)===124?(b=Me,_++):(b=e,M===0&&ae(ot)),b!==e&&(he=m,b=Dt()),m=b,m===e&&(m=_,r.charCodeAt(_)===125?(b=$e,_++):(b=e,M===0&&ae(Ee)),b!==e&&(he=m,b=bt()),m=b))),m}function $t(){let m;return m=ct(),m===e&&(m=Kt()),m}function ct(){let m,b,E,T;return Xt.test(r.charAt(_))?(m=r.charAt(_),_++):(m=e,M===0&&ae(Zt)),m===e&&(m=_,b=Fr(),b!==e?(E=_,r.charCodeAt(_)===92?(T=N,_++):(T=e,M===0&&ae(F)),T!==e&&(he=E,T=kt()),E=T,E===e&&(E=_,r.charCodeAt(_)===124?(T=Me,_++):(T=e,M===0&&ae(ot)),T!==e&&(he=E,T=Dt()),E=T,E===e&&(E=_,r.charCodeAt(_)===91?(T=x,_++):(T=e,M===0&&ae(S)),T!==e&&(he=E,T=tt()),E=T,E===e&&(E=_,r.charCodeAt(_)===93?(T=D,_++):(T=e,M===0&&ae(P)),T!==e&&(he=E,T=We()),E=T,E===e&&(E=_,r.charCodeAt(_)===123?(T=_t,_++):(T=e,M===0&&ae(Qt)),T!==e&&(he=E,T=R()),E=T,E===e&&(E=_,r.charCodeAt(_)===125?(T=$e,_++):(T=e,M===0&&ae(Ee)),T!==e&&(he=E,T=bt()),E=T,E===e&&(E=_,r.charCodeAt(_)===37?(T=lt,_++):(T=e,M===0&&ae(Mt)),T!==e&&(he=E,T=rt()),E=T,E===e&&(E=_,r.charCodeAt(_)===35?(T=c,_++):(T=e,M===0&&ae(h)),T!==e&&(he=E,T=ur()),E=T))))))),E!==e?(he=m,b=Y(E),m=b):(_=m,m=e)):(_=m,m=e)),m}function gn(){let m,b,E,T,se,ye,Ge,er;return m=_,r.charCodeAt(_)===123?(b=_t,_++):(b=e,M===0&&ae(Qt)),b!==e?(E=Re(),E!==e?(T=_,se=Mr(),se!==e?T=r.substring(T,_):T=se,T!==e?(se=Re(),se!==e?(ye=re(),ye===e&&(ye=null),ye!==e?(Ge=Re(),Ge!==e?(r.charCodeAt(_)===125?(er=$e,_++):(er=e,M===0&&ae(Ee)),er!==e?(he=m,b=Nt(T,ye),m=b):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e)):(_=m,m=e),m}function re(){let m,b,E,T;return m=_,r.charCodeAt(_)===58?(b=Or,_++):(b=e,M===0&&ae(Ne)),b!==e?(E=Re(),E!==e?(T=rs(),T!==e?(he=m,b=fr(T),m=b):(_=m,m=e)):(_=m,m=e)):(_=m,m=e),m}function Mr(){let m,b;if(m=[],Lr.test(r.charAt(_))?(b=r.charAt(_),_++):(b=e,M===0&&ae(hr)),b!==e)for(;b!==e;)m.push(b),Lr.test(r.charAt(_))?(b=r.charAt(_),_++):(b=e,M===0&&ae(hr));else m=e;return m}function rs(){let m,b;for(m=[],b=be();b!==e;)m.push(b),b=be();return m}function be(){let m,b,E,T;return mr.test(r.charAt(_))?(m=r.charAt(_),_++):(m=e,M===0&&ae(xe)),m===e&&(m=_,b=Fr(),b!==e?(E=_,r.charCodeAt(_)===92?(T=N,_++):(T=e,M===0&&ae(F)),T!==e&&(he=E,T=kt()),E=T,E===e&&(E=_,r.charCodeAt(_)===125?(T=$e,_++):(T=e,M===0&&ae(Ee)),T!==e&&(he=E,T=bt()),E=T,E===e&&(E=_,r.charCodeAt(_)===123?(T=_t,_++):(T=e,M===0&&ae(Qt)),T!==e&&(he=E,T=R()),E=T)),E!==e?(he=m,b=Y(E),m=b):(_=m,m=e)):(_=m,m=e)),m}function Re(){let m,b;for(M++,m=[],dr.test(r.charAt(_))?(b=r.charAt(_),_++):(b=e,M===0&&ae(vt));b!==e;)m.push(b),dr.test(r.charAt(_))?(b=r.charAt(_),_++):(b=e,M===0&&ae(vt));return M--,m===e&&(b=e,M===0&&ae(ln)),m}function Kt(){let m,b;if(M++,m=[],pr.test(r.charAt(_))?(b=r.charAt(_),_++):(b=e,M===0&&ae(br)),b!==e)for(;b!==e;)m.push(b),pr.test(r.charAt(_))?(b=r.charAt(_),_++):(b=e,M===0&&ae(br));else m=e;return M--,m===e&&(b=e,M===0&&ae(Jt)),m}function si(){let m;return m=ne(),m===e&&(m=Nr(),m===e&&(m=ns())),m}function ns(){let m,b,E;return m=_,b=ne(),b!==e?(E=Nr(),E!==e?(b=[b,E],m=b):(_=m,m=e)):(_=m,m=e),m}function Nr(){let m;return r.charCodeAt(_)===10?(m=cn,_++):(m=e,M===0&&ae(un)),m}function ne(){let m;return r.charCodeAt(_)===13?(m=Dr,_++):(m=e,M===0&&ae(fn)),m}function Fr(){let m;return r.charCodeAt(_)===92?(m=N,_++):(m=e,M===0&&ae(F)),m}if(te=i(),te!==e&&_===r.length)return te;throw te!==e&&_<r.length&&ae(Hn()),Zs(B,w<r.length?r.charAt(w):null,w<r.length?mn(w,w+1):mn(w,w))}const R1=K1;class B1 extends wc{parse(t){return this.parseWithParser(t,R1)}}var z1=B1;const gi=/\s/,V1=/^\s*((([A-G])(#|b)?([^/\s]*)(\/([A-G])(#|b)?)?)(\s|$)+)+(\s|$)+/;class G1{constructor({preserveWhitespace:t=!0}={}){X(this,"processingText",!0);X(this,"preserveWhitespace",!0);X(this,"song",new nn);X(this,"songLine",null);X(this,"chordLyricsPair",null);X(this,"lines",[]);X(this,"currentLine",0);X(this,"lineCount",0);sc(`ChordSheetParser is deprecated, please use ChordsOverWordsParser. 

ChordsOverWordsParser aims to support any kind of chord, whereas ChordSheetParser lacks 
support for many variations. Besides that, some chordpro feature have been ported back 
to ChordsOverWordsParser, which adds some interesting functionality.`),this.preserveWhitespace=t}parse(t,{song:e}={}){for(this.initialize(t,e);this.hasNextLine();){const n=this.readLine();this.parseLine(n)}return this.endOfSong(),this.song}endOfSong(){}parseLine(t){this.songLine=this.song.addLine(),t.trim().length===0?this.chordLyricsPair=null:this.parseNonEmptyLine(t)}parseNonEmptyLine(t){if(!this.songLine)throw new Error("Expected this.songLine to be present");if(this.chordLyricsPair=this.songLine.addChordLyricsPair(),V1.test(t)&&this.hasNextLine()){const e=this.readLine();this.parseLyricsWithChords(t,e)}else this.chordLyricsPair.lyrics=`${t}`}initialize(t,e=null){e&&(this.song=e),this.lines=ic(t).split(`
`),this.currentLine=0,this.lineCount=this.lines.length,this.processingText=!0}readLine(){const t=this.lines[this.currentLine];return this.currentLine+=1,t}hasNextLine(){return this.currentLine<this.lineCount}parseLyricsWithChords(t,e){if(this.processCharacters(t,e),!this.chordLyricsPair)throw new Error("Expected this.chordLyricsPair to be present");this.chordLyricsPair.lyrics+=e.substring(t.length),this.chordLyricsPair.chords=this.chordLyricsPair.chords.trim(),this.chordLyricsPair.lyrics&&(this.chordLyricsPair.lyrics=this.chordLyricsPair.lyrics.trim()),e.trim().length||(this.songLine=this.song.addLine())}processCharacters(t,e){for(let n=0,s=t.length;n<s;n+=1){const i=t[n],a=t[n+1],o=gi.test(i);if(this.addCharacter(i,a),!this.chordLyricsPair)throw new Error("Expected this.chordLyricsPair to be present");this.chordLyricsPair.lyrics+=e[n]||"",this.processingText=!o}}addCharacter(t,e){const n=gi.test(t);if(n||this.ensureChordLyricsPairInitialized(),!n||this.shouldAddCharacterToChords(e)){if(!this.chordLyricsPair)throw new Error("Expected this.chordLyricsPair to be present");this.chordLyricsPair.chords+=t}}shouldAddCharacterToChords(t){return t&&gi.test(t)&&this.preserveWhitespace}ensureChordLyricsPairInitialized(){if(!this.processingText){if(!this.songLine)throw new Error("Expected this.songLine to be present");this.chordLyricsPair=this.songLine.addChordLyricsPair(),this.processingText=!0}}}var Ec=G1;function yi(r,t,e){return e=e||" ",r.length>t?r:(t-=r.length,e+=e.repeat(t),r+e.slice(0,t))}class en extends Error{static buildMessage(t,e){function n(f){return f.charCodeAt(0).toString(16).toUpperCase()}function s(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function i(f){return f.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function a(f){switch(f.type){case"literal":return'"'+s(f.text)+'"';case"class":const c=f.parts.map(h=>Array.isArray(h)?i(h[0])+"-"+i(h[1]):i(h));return"["+(f.inverted?"^":"")+c+"]";case"any":return"any character";case"end":return"end of input";case"other":return f.description}}function o(f){const c=f.map(a);let h,d;if(c.sort(),c.length>0){for(h=1,d=1;h<c.length;h++)c[h-1]!==c[h]&&(c[d]=c[h],d++);c.length=d}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}function l(f){return f?'"'+s(f)+'"':"end of input"}return"Expected "+o(t)+" but "+l(e)+" found."}constructor(t,e,n,s){super(),this.message=t,this.expected=e,this.found=n,this.location=s,this.name="PeggySyntaxError",typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(this,en.prototype):this.__proto__=en.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,en)}format(t){let e="Error: "+this.message;if(this.location){let n=null,s;for(s=0;s<t.length;s++)if(t[s].grammarSource===this.location.source){n=t[s].text.split(/\r\n|\n|\r/g);break}let i=this.location.start,a=this.location.source+":"+i.line+":"+i.column;if(n){let o=this.location.end,l=yi("",i.line.toString().length," "),f=n[i.line-1],c=i.line===o.line?o.column:f.length+1;e+=`
 --> `+a+`
`+l+` |
`+i.line+" | "+f+`
`+l+" | "+yi("",i.column-1," ")+yi("",c-i.column,"^")}else e+=`
 at `+a}return e}}function U1(r,t){t=t!==void 0?t:{};const e={},n=t.grammarSource,s={ChordSheet:m};let i=m;const a=function(u,p){return{type:"chordSheet",lines:[...u,...p]}},o=function(u,p,k){return[...(u==null?void 0:u.length)>0?[{type:"line",items:[]}]:[],...p,k]},l=function(u){return u},f=function(u){return u.type==="chordsLine"?{type:"line",items:u.items.map(p=>{const k={type:"chordLyricsPair"};return p.type==="chord"?{...k,chord:p}:{...k,chords:p.value}})}:u},c=function(u,p){const k=u.items,z=k.map((we,nt)=>{const At=k[nt+1],Yc=we.column-1,Ha=At?At.column-1:p.length,ss=p.substring(Yc,Ha),ai=/(\s+)(\S+)/.exec(ss),is=ai?ai.index+ai[1].length:null,Wa=we.type==="chord"?{chord:we}:{chords:we.value};return is&&is<Ha?[{type:"chordLyricsPair",...Wa,lyrics:ss.substring(0,is)},{type:"chordLyricsPair",chords:"",lyrics:ss.substring(is)}]:{type:"chordLyricsPair",...Wa,lyrics:ss}}).flat(),le=k[0];if(le&&le.column>1){const we=le.column;we>0&&z.unshift({type:"chordLyricsPair",chords:"",lyrics:p.substring(0,we-1)})}return{type:"line",items:z}},h=function(u){return{type:"chordsLine",items:u}},d=function(u){return u},y="/",$=be("/",!1),v="|",A=be("|",!1),x="-",S=be("-",!1),D=function(u){return{type:"symbol",value:u,column:rs().start.column}},P=function(u){return u.length===0?{type:"line",items:[]}:{type:"line",items:[{type:"chordLyricsPair",chords:"",lyrics:u}]}},O=function(u){return u},j=function(u){return{type:"line",items:[{type:"tag",name:"comment",value:u}]}},L="verse",N=be("verse",!0),F="chorus",V=be("chorus",!0),G="bridge",Y=be("bridge",!0),pe="tag",ce=be("tag",!0),$e="interlude",Ee=be("interlude",!0),Ce="instrumental",ie=be("instrumental",!0),Fe="intro",Ke=be("intro",!0),Me=/^[^\n\r]/,ot=Re([`
`,"\r"],!0,!1),yt=function(u,p){return[...u,p].filter(k=>k).map(([k,z])=>({type:"line",items:[{type:"tag",name:k,value:z}]}))},Lt=function(u,p){return{type:"line",items:[{type:"tag",name:u,value:p}]}},ue=function(u){return u},Se="{",We=be("{",!1),Dt="}",bt=be("}",!1),Xt=function(u){return u},Zt=function(u,p){return[u,p]},kt=":",tt=be(":",!1),_t=/^[a-zA-Z0-9\-_]/,Qt=Re([["a","z"],["A","Z"],["0","9"],"-","_"],!1,!1),R=/^[^\n\r}]/,lt=Re([`
`,"\r","}"],!0,!1),Mt="---",rt=be("---",!1),ur=si("whitespace"),Nt=/^[ \t]/,Or=Re([" ","	"],!1,!1),Ne=`
`,fr=be(`
`,!1),Lr="\r",hr=be("\r",!1),mr=function(u){return{type:"chord",...u,column:rs().start.column}},xe="#",ln=be("#",!1),dr="b",vt=be("b",!1),Jt=/^[a-zA-Z0-9()#+]/,pr=Re([["a","z"],["A","Z"],["0","9"],"(",")","#","+"],!1,!1),br=function(u,p,k,z){return{base:u,modifier:p,suffix:k,...z,chordType:"symbol"}},cn=/^[A-Ga-g]/,un=Re([["A","G"],["a","g"]],!1,!1),Dr=function(u,p){return{bassBase:u,bassModifier:p}},fn=function(u,p,k,z){return{base:p,modifier:u,suffix:k,...z,chordType:"numeral"}},_="III",he=be("III",!1),Ft="iii",w=be("iii",!1),B="VII",M=be("VII",!1),te="vii",_e=be("vii",!1),Ye="II",St=be("II",!1),Hn="ii",Wn=be("ii",!1),hn="IV",mn=be("IV",!1),ae="iv",Zs=be("iv",!1),dn="VI",Yn=be("VI",!1),pn="vi",Xn=be("vi",!1),Qs="I",Js=be("I",!1),Zn="i",Qn=be("i",!1),Jn="V",es=be("V",!1),bn="v",ei=be("v",!1),ts=function(u,p){return{bassBase:p,bassModifier:u}},ti=function(u,p,k,z){return{base:p,modifier:u,suffix:k,...z,chordType:"numeric"}},ri=/^[1-7]/,ni=Re([["1","7"]],!1,!1);let g=0,ke=0;const $t=[{line:1,column:1}];let ct=0,gn=[],re=0,Mr;if(t.startRule!==void 0){if(!(t.startRule in s))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');i=s[t.startRule]}function rs(){return Nr(ke,g)}function be(u,p){return{type:"literal",text:u,ignoreCase:p}}function Re(u,p,k){return{type:"class",parts:u,inverted:p,ignoreCase:k}}function Kt(){return{type:"end"}}function si(u){return{type:"other",description:u}}function ns(u){let p=$t[u],k;if(p)return p;for(k=u-1;!$t[k];)k--;for(p=$t[k],p={line:p.line,column:p.column};k<u;)r.charCodeAt(k)===10?(p.line++,p.column=1):p.column++,k++;return $t[u]=p,p}function Nr(u,p){const k=ns(u),z=ns(p);return{source:n,start:{offset:u,line:k.line,column:k.column},end:{offset:p,line:z.line,column:z.column}}}function ne(u){g<ct||(g>ct&&(ct=g,gn=[]),gn.push(u))}function Fr(u,p,k){return new en(en.buildMessage(u,p),u,p,k)}function m(){let u,p,k;return u=g,p=Nc(),p===e&&(p=null),p!==e?(k=b(),k===e&&(k=null),k!==e?(ke=u,p=a(p,k),u=p):(g=u,u=e)):(g=u,u=e),u}function b(){let u,p,k,z;if(u=g,p=_n(),p===e&&(p=null),p!==e){for(k=[],z=E();z!==e;)k.push(z),z=E();k!==e?(z=T(),z===e&&(z=null),z!==e?(ke=u,p=o(p,k,z),u=p):(g=u,u=e)):(g=u,u=e)}else g=u,u=e;return u}function E(){let u,p,k;return u=g,p=T(),p!==e?(k=_n(),k!==e?(ke=u,p=l(p),u=p):(g=u,u=e)):(g=u,u=e),u}function T(){let u,p;return u=g,p=Dc(),p===e&&(p=Fc(),p===e&&(p=se(),p===e&&(p=ye(),p===e&&(p=yn())))),p!==e&&(ke=u,p=f(p)),u=p,u}function se(){let u,p,k,z;return u=g,p=ye(),p!==e?(k=_n(),k!==e?(z=Lc(),z!==e?(ke=u,p=c(p,z),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function ye(){let u,p,k;if(u=g,p=[],k=Ge(),k===e&&(k=Da()),k!==e)for(;k!==e;)p.push(k),k=Ge(),k===e&&(k=Da());else p=e;return p!==e&&(ke=u,p=h(p)),u=p,u}function Ge(){let u,p,k,z;return u=g,p=ut(),p!==e?(k=er(),k!==e?(z=ut(),z!==e?(ke=u,p=d(k),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function er(){let u,p;return u=g,r.charCodeAt(g)===47?(p=y,g++):(p=e,re===0&&ne($)),p===e&&(r.charCodeAt(g)===124?(p=v,g++):(p=e,re===0&&ne(A)),p===e&&(r.charCodeAt(g)===45?(p=x,g++):(p=e,re===0&&ne(S)))),p!==e&&(ke=u,p=D(p)),u=p,u}function yn(){let u,p;return u=g,p=Oc(),p!==e&&(ke=u,p=P(p)),u=p,u}function Oc(){let u,p,k;for(u=g,p=[],k=Kr();k!==e;)p.push(k),k=Kr();return p!==e?u=r.substring(u,g):u=p,u}function Lc(){let u,p,k;if(u=g,p=[],k=Kr(),k!==e)for(;k!==e;)p.push(k),k=Kr();else p=e;return p!==e?u=r.substring(u,g):u=p,u}function Da(){let u,p,k,z;return u=g,p=ut(),p!==e?(k=zc(),k!==e?(z=ut(),z!==e?(ke=u,p=O(k),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function Dc(){let u,p,k,z,le,we,nt,At;if(u=g,p=g,k=g,z=ut(),z!==e)if(le=Mc(),le!==e)if(we=ut(),we!==e){for(nt=[],At=Kr();At!==e;)nt.push(At),At=Kr();nt!==e?(At=ut(),At!==e?(z=[z,le,we,nt,At],k=z):(g=k,k=e)):(g=k,k=e)}else g=k,k=e;else g=k,k=e;else g=k,k=e;return k!==e?p=r.substring(p,g):p=k,p!==e&&(ke=u,p=j(p)),u=p,u}function Mc(){let u;return r.substr(g,5).toLowerCase()===L?(u=r.substr(g,5),g+=5):(u=e,re===0&&ne(N)),u===e&&(r.substr(g,6).toLowerCase()===F?(u=r.substr(g,6),g+=6):(u=e,re===0&&ne(V)),u===e&&(r.substr(g,6).toLowerCase()===G?(u=r.substr(g,6),g+=6):(u=e,re===0&&ne(Y)),u===e&&(r.substr(g,3).toLowerCase()===pe?(u=r.substr(g,3),g+=3):(u=e,re===0&&ne(ce)),u===e&&(r.substr(g,9).toLowerCase()===$e?(u=r.substr(g,9),g+=9):(u=e,re===0&&ne(Ee)),u===e&&(r.substr(g,12).toLowerCase()===Ce?(u=r.substr(g,12),g+=12):(u=e,re===0&&ne(ie)),u===e&&(r.substr(g,5).toLowerCase()===Fe?(u=r.substr(g,5),g+=5):(u=e,re===0&&ne(Ke)))))))),u}function Kr(){let u;return Me.test(r.charAt(g))?(u=r.charAt(g),g++):(u=e,re===0&&ne(ot)),u}function Nc(){let u,p,k,z;for(u=g,p=[],k=Ma();k!==e;)p.push(k),k=Ma();return p!==e?(k=Na(),k===e&&(k=null),k!==e?(z=Rc(),z===e&&(z=null),z!==e?(ke=u,p=yt(p,k),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function Fc(){let u,p,k,z,le,we,nt;return u=g,p=g,k=Ra(),k!==e?p=r.substring(p,g):p=k,p!==e?(k=ut(),k!==e?(z=Ka(),z!==e?(le=ut(),le!==e?(we=g,nt=Ba(),nt!==e?we=r.substring(we,g):we=nt,we!==e?(ke=u,p=Lt(p,we),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function Ma(){let u,p,k;return u=g,p=Na(),p!==e?(k=_n(),k!==e?(ke=u,p=ue(p),u=p):(g=u,u=e)):(g=u,u=e),u}function Na(){let u;return u=Kc(),u===e&&(u=Fa()),u}function Kc(){let u,p,k,z,le,we;return u=g,r.charCodeAt(g)===123?(p=Se,g++):(p=e,re===0&&ne(We)),p!==e?(k=ut(),k!==e?(z=Fa(),z!==e?(le=ut(),le!==e?(r.charCodeAt(g)===125?(we=Dt,g++):(we=e,re===0&&ne(bt)),we!==e?(ke=u,p=Xt(z),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function Fa(){let u,p,k,z,le,we,nt;return u=g,p=g,k=Ra(),k!==e?p=r.substring(p,g):p=k,p!==e?(k=ut(),k!==e?(z=Ka(),z!==e?(le=ut(),le!==e?(we=g,nt=Ba(),nt!==e?we=r.substring(we,g):we=nt,we!==e?(ke=u,p=Zt(p,we),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function Ka(){let u;return r.charCodeAt(g)===58?(u=kt,g++):(u=e,re===0&&ne(tt)),u}function Ra(){let u,p;if(u=[],_t.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(Qt)),p!==e)for(;p!==e;)u.push(p),_t.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(Qt));else u=e;return u}function Ba(){let u,p;if(u=[],R.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(lt)),p!==e)for(;p!==e;)u.push(p),R.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(lt));else u=e;return u}function Rc(){let u,p,k;return u=g,r.substr(g,3)===Mt?(p=Mt,g+=3):(p=e,re===0&&ne(rt)),p!==e?(k=_n(),k!==e?(p=[p,k],u=p):(g=u,u=e)):(g=u,u=e),u}function ut(){let u,p;for(re++,u=[],Nt.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(Or));p!==e;)u.push(p),Nt.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(Or));return re--,u===e&&(p=e,re===0&&ne(ur)),u}function _n(){let u;return u=Va(),u===e&&(u=za(),u===e&&(u=Bc())),u}function Bc(){let u,p,k;return u=g,p=Va(),p!==e?(k=za(),k!==e?(p=[p,k],u=p):(g=u,u=e)):(g=u,u=e),u}function za(){let u;return r.charCodeAt(g)===10?(u=Ne,g++):(u=e,re===0&&ne(fr)),u}function Va(){let u;return r.charCodeAt(g)===13?(u=Lr,g++):(u=e,re===0&&ne(hr)),u}function zc(){let u,p;return u=g,p=Uc(),p===e&&(p=Hc(),p===e&&(p=Vc())),p!==e&&(ke=u,p=mr(p)),u=p,u}function Rr(){let u;return r.charCodeAt(g)===35?(u=xe,g++):(u=e,re===0&&ne(ln)),u===e&&(r.charCodeAt(g)===98?(u=dr,g++):(u=e,re===0&&ne(vt))),u}function ii(){let u,p;for(u=[],Jt.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(pr));p!==e;)u.push(p),Jt.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(pr));return u}function Vc(){let u,p,k,z,le;return u=g,p=Ga(),p!==e?(k=Rr(),k===e&&(k=null),k!==e?(z=g,le=ii(),le!==e?z=r.substring(z,g):z=le,z!==e?(le=Gc(),le===e&&(le=null),le!==e?(ke=u,p=br(p,k,z,le),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function Ga(){let u;return cn.test(r.charAt(g))?(u=r.charAt(g),g++):(u=e,re===0&&ne(un)),u}function Gc(){let u,p,k,z;return u=g,r.charCodeAt(g)===47?(p=y,g++):(p=e,re===0&&ne($)),p!==e?(k=Ga(),k!==e?(z=Rr(),z===e&&(z=null),z!==e?(ke=u,p=Dr(k,z),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function Uc(){let u,p,k,z,le;return u=g,p=Rr(),p===e&&(p=null),p!==e?(k=Ua(),k!==e?(z=g,le=ii(),le!==e?z=r.substring(z,g):z=le,z!==e?(le=qc(),le===e&&(le=null),le!==e?(ke=u,p=fn(p,k,z,le),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function Ua(){let u;return r.substr(g,3)===_?(u=_,g+=3):(u=e,re===0&&ne(he)),u===e&&(r.substr(g,3)===Ft?(u=Ft,g+=3):(u=e,re===0&&ne(w)),u===e&&(r.substr(g,3)===B?(u=B,g+=3):(u=e,re===0&&ne(M)),u===e&&(r.substr(g,3)===te?(u=te,g+=3):(u=e,re===0&&ne(_e)),u===e&&(r.substr(g,2)===Ye?(u=Ye,g+=2):(u=e,re===0&&ne(St)),u===e&&(r.substr(g,2)===Hn?(u=Hn,g+=2):(u=e,re===0&&ne(Wn)),u===e&&(r.substr(g,2)===hn?(u=hn,g+=2):(u=e,re===0&&ne(mn)),u===e&&(r.substr(g,2)===ae?(u=ae,g+=2):(u=e,re===0&&ne(Zs)),u===e&&(r.substr(g,2)===dn?(u=dn,g+=2):(u=e,re===0&&ne(Yn)),u===e&&(r.substr(g,2)===pn?(u=pn,g+=2):(u=e,re===0&&ne(Xn)),u===e&&(r.charCodeAt(g)===73?(u=Qs,g++):(u=e,re===0&&ne(Js)),u===e&&(r.charCodeAt(g)===105?(u=Zn,g++):(u=e,re===0&&ne(Qn)),u===e&&(r.charCodeAt(g)===86?(u=Jn,g++):(u=e,re===0&&ne(es)),u===e&&(r.charCodeAt(g)===118?(u=bn,g++):(u=e,re===0&&ne(ei))))))))))))))),u}function qc(){let u,p,k,z;return u=g,r.charCodeAt(g)===47?(p=y,g++):(p=e,re===0&&ne($)),p!==e?(k=Rr(),k===e&&(k=null),k!==e?(z=Ua(),z!==e?(ke=u,p=ts(k,z),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function Hc(){let u,p,k,z,le;return u=g,p=Rr(),p===e&&(p=null),p!==e?(k=qa(),k!==e?(z=g,le=ii(),le!==e?z=r.substring(z,g):z=le,z!==e?(le=Wc(),le===e&&(le=null),le!==e?(ke=u,p=ti(p,k,z,le),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}function qa(){let u;return ri.test(r.charAt(g))?(u=r.charAt(g),g++):(u=e,re===0&&ne(ni)),u}function Wc(){let u,p,k,z;return u=g,r.charCodeAt(g)===47?(p=y,g++):(p=e,re===0&&ne($)),p!==e?(k=Rr(),k===e&&(k=null),k!==e?(z=qa(),z!==e?(ke=u,p=ts(k,z),u=p):(g=u,u=e)):(g=u,u=e)):(g=u,u=e),u}if(Mr=i(),Mr!==e&&g===r.length)return Mr;throw Mr!==e&&g<r.length&&ne(Kt()),Fr(gn,ct<r.length?r.charAt(ct):null,ct<r.length?Nr(ct,ct+1):Nr(ct,ct))}const q1=U1;class H1 extends wc{parse(t){return this.parseWithParser(t,q1)}}var W1=H1;class Y1 extends va{format(t){const{bodyParagraphs:e,expandedBodyParagraphs:n}=t;return this.template({song:t,configuration:this.configuration,bodyParagraphs:this.configuration.expandChorusDirective?n:e})}static cssString(t=""){So("The class method cssString() was removed in favor of the instance PROPERTY. Please use `new <Formatter>().cssString` instead.")}cssString(t=""){return Fh(this.defaultCss,t)}static cssObject(){So("The class method cssObject() was removed in favor of the instance PROPERTY. Please use `new <Formatter>().cssObject` instead.")}get cssObject(){return this.defaultCss}}var Cc=Y1;function X1(r,t){return/^\d+$/.test(r)?parseInt(r,10):wt.distance(t,r)}function Z1(r,t,e,n){let s=-1*(r||0);return e&&(t&&(s+=X1(t,e)),n&&(s+=wt.distance(e,n))),s}function Oa(r,t,e,{renderKey:n=null,useUnicodeModifier:s=!1,normalizeChords:i=!0}={}){var y;const a=Ws.parse(r),o=e.key,l=parseInt(e.metadata.getSingle(qn),10);if(!a)return r;const f=Z1(l,t.transposeKey,o,n),c=n||((y=wt.wrap(t.key||e.key))==null?void 0:y.transpose(f))||null,h=a.transpose(f);return(i?h.normalize(c):h).toString({useUnicodeModifier:s})}const ea=r=>r instanceof Je,La=r=>r.items.some(t=>t.isRenderable()),xc=r=>r instanceof De,kc=r=>r.name==="comment";function Sc(r){return r.trim().replace(/(<\/[a-z]+>)\s+(<)/g,"$1$2").replace(/(\n)\s+/g,"")}function wr(r,t){return r.map(t).join("")}function Be(r,t){return r?t():""}const Ac=r=>r.items.some(t=>t instanceof Je&&!Hs(t.lyrics)||t instanceof De&&t.isRenderable()||_a(t)),Tc=r=>{const t=["row"];return La(r)||t.push("empty-line"),t.join(" ")},Pc=r=>{const t=["paragraph"];return r.type!==ya&&r.type!==ar&&t.push(r.type),t.join(" ")},jc=(r,t,e)=>{if(!t)throw new Error("cannot evaluate, metadata is null");return r.evaluate(t,e.get("metadata.separator"))};function sr(r){const t=r.toCssString();return t?` style="${t}"`:""}var Q1=({configuration:r,configuration:{key:t},song:e,renderBlankLines:n=!1,song:{title:s,subtitle:i,metadata:a},bodyParagraphs:o})=>Sc(`
  ${Be(s,()=>`<h1>${s}</h1>`)}
  ${Be(i,()=>`<h2>${i}</h2>`)}
  
  <div class="chord-sheet">
    ${wr(o,l=>`
      <div class="${Pc(l)}">
        ${wr(l.lines,f=>`
          ${Be(n||La(f),()=>`
            <div class="${Tc(f)}">
              ${wr(f.items,c=>`
                ${Be(ea(c),()=>`
                  <div class="column">
                    <div class="chord"${sr(f.chordFont)}>${Oa(c.chords,f,e,{renderKey:t,useUnicodeModifier:r.useUnicodeModifiers,normalizeChords:r.normalizeChords})}</div>
                    <div class="lyrics"${sr(f.textFont)}>${c.lyrics}</div>
                  </div>
                `)}
                
                ${Be(xc(c),()=>`
                  ${Be(kc(c),()=>`
                    <div class="comment">${c.value}</div>
                  `)}
                  
                  ${Be(c.hasRenderableLabel(),()=>`
                    <h3 class="label">${c.value}</h3>
                  `)}
                `)}
                
                ${Be(_a(c),()=>`
                  <div class="column">
                    <div class="chord"></div>
                    <div class="lyrics"${sr(f.textFont)}>${jc(c,a,r)}</div>
                  </div>
                `)}
              `)}
            </div>
          `)}
        `)}
      </div>
    `)}
  </div>
`);const J1={".chord:not(:last-child)":{paddingRight:"10px"},".paragraph":{marginBottom:"1em"},".row":{display:"flex"},".chord:after":{content:"'\\200b'"},".lyrics:after":{content:"'\\200b'"}};class em extends Cc{get template(){return Q1}get defaultCss(){return J1}}var tm=em,rm=({configuration:r,configuration:{key:t},song:e,renderBlankLines:n=!1,song:{title:s,subtitle:i,bodyLines:a,metadata:o},bodyParagraphs:l})=>Sc(`
  ${Be(s,()=>`<h1>${s}</h1>`)}
  ${Be(i,()=>`<h2>${i}</h2>`)}

  ${Be(a.length>0,()=>`
    <div class="chord-sheet">
      ${wr(l,f=>`
        <div class="${Pc(f)}">
          ${wr(f.lines,c=>`
            ${Be(n||La(c),()=>`
              <table class="${Tc(c)}">
                ${Be(nc(c),()=>`
                  <tr>
                    ${wr(c.items,h=>`
                      ${Be(ea(h),()=>`
                        <td class="chord"${sr(c.chordFont)}>${Oa(h.chords,c,e,{renderKey:t,useUnicodeModifier:r.useUnicodeModifiers,normalizeChords:r.normalizeChords})}</td>
                      `)}
                    `)}
                  </tr>
                `)}
                
                ${Be(Ac(c),()=>`
                  <tr>
                    ${wr(c.items,h=>`
                      ${Be(ea(h),()=>`
                        <td class="lyrics"${sr(c.textFont)}>${h.lyrics}</td>
                      `)}
                      
                      ${Be(xc(h),()=>`
                        ${Be(kc(h),()=>`
                          <td class="comment"${sr(c.textFont)}>${h.value}</td>
                        `)}
                        
                        ${Be(h.hasRenderableLabel(),()=>`
                          <td><h3 class="label"${sr(c.textFont)}>${h.value}</h3></td>
                        `)}
                      `)}
                      
                      ${Be(_a(h),()=>`
                        <td class="lyrics"${sr(c.textFont)}>${jc(h,o,r)}</td>
                      `)}
                    `)}
                  </tr>
                `)}
              </table>
            `)}
          `)}
        </div>
      `)}
    </div>
  `)}
`);const nm={h1:{fontSize:"1.5em"},h2:{fontSize:"1.1em"},table:{borderSpacing:"0",color:"inherit"},td:{padding:"3px 0"},".chord:not(:last-child)":{paddingRight:"10px"},".paragraph":{marginBottom:"1em"}};class sm extends Cc{get template(){return rm}get defaultCss(){return nm}}var im=sm;class am extends va{constructor(){super(...arguments);X(this,"song",new nn)}format(e){return this.song=e,[this.formatHeader(),this.formatParagraphs()].join("")}formatHeader(){const{title:e,subtitle:n}=this.song,s=e||n?`
`:"";return[this.formatTitle(e),this.formatSubTitle(n),s].join("")}formatParagraphs(){const{bodyParagraphs:e,expandedBodyParagraphs:n,metadata:s}=this.song,{expandChorusDirective:i}=this.configuration;return(i?n:e).map(a=>this.formatParagraph(a,s)).join(`

`)}formatParagraph(e,n){return e.lines.filter(s=>s.hasRenderableItems()).map(s=>this.formatLine(s,n)).join(`
`)}formatLine(e,n){return[this.formatLineTop(e,n),this.formatLineBottom(e,n)].filter(i=>!Hs(i)).map(i=>(i||"").trimRight()).join(`
`)}formatTitle(e){return e?`${e.toUpperCase()}
`:""}formatSubTitle(e){return e?`${e}
`:""}formatLineTop(e,n){return nc(e)?this.formatLineWithFormatter(e,this.formatItemTop,n):null}chordLyricsPairLength(e,n){const s=this.renderChords(e,n),{lyrics:i}=e,a=(s||"").length,o=(i||"").length;return a>=o?a+1:Math.max(a,o)}renderChords(e,n){return Oa(e.chords,n,this.song,{renderKey:this.configuration.key,useUnicodeModifier:this.configuration.useUnicodeModifiers,normalizeChords:this.configuration.normalizeChords})}formatItemTop(e,n,s){if(e instanceof De&&e.isRenderable())return e.value||"";if(e instanceof Je){const i=this.renderChords(e,s);return ko(i,this.chordLyricsPairLength(e,s))}return""}formatLineBottom(e,n){return Ac(e)?this.formatLineWithFormatter(e,this.formatItemBottom,n):""}formatLineWithFormatter(e,n,s){return e.items.map(i=>n.call(this,i,s,e)).join("")}formatItemBottom(e,n,s){return e instanceof De&&e.isRenderable()?e.value||"":e instanceof Je?ko(e.lyrics||"",this.chordLyricsPairLength(e,s)):"evaluate"in e?e.evaluate(n,this.configuration.get("metadata.separator")):""}}var om=am;const lm=/^\[Verse.*]/,cm=/^\[Chorus]/,No=/^\[([^\]]+)]/,Fo={[Pr]:Xs,[ir]:rn},_i={[Pr]:Ea,[ir]:Fn};class um extends Ec{constructor(){super(...arguments);X(this,"currentSectionType",null)}parseLine(e){this.isSectionEnd()&&this.endSection(),lm.test(e)?(this.startNewLine(),this.startSection(Pr)):cm.test(e)?(this.startNewLine(),this.startSection(ir)):No.test(e)?this.parseMetadataLine(e):super.parseLine(e)}parseMetadataLine(e){this.startNewLine(),this.endSection();const n=e.match(No)[1];if(!this.songLine)throw new Error("Expected this.songLine to be present");this.songLine.addTag(new De($a,n))}isSectionEnd(){return this.songLine!==null&&this.songLine.isEmpty()&&this.song.previousLine!==null&&!this.song.previousLine.isEmpty()}endOfSong(){super.endOfSong(),this.currentSectionType!==null&&this.currentSectionType in _i&&this.startNewLine(),this.endSection({addNewLine:!1})}startSection(e){this.currentSectionType&&this.endSection(),this.currentSectionType=e,this.song.setCurrentProperties(e),e in Fo&&this.song.addTag(new De(Fo[e]))}endSection({addNewLine:e=!0}={}){this.currentSectionType!==null&&this.currentSectionType in _i&&(this.song.addTag(new De(_i[this.currentSectionType])),e&&this.startNewLine()),this.song.setCurrentProperties(ar),this.currentSectionType=null}startNewLine(){this.songLine=this.song.addLine()}}var fm=um,hm={ChordLyricsPair:Je,ChordProFormatter:k1,ChordProParser:z1,ChordSheetParser:Ec,ChordSheetSerializer:$c,ChordsOverWordsParser:W1,Comment:An,Composite:Zi,HtmlDivFormatter:tm,HtmlTableFormatter:im,Line:Qi,Literal:Rn,Metadata:vc,Paragraph:Ji,Song:nn,Tag:De,Ternary:Kn,TextFormatter:om,UltimateGuitarParser:fm,CHORUS:ir,INDETERMINATE:ya,NONE:ar,TAB:Hi,VERSE:Pr};function mm(r){let t,e,n,s="×",i,a,o,l,f,c;const h=r[4].default,d=su(h,r,r[3],null);return{c(){t=Z("div"),e=Z("div"),n=Z("button"),n.textContent=s,i=Te(),d&&d.c(),this.h()},l(y){t=Q(y,"DIV",{class:!0,style:!0});var $=U(t);e=Q($,"DIV",{class:!0,style:!0});var v=U(e);n=Q(v,"BUTTON",{class:!0,["data-svelte-h"]:!0}),jt(n)!=="svelte-qc1bif"&&(n.textContent=s),i=Pe(v),d&&d.l(v),v.forEach(I),$.forEach(I),this.h()},h(){C(n,"class","bg-letkwet-500 rounded-full text-white absolute -top-2 -right-2 w-10 h-10 text-xl font-bold"),C(e,"class","container svelte-1pawiih"),C(e,"style",a=`width: ${r[1]};`),C(t,"class","backdrop svelte-1pawiih"),C(t,"style",o=r[0]?"display: flex;":"")},m(y,$){W(y,t,$),K(t,e),K(e,n),K(e,i),d&&d.m(e,null),l=!0,f||(c=[Ue(window,"keydown",r[6]),Ue(n,"click",r[7]),Ue(e,"click",iu(r[5])),Ue(t,"click",r[8])],f=!0)},p(y,[$]){d&&d.p&&(!l||$&8)&&au(d,h,y,y[3],l?lu(h,y[3],$,null):ou(y[3]),null),(!l||$&2&&a!==(a=`width: ${y[1]};`))&&C(e,"style",a),(!l||$&1&&o!==(o=y[0]?"display: flex;":""))&&C(t,"style",o)},i(y){l||(fe(d,y),l=!0)},o(y){ge(d,y),l=!1},d(y){y&&I(t),d&&d.d(y),f=!1,zn(c)}}}function dm(r,t,e){let{$$slots:n={},$$scope:s}=t,{open:i=!1,width:a="auto"}=t;const o=Bn();function l(d){$i.call(this,r,d)}const f=d=>{d.key==="Escape"&&o("close")},c=()=>o("close"),h=()=>o("close");return r.$$set=d=>{"open"in d&&e(0,i=d.open),"width"in d&&e(1,a=d.width),"$$scope"in d&&e(3,s=d.$$scope)},[i,a,o,s,n,l,f,c,h]}class pm extends dt{constructor(t){super(),pt(this,t,dm,mm,mt,{open:0,width:1})}}function Ko(r,t,e){const n=r.slice();return n[7]=t[e],n[9]=e,n}function bm(r){let t,e,n;return{c(){t=Oe("text"),e=me(r[2]),n=me("fr"),this.h()},l(s){t=Le(s,"text",{class:!0,fill:!0,x:!0,y:!0});var i=U(t);e=de(i,r[2]),n=de(i,"fr"),i.forEach(I),this.h()},h(){C(t,"class","eng"),C(t,"fill","#444"),C(t,"x","-12"),C(t,"y","8")},m(s,i){W(s,t,i),K(t,e),K(t,n)},p(s,i){i&4&&He(e,s[2])},d(s){s&&I(t)}}}function gm(r){let t,e;return{c(){t=Oe("path"),this.h()},l(n){t=Le(n,"path",{stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),U(t).forEach(I),this.h()},h(){C(t,"stroke","#444"),C(t,"stroke-width","2"),C(t,"stroke-linecap","round"),C(t,"stroke-linejoin","round"),C(t,"d",e=`M ${r[4][r[1]].x} 0 H ${r[4][r[1]].length}`)},m(n,s){W(n,t,s)},p(n,s){s&2&&e!==(e=`M ${n[4][n[1]].x} 0 H ${n[4][n[1]].length}`)&&C(t,"d",e)},d(n){n&&I(t)}}}function Ro(r){let t,e=Ve(r[0]),n=[];for(let s=0;s<e.length;s+=1)n[s]=Bo(Ko(r,e,s));return{c(){t=Oe("g");for(let s=0;s<n.length;s+=1)n[s].c()},l(s){t=Le(s,"g",{});var i=U(t);for(let a=0;a<n.length;a+=1)n[a].l(i);i.forEach(I)},m(s,i){W(s,t,i);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(t,null)},p(s,i){if(i&19){e=Ve(s[0]);let a;for(a=0;a<e.length;a+=1){const o=Ko(s,e,a);n[a]?n[a].p(o,i):(n[a]=Bo(o),n[a].c(),n[a].m(t,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=e.length}},d(s){s&&I(t),It(n,s)}}}function Bo(r){let t,e=r[7]+"",n,s;return{c(){t=Oe("text"),n=me(e),this.h()},l(i){t=Le(i,"text",{class:!0,"text-anchor":!0,fill:!0,x:!0,y:!0});var a=U(t);n=de(a,e),a.forEach(I),this.h()},h(){C(t,"class","eng"),C(t,"text-anchor","middle"),C(t,"fill","#444"),C(t,"x",s=r[4][r[1]].x+r[9]*10),C(t,"y","53")},m(i,a){W(i,t,a),K(t,n)},p(i,a){a&1&&e!==(e=i[7]+"")&&He(n,e),a&2&&s!==(s=i[4][i[1]].x+i[9]*10)&&C(t,"x",s)},d(i){i&&I(t)}}}function ym(r){let t,e,n;function s(l,f){return l[2]===0?gm:bm}let i=s(r),a=i(r),o=!r[3]&&Ro(r);return{c(){t=Oe("g"),e=Oe("path"),a.c(),n=ve(),o&&o.c(),this.h()},l(l){t=Le(l,"g",{});var f=U(t);e=Le(f,"path",{stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),U(e).forEach(I),a.l(f),n=ve(),o&&o.l(f),f.forEach(I),this.h()},h(){C(e,"stroke","#444"),C(e,"stroke-width","0.25"),C(e,"stroke-linecap","square"),C(e,"stroke-linejoin","miter"),C(e,"d",r[5])},m(l,f){W(l,t,f),K(t,e),a.m(t,null),K(t,n),o&&o.m(t,null)},p(l,[f]){i===(i=s(l))&&a?a.p(l,f):(a.d(1),a=i(l),a&&(a.c(),a.m(t,n))),l[3]?o&&(o.d(1),o=null):o?o.p(l,f):(o=Ro(l),o.c(),o.m(t,null))},i:H,o:H,d(l){l&&I(t),a.d(),o&&o.d()}}}function _m(r,t,e){const n={4:{x:10,y:10,length:40},6:{x:0,y:0,length:50}};let{tuning:s,strings:i,baseFret:a=1,fretsOnChord:o,lite:l=!1}=t,f=Array((o||0)+1).fill(null).map((c,h)=>`M ${n[i].x} ${12*h} H ${n[i].length}`).join(" ")+" "+Array(i).fill(null).map((c,h)=>`M ${n[i].y+h*10} 0 V 48`).join(" ");return r.$$set=c=>{"tuning"in c&&e(0,s=c.tuning),"strings"in c&&e(1,i=c.strings),"baseFret"in c&&e(2,a=c.baseFret),"fretsOnChord"in c&&e(6,o=c.fretsOnChord),"lite"in c&&e(3,l=c.lite)},[s,i,a,l,n,f,o]}class vm extends dt{constructor(t){super(),pt(this,t,_m,ym,mt,{tuning:0,strings:1,baseFret:2,fretsOnChord:6,lite:3})}}const Ic={4:0,6:-1};function $m(r){let t,e,n,s,i,a=!r[2]&&r[0]>0&&r[1]&&r[1]>0&&zo(r);return{c(){t=Oe("g"),e=Oe("circle"),a&&a.c(),this.h()},l(o){t=Le(o,"g",{});var l=U(t);e=Le(l,"circle",{"stroke-width":!0,stroke:!0,fill:!0,cx:!0,cy:!0,r:!0}),U(e).forEach(I),a&&a.l(l),l.forEach(I),this.h()},h(){C(e,"stroke-width","0.25"),C(e,"stroke","#444"),C(e,"fill",n=r[0]===0?"transparent":"#444"),C(e,"cx",r[3]),C(e,"cy",s=r[4].fret[r[0]]),C(e,"r",i=r[0]===0?r[5].open:r[5].fret)},m(o,l){W(o,t,l),K(t,e),a&&a.m(t,null)},p(o,l){l&1&&n!==(n=o[0]===0?"transparent":"#444")&&C(e,"fill",n),l&8&&C(e,"cx",o[3]),l&1&&s!==(s=o[4].fret[o[0]])&&C(e,"cy",s),l&1&&i!==(i=o[0]===0?o[5].open:o[5].fret)&&C(e,"r",i),!o[2]&&o[0]>0&&o[1]&&o[1]>0?a?a.p(o,l):(a=zo(o),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(o){o&&I(t),a&&a.d()}}}function wm(r){let t,e;return{c(){t=Oe("text"),e=me("×"),this.h()},l(n){t=Le(n,"text",{class:!0,"text-anchor":!0,fill:!0,x:!0,y:!0});var s=U(t);e=de(s,"×"),s.forEach(I),this.h()},h(){C(t,"class","eng"),C(t,"text-anchor","middle"),C(t,"fill","#444"),C(t,"x",r[3]),C(t,"y","-2")},m(n,s){W(n,t,s),K(t,e)},p(n,s){s&8&&C(t,"x",n[3])},d(n){n&&I(t)}}}function zo(r){let t,e,n,s;return{c(){t=Oe("text"),e=me(r[1]),s=me(`\r
      }`),this.h()},l(i){t=Le(i,"text",{fill:!0,"text-anchor":!0,style:!0,x:!0,y:!0});var a=U(t);e=de(a,r[1]),a.forEach(I),s=de(i,`\r
      }`),this.h()},h(){C(t,"fill","white"),C(t,"text-anchor","middle"),xs(t,"font-weight","bold"),C(t,"x",r[3]),C(t,"y",n=r[4].finger[r[0]]-.5)},m(i,a){W(i,t,a),K(t,e),W(i,s,a)},p(i,a){a&2&&He(e,i[1]),a&8&&C(t,"x",i[3]),a&1&&n!==(n=i[4].finger[i[0]]-.5)&&C(t,"y",n)},d(i){i&&(I(t),I(s))}}}function Em(r){let t;function e(i,a){return i[0]===-1?wm:$m}let n=e(r),s=n(r);return{c(){s.c(),t=ve()},l(i){s.l(i),t=ve()},m(i,a){s.m(i,a),W(i,t,a)},p(i,[a]){n===(n=e(i))&&s?s.p(i,a):(s.d(1),s=n(i),s&&(s.c(),s.m(t.parentNode,t)))},i:H,o:H,d(i){i&&I(t),s.d(i)}}}function Cm(r,t,e){let n,{string:s,fret:i=0,finger:a,strings:o,lite:l=!1}=t;const f={string:[50,40,30,20,10,0],fret:[-4,6.5,18,30,42,54],finger:[-3,8,19.5,31.5,43.5]},c={open:2,fret:4};return r.$$set=h=>{"string"in h&&e(6,s=h.string),"fret"in h&&e(0,i=h.fret),"finger"in h&&e(1,a=h.finger),"strings"in h&&e(7,o=h.strings),"lite"in h&&e(2,l=h.lite)},r.$$.update=()=>{r.$$.dirty&192&&e(3,n=f.string[s+Ic[o]])},[i,a,l,n,f,c,s,o]}class xm extends dt{constructor(t){super(),pt(this,t,Cm,Em,mt,{string:6,fret:0,finger:1,strings:7,lite:2})}}function Vo(r,t,e){const n=r.slice();return n[15]=t[e],n}function Go(r,t,e){const n=r.slice();return n[15]=t[e],n}function Uo(r){let t,e,n,s,i,a,o,l,f;return{c(){t=Oe("g"),e=Oe("g"),n=Oe("path"),i=Oe("rect"),o=Oe("g"),l=Oe("path"),this.h()},l(c){t=Le(c,"g",{});var h=U(t);e=Le(h,"g",{transform:!0});var d=U(e);n=Le(d,"path",{d:!0,fill:!0,"fill-opacity":!0,transform:!0}),U(n).forEach(I),d.forEach(I),i=Le(h,"rect",{fill:!0,x:!0,y:!0,width:!0,"fill-opacity":!0,height:!0}),U(i).forEach(I),o=Le(h,"g",{transform:!0});var y=U(o);l=Le(y,"path",{d:!0,fill:!0,"fill-opacity":!0,transform:!0}),U(l).forEach(I),y.forEach(I),h.forEach(I),this.h()},h(){C(n,"d","M 0, 0 m -4, 0 a 4,4 0 1,1 8,0"),C(n,"fill","#555"),C(n,"fill-opacity",.2),C(n,"transform","rotate(-90)"),C(e,"transform",s=`translate(${r[11](r[12],r[12])}, ${r[10].fret[r[4][0].value]})`),C(i,"fill","#555"),C(i,"x",r[8][r[12]][0]),C(i,"y",a=r[9][r[0]-1]),C(i,"width",(r[12]-1)*10),C(i,"fill-opacity",.2),C(i,"height","8.5"),C(l,"d","M 0, 0 m -4, 0 a 4,4 0 1,1 8,0"),C(l,"fill","#555"),C(l,"fill-opacity",.2),C(l,"transform","rotate(90)"),C(o,"transform",f=`translate(${r[11](1,r[12])}, ${r[10].fret[r[4][0].value]})`)},m(c,h){W(c,t,h),K(t,e),K(e,n),K(t,i),K(t,o),K(o,l)},p(c,h){h&16&&s!==(s=`translate(${c[11](c[12],c[12])}, ${c[10].fret[c[4][0].value]})`)&&C(e,"transform",s),h&1&&a!==(a=c[9][c[0]-1])&&C(i,"y",a),h&16&&f!==(f=`translate(${c[11](1,c[12])}, ${c[10].fret[c[4][0].value]})`)&&C(o,"transform",f)},d(c){c&&I(t)}}}function qo(r){let t,e,n;return{c(){t=Oe("circle"),this.h()},l(s){t=Le(s,"circle",{"stroke-width":!0,stroke:!0,fill:!0,cx:!0,cy:!0,r:!0}),U(t).forEach(I),this.h()},h(){C(t,"stroke-width","0.25"),C(t,"stroke","#444"),C(t,"fill","#444"),C(t,"cx",e=r[11](r[12]-r[15].position,r[12])),C(t,"cy",n=r[10].fret[r[15].value]),C(t,"r","4")},m(s,i){W(s,t,i)},p(s,i){i&16&&e!==(e=s[11](s[12]-s[15].position,s[12]))&&C(t,"cx",e),i&16&&n!==(n=s[10].fret[s[15].value])&&C(t,"cy",n)},d(s){s&&I(t)}}}function Ho(r){let t,e=Ve(r[4]),n=[];for(let s=0;s<e.length;s+=1)n[s]=Wo(Vo(r,e,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();t=ve()},l(s){for(let i=0;i<n.length;i+=1)n[i].l(s);t=ve()},m(s,i){for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(s,i);W(s,t,i)},p(s,i){if(i&7192){e=Ve(s[4]);let a;for(a=0;a<e.length;a+=1){const o=Vo(s,e,a);n[a]?n[a].p(o,i):(n[a]=Wo(o),n[a].c(),n[a].m(t.parentNode,t))}for(;a<n.length;a+=1)n[a].d(1);n.length=e.length}},d(s){s&&I(t),It(n,s)}}}function Wo(r){let t,e,n,s;return{c(){t=Oe("text"),e=me(r[3]),this.h()},l(i){t=Le(i,"text",{"text-anchor":!0,fill:!0,x:!0,y:!0});var a=U(t);e=de(a,r[3]),a.forEach(I),this.h()},h(){C(t,"text-anchor","middle"),C(t,"fill","white"),C(t,"x",n=r[11](r[12]-r[15].position,r[12])),C(t,"y",s=r[10].finger[r[15].value]-.5)},m(i,a){W(i,t,a),K(t,e)},p(i,a){a&8&&He(e,i[3]),a&16&&n!==(n=i[11](i[12]-i[15].position,i[12]))&&C(t,"x",n),a&16&&s!==(s=i[10].finger[i[15].value]-.5)&&C(t,"y",s)},d(i){i&&I(t)}}}function km(r){let t,e,n,s,i=r[1]&&r[4].length>0&&Uo(r),a=Ve(r[4]),o=[];for(let f=0;f<a.length;f+=1)o[f]=qo(Go(r,a,f));let l=!r[2]&&r[3]&&Ho(r);return{c(){t=Oe("g"),i&&i.c(),e=ve();for(let f=0;f<o.length;f+=1)o[f].c();n=Oe("rect"),l&&l.c(),this.h()},l(f){t=Le(f,"g",{});var c=U(t);i&&i.l(c),e=ve();for(let h=0;h<o.length;h+=1)o[h].l(c);n=Le(c,"rect",{fill:!0,x:!0,y:!0,width:!0,height:!0}),U(n).forEach(I),l&&l.l(c),c.forEach(I),this.h()},h(){C(n,"fill","#444"),C(n,"x",s=r[8][r[12]][r[5]]),C(n,"y",r[7]),C(n,"width",r[6]),C(n,"height",8.25)},m(f,c){W(f,t,c),i&&i.m(t,null),K(t,e);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(t,null);K(t,n),l&&l.m(t,null)},p(f,[c]){if(f[1]&&f[4].length>0?i?i.p(f,c):(i=Uo(f),i.c(),i.m(t,e)):i&&(i.d(1),i=null),c&7184){a=Ve(f[4]);let h;for(h=0;h<a.length;h+=1){const d=Go(f,a,h);o[h]?o[h].p(d,c):(o[h]=qo(d),o[h].c(),o[h].m(t,n))}for(;h<o.length;h+=1)o[h].d(1);o.length=a.length}c&32&&s!==(s=f[8][f[12]][f[5]])&&C(n,"x",s),c&128&&C(n,"y",f[7]),c&64&&C(n,"width",f[6]),!f[2]&&f[3]?l?l.p(f,c):(l=Ho(f),l.c(),l.m(t,null)):l&&(l.d(1),l=null)},i:H,o:H,d(f){f&&I(t),i&&i.d(),It(o,f),l&&l.d()}}}function Sm(r,t,e){let{frets:n,barre:s,capo:i=!1,lite:a=!1,finger:o}=t;const l={4:[10,20,30,40,50],6:[0,10,20,30,40,50]},f=[2.35,13.9,26,38],c={string:[50,40,30,20,10,0],fret:[-4,6.5,18,30,42,54],finger:[-3,8,19.5,31.5,43.5]},h=(S,D)=>c.string[S+Ic[D]];let d=[],y=n.length,$=0,v=0,A=0,x=0;return r.$$set=S=>{"frets"in S&&e(13,n=S.frets),"barre"in S&&e(0,s=S.barre),"capo"in S&&e(1,i=S.capo),"lite"in S&&e(2,a=S.lite),"finger"in S&&e(3,o=S.finger)},r.$$.update=()=>{r.$$.dirty&24625&&(e(4,d=n.map((S,D)=>({position:D,value:S})).filter(S=>S.value===s)),e(5,$=d.length>0?d[0].position:0),e(14,v=d.length>0?d[d.length-1].position:0),e(6,A=(v-$)*10),e(7,x=f[s-1]))},[s,i,a,o,d,$,A,x,l,f,c,h,y,n,v]}class Am extends dt{constructor(t){super(),pt(this,t,Sm,km,mt,{frets:13,barre:0,capo:1,lite:2,finger:3})}}function Yo(r,t,e){const n=r.slice();return n[8]=t[e],n}function Xo(r,t,e){const n=r.slice();return n[11]=t[e],n[13]=e,n}function Zo(r){let t,e,n=Ve(r[0].barres),s=[];for(let a=0;a<n.length;a+=1)s[a]=Qo(Xo(r,n,a));const i=a=>ge(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();t=ve()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);t=ve()},m(a,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,o);W(a,t,o),e=!0},p(a,o){if(o&5){n=Ve(a[0].barres);let l;for(l=0;l<n.length;l+=1){const f=Xo(a,n,l);s[l]?(s[l].p(f,o),fe(s[l],1)):(s[l]=Qo(f),s[l].c(),fe(s[l],1),s[l].m(t.parentNode,t))}for(Ct(),l=n.length;l<s.length;l+=1)i(l);xt()}},i(a){if(!e){for(let o=0;o<n.length;o+=1)fe(s[o]);e=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)ge(s[o]);e=!1},d(a){a&&I(t),It(s,a)}}}function Qo(r){let t,e;return t=new Am({props:{capo:r[13]===0&&r[0].capo,barre:r[11],finger:r[0].fingers?r[0].fingers[r[0].frets.indexOf(r[11])]:null,frets:r[0].frets,lite:r[2]}}),{c(){st(t.$$.fragment)},l(n){gt(t.$$.fragment,n)},m(n,s){it(t,n,s),e=!0},p(n,s){const i={};s&1&&(i.capo=n[13]===0&&n[0].capo),s&1&&(i.barre=n[11]),s&1&&(i.finger=n[0].fingers?n[0].fingers[n[0].frets.indexOf(n[11])]:null),s&1&&(i.frets=n[0].frets),s&4&&(i.lite=n[2]),t.$set(i)},i(n){e||(fe(t.$$.fragment,n),e=!0)},o(n){ge(t.$$.fragment,n),e=!1},d(n){at(t,n)}}}function Jo(r){let t,e;return t=new xm({props:{string:r[1].strings-r[8].position,fret:r[8].value,strings:r[1].strings,finger:r[0].fingers?r[0].fingers[r[8].position]:null,lite:r[2]}}),{c(){st(t.$$.fragment)},l(n){gt(t.$$.fragment,n)},m(n,s){it(t,n,s),e=!0},p(n,s){const i={};s&3&&(i.string=n[1].strings-n[8].position),s&1&&(i.fret=n[8].value),s&2&&(i.strings=n[1].strings),s&1&&(i.finger=n[0].fingers?n[0].fingers[n[8].position]:null),s&4&&(i.lite=n[2]),t.$set(i)},i(n){e||(fe(t.$$.fragment,n),e=!0)},o(n){ge(t.$$.fragment,n),e=!1},d(n){at(t,n)}}}function Tm(r){let t,e,n,s,i,a,o;n=new vm({props:{tuning:r[1].tuning,strings:r[1].strings,fretsOnChord:r[1].fretsOnChord,baseFret:r[0].baseFret,lite:r[2]}});let l=r[0].barres&&Zo(r),f=Ve(r[4](r[0])),c=[];for(let d=0;d<f.length;d+=1)c[d]=Jo(Yo(r,f,d));const h=d=>ge(c[d],1,1,()=>{c[d]=null});return{c(){t=Oe("svg"),e=Oe("g"),st(n.$$.fragment),l&&l.c(),s=ve();for(let d=0;d<c.length;d+=1)c[d].c();this.h()},l(d){t=Le(d,"svg",{width:!0,xmlns:!0,preserveAspectRatio:!0,viewBox:!0,class:!0});var y=U(t);e=Le(y,"g",{transform:!0});var $=U(e);gt(n.$$.fragment,$),l&&l.l($),s=ve();for(let v=0;v<c.length;v+=1)c[v].l($);$.forEach(I),y.forEach(I),this.h()},h(){C(e,"transform","translate(13, 13)"),C(t,"width","100%"),C(t,"xmlns","http://www.w3.org/2000/svg"),C(t,"preserveAspectRatio","xMinYMin meet"),C(t,"viewBox","0 5 75 65"),C(t,"class","svelte-1a0c8ce")},m(d,y){W(d,t,y),K(t,e),it(n,e,null),l&&l.m(e,null),K(e,s);for(let $=0;$<c.length;$+=1)c[$]&&c[$].m(e,null);r[6](t),i=!0,a||(o=Ue(t,"click",r[5],!0),a=!0)},p(d,[y]){const $={};if(y&2&&($.tuning=d[1].tuning),y&2&&($.strings=d[1].strings),y&2&&($.fretsOnChord=d[1].fretsOnChord),y&1&&($.baseFret=d[0].baseFret),y&4&&($.lite=d[2]),n.$set($),d[0].barres?l?(l.p(d,y),y&1&&fe(l,1)):(l=Zo(d),l.c(),fe(l,1),l.m(e,s)):l&&(Ct(),ge(l,1,1,()=>{l=null}),xt()),y&23){f=Ve(d[4](d[0]));let v;for(v=0;v<f.length;v+=1){const A=Yo(d,f,v);c[v]?(c[v].p(A,y),fe(c[v],1)):(c[v]=Jo(A),c[v].c(),fe(c[v],1),c[v].m(e,null))}for(Ct(),v=f.length;v<c.length;v+=1)h(v);xt()}},i(d){if(!i){fe(n.$$.fragment,d),fe(l);for(let y=0;y<f.length;y+=1)fe(c[y]);i=!0}},o(d){ge(n.$$.fragment,d),ge(l),c=c.filter(Boolean);for(let y=0;y<c.length;y+=1)ge(c[y]);i=!1},d(d){d&&I(t),at(n),l&&l.d(),It(c,d),r[6](null),a=!1,o()}}}function Pm(r,t,e){let{chord:n,instrument:s,lite:i=!1}=t,a;const o=h=>h.frets.map((d,y)=>({position:y,value:d})).filter(d=>!h.barres||h.barres.indexOf(d.value)===-1),l=Bn();function f(h){l("clickPos",{x:h.offsetX/a.clientWidth,y:h.offsetY/a.clientHeight})}function c(h){ks[h?"unshift":"push"](()=>{a=h,e(3,a)})}return r.$$set=h=>{"chord"in h&&e(0,n=h.chord),"instrument"in h&&e(1,s=h.instrument),"lite"in h&&e(2,i=h.lite)},[n,s,i,a,o,f,c]}class jm extends dt{constructor(t){super(),pt(this,t,Pm,Tm,mt,{chord:0,instrument:1,lite:2})}}function el(r,t,e){const n=r.slice();return n[10]=t[e],n}function tl(r){let t,e,n,s,i,a,o,l,f,c,h,d,y,$,v,A,x,S,D,P,O,j,L=Ve(r[0]),N=[];for(let V=0;V<L.length;V+=1)N[V]=rl(el(r,L,V));const F=V=>ge(N[V],1,1,()=>{N[V]=null});return{c(){t=Z("span"),e=me(r[1]),n=Te(),s=Z("div"),i=Z("div");for(let V=0;V<N.length;V+=1)N[V].c();a=Te(),o=Z("div"),l=Z("button"),f=me("<"),h=Te(),d=Z("strong"),y=me(r[4]),$=me(" / "),v=me(r[5]),A=Te(),x=Z("button"),S=me(">"),this.h()},l(V){t=Q(V,"SPAN",{class:!0});var G=U(t);e=de(G,r[1]),G.forEach(I),n=Pe(V),s=Q(V,"DIV",{class:!0});var Y=U(s);i=Q(Y,"DIV",{class:!0,style:!0});var pe=U(i);for(let ie=0;ie<N.length;ie+=1)N[ie].l(pe);pe.forEach(I),Y.forEach(I),a=Pe(V),o=Q(V,"DIV",{class:!0});var ce=U(o);l=Q(ce,"BUTTON",{class:!0});var $e=U(l);f=de($e,"<"),$e.forEach(I),h=Pe(ce),d=Q(ce,"STRONG",{class:!0});var Ee=U(d);y=de(Ee,r[4]),$=de(Ee," / "),v=de(Ee,r[5]),Ee.forEach(I),A=Pe(ce),x=Q(ce,"BUTTON",{class:!0});var Ce=U(x);S=de(Ce,">"),Ce.forEach(I),ce.forEach(I),this.h()},h(){C(t,"class","eng chord-name svelte-1mv8nun"),C(i,"class","slide svelte-1mv8nun"),xs(i,"margin-left",(r[4]-1)*-250+"px"),C(s,"class","slider svelte-1mv8nun"),C(l,"class","button-outline eng svelte-1mv8nun"),l.disabled=c=r[4]<=1,C(d,"class","eng"),C(x,"class","button-outline eng svelte-1mv8nun"),x.disabled=D=r[4]===r[5],C(o,"class","slider-nav svelte-1mv8nun")},m(V,G){W(V,t,G),K(t,e),W(V,n,G),W(V,s,G),K(s,i);for(let Y=0;Y<N.length;Y+=1)N[Y]&&N[Y].m(i,null);W(V,a,G),W(V,o,G),K(o,l),K(l,f),K(o,h),K(o,d),K(d,y),K(d,$),K(d,v),K(o,A),K(o,x),K(x,S),P=!0,O||(j=[Ue(l,"click",r[7]),Ue(x,"click",r[8])],O=!0)},p(V,G){if((!P||G&2)&&He(e,V[1]),G&5){L=Ve(V[0]);let Y;for(Y=0;Y<L.length;Y+=1){const pe=el(V,L,Y);N[Y]?(N[Y].p(pe,G),fe(N[Y],1)):(N[Y]=rl(pe),N[Y].c(),fe(N[Y],1),N[Y].m(i,null))}for(Ct(),Y=L.length;Y<N.length;Y+=1)F(Y);xt()}(!P||G&16)&&xs(i,"margin-left",(V[4]-1)*-250+"px"),(!P||G&16&&c!==(c=V[4]<=1))&&(l.disabled=c),(!P||G&16)&&He(y,V[4]),(!P||G&32)&&He(v,V[5]),(!P||G&48&&D!==(D=V[4]===V[5]))&&(x.disabled=D)},i(V){if(!P){for(let G=0;G<L.length;G+=1)fe(N[G]);P=!0}},o(V){N=N.filter(Boolean);for(let G=0;G<N.length;G+=1)ge(N[G]);P=!1},d(V){V&&(I(t),I(n),I(s),I(a),I(o)),It(N,V),O=!1,zn(j)}}}function rl(r){let t,e,n,s;return e=new jm({props:{instrument:r[2],chord:r[10]}}),{c(){t=Z("div"),st(e.$$.fragment),n=Te(),this.h()},l(i){t=Q(i,"DIV",{class:!0});var a=U(t);gt(e.$$.fragment,a),n=Pe(a),a.forEach(I),this.h()},h(){C(t,"class","svelte-1mv8nun")},m(i,a){W(i,t,a),it(e,t,null),K(t,n),s=!0},p(i,a){const o={};a&4&&(o.instrument=i[2]),a&1&&(o.chord=i[10]),e.$set(o)},i(i){s||(fe(e.$$.fragment,i),s=!0)},o(i){ge(e.$$.fragment,i),s=!1},d(i){i&&I(t),at(e)}}}function Im(r){let t,e,n=r[5]>0&&tl(r);return{c(){n&&n.c(),t=ve()},l(s){n&&n.l(s),t=ve()},m(s,i){n&&n.m(s,i),W(s,t,i),e=!0},p(s,i){s[5]>0?n?(n.p(s,i),i&32&&fe(n,1)):(n=tl(s),n.c(),fe(n,1),n.m(t.parentNode,t)):n&&(Ct(),ge(n,1,1,()=>{n=null}),xt())},i(s){e||(fe(n),e=!0)},o(s){ge(n),e=!1},d(s){s&&I(t),n&&n.d(s)}}}function Om(r){let t,e;return t=new pm({props:{open:r[3],$$slots:{default:[Im]},$$scope:{ctx:r}}}),t.$on("close",r[9]),{c(){st(t.$$.fragment)},l(n){gt(t.$$.fragment,n)},m(n,s){it(t,n,s),e=!0},p(n,[s]){const i={};s&8&&(i.open=n[3]),s&8247&&(i.$$scope={dirty:s,ctx:n}),t.$set(i)},i(n){e||(fe(t.$$.fragment,n),e=!0)},o(n){ge(t.$$.fragment,n),e=!1},d(n){at(t,n)}}}function Lm(r,t,e){let n;const s=Bn();let{chordsInfo:i,chordDisplay:a="",instrument:o,open:l=!1}=t,f=1;const c=()=>e(4,f--,f),h=()=>e(4,f++,f),d=()=>{e(4,f=1),s("close")};return r.$$set=y=>{"chordsInfo"in y&&e(0,i=y.chordsInfo),"chordDisplay"in y&&e(1,a=y.chordDisplay),"instrument"in y&&e(2,o=y.instrument),"open"in y&&e(3,l=y.open)},r.$$.update=()=>{r.$$.dirty&1&&e(5,n=i.length)},[i,a,o,l,f,n,s,c,h,d]}class Dm extends dt{constructor(t){super(),pt(this,t,Lm,Om,mt,{chordsInfo:0,chordDisplay:1,instrument:2,open:3})}}const vi=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Mm={Db:"C#",Eb:"D#",Gb:"F#",Ab:"G#",Bb:"A#"},J={maj:["ma","maj","M",""],min:["min","m","-"],sus2:["sus2","2"],sus4:["sus","sus4"],dim:["dim","o"],halfDim:["m7b5","m7(b5)","0"],aug:["aug","+"],5:["5"],6:["6"],7:["7"],9:["9"],add9:["add9","(9)"],maj7:["ma7","maj7","M7"],min7:["min7","m7"],mM7:["mM7","m(M7)","min(maj7)"]},nl={instrument:{tuning:["E","A","D","G","B","E"],fretsOnChord:4,name:"guitar",strings:6},chordShapes:[{suffix:J.maj,baseKey:"C",shape:[-1,3,2,0,1,0]},{suffix:J.sus2,baseKey:"C",shape:[-1,3,0,0,1,0]},{suffix:J.sus4,baseKey:"C",shape:[-1,3,3,0,1,1]},{suffix:J.aug,baseKey:"C",shape:[-1,3,2,1,1,3]},{suffix:J[6],baseKey:"C",shape:[-1,3,2,2,1,0]},{suffix:J[7],baseKey:"C",shape:[-1,3,2,3,1,0]},{suffix:J[9],baseKey:"C",shape:[-1,3,2,3,3,-1]},{suffix:J.add9,baseKey:"C",shape:[-1,3,2,0,3,3]},{suffix:J.maj7,baseKey:"C",shape:[-1,3,2,0,0,0]},{suffix:J.mM7,baseKey:"C",shape:[-1,3,1,0,0,0]},{suffix:J.maj,baseKey:"A",shape:[-1,0,2,2,2,0]},{suffix:J.min,baseKey:"A",shape:[-1,0,2,2,1,0]},{suffix:J.sus2,baseKey:"A",shape:[-1,0,2,2,0,0]},{suffix:J.sus4,baseKey:"A",shape:[-1,0,2,2,3,0]},{suffix:J.dim,baseKey:"A",shape:[-1,0,1,2,1,0]},{suffix:J.halfDim,baseKey:"A",shape:[-1,0,1,0,1,-1]},{suffix:J.aug,baseKey:"A",shape:[-1,0,3,2,2,0]},{suffix:J[5],baseKey:"A",shape:[-1,0,2,-1,-1,-1]},{suffix:J[6],baseKey:"A",shape:[-1,0,2,2,2,2]},{suffix:J[7],baseKey:"A",shape:[-1,0,2,0,2,0]},{suffix:J.maj7,baseKey:"A",shape:[-1,0,2,1,2,0]},{suffix:J.min7,baseKey:"A",shape:[-1,0,2,0,1,0]},{suffix:J.mM7,baseKey:"A",shape:[-1,0,2,1,1,0]},{suffix:J.maj,baseKey:"G",shape:[3,2,0,0,0,3]},{suffix:J.min,baseKey:"G",shape:[3,1,0,0,-1,-1]},{suffix:J.sus2,baseKey:"G",shape:[3,2,0,2,0,3]},{suffix:J.sus4,baseKey:"G",shape:[3,2,0,0,1,3]},{suffix:J[6],baseKey:"G",shape:[3,2,0,0,1,0]},{suffix:J[7],baseKey:"G",shape:[3,2,0,0,0,1]},{suffix:J.maj7,baseKey:"G",shape:[3,2,0,0,0,2]},{suffix:J.maj,baseKey:"E",shape:[0,2,2,1,0,0]},{suffix:J.min,baseKey:"E",shape:[0,2,2,0,0,0]},{suffix:J.sus2,baseKey:"E",shape:[0,2,2,1,0,0]},{suffix:J.sus4,baseKey:"E",shape:[0,2,4,1,0,0]},{suffix:J.dim,baseKey:"E",shape:[0,1,2,0,4,0]},{suffix:J.halfDim,baseKey:"E",shape:[0,1,0,0,3,0]},{suffix:J.aug,baseKey:"E",shape:[0,3,2,1,1,0]},{suffix:J[5],baseKey:"E",shape:[0,2,-1,-1,-1,-1]},{suffix:J[6],baseKey:"E",shape:[0,2,2,1,2,0]},{suffix:J[7],baseKey:"E",shape:[0,2,0,1,0,0]},{suffix:J.maj7,baseKey:"E",shape:[0,2,1,1,0,0]},{suffix:J.min7,baseKey:"E",shape:[0,2,0,0,0,0]},{suffix:J.mM7,baseKey:"E",shape:[0,2,1,0,0,0]},{suffix:J.maj,baseKey:"D",shape:[-1,-1,0,2,3,2]},{suffix:J.min,baseKey:"D",shape:[-1,-1,0,2,3,1]},{suffix:J.sus2,baseKey:"D",shape:[-1,-1,0,2,3,0]},{suffix:J.sus4,baseKey:"D",shape:[-1,-1,0,2,3,3]},{suffix:J.dim,baseKey:"D",shape:[-1,-1,0,1,3,1]},{suffix:J.halfDim,baseKey:"D",shape:[-1,-1,0,1,1,1]},{suffix:J.aug,baseKey:"D",shape:[-1,-1,0,3,3,2]},{suffix:J[6],baseKey:"D",shape:[-1,-1,0,2,0,2]},{suffix:J[7],baseKey:"D",shape:[-1,-1,0,2,1,2]},{suffix:J.maj7,baseKey:"D",shape:[-1,-1,0,2,2,2]},{suffix:J.min7,baseKey:"D",shape:[-1,-1,0,2,1,1]},{suffix:J.mM7,baseKey:"D",shape:[-1,-1,0,2,2,1]}],getChords(r,t="maj"){return r.includes("b")&&(r=Mm[r]),r?this.chordShapes.filter(e=>e.suffix.includes(t)).map(({baseKey:e,shape:n})=>{let s=vi.indexOf(r)-vi.indexOf(e);return s<0&&(s=vi.length+s),{baseFret:s,frets:s===0?n:n.map(i=>i>=0?i+1:i)}}).sort((e,n)=>(e.baseFret||0)-(n.baseFret||0)):[]}};function sl(r,t,e){const n=r.slice();return n[31]=t[e],n}function il(r){let t,e,n=Ve(r[9]),s=[];for(let i=0;i<n.length;i+=1)s[i]=al(sl(r,n,i));return{c(){t=me(`- \r
    `);for(let i=0;i<s.length;i+=1)s[i].c();e=ve()},l(i){t=de(i,`- \r
    `);for(let a=0;a<s.length;a+=1)s[a].l(i);e=ve()},m(i,a){W(i,t,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(i,a);W(i,e,a)},p(i,a){if(a[0]&512){n=Ve(i[9]);let o;for(o=0;o<n.length;o+=1){const l=sl(i,n,o);s[o]?s[o].p(l,a):(s[o]=al(l),s[o].c(),s[o].m(e.parentNode,e))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},d(i){i&&(I(t),I(e)),It(s,i)}}}function al(r){let t,e=r[31]+"",n,s,i;return{c(){t=Z("a"),n=me(e),i=me(`\r
          `),this.h()},l(a){t=Q(a,"A",{href:!0,class:!0});var o=U(t);n=de(o,e),o.forEach(I),i=de(a,`\r
          `),this.h()},h(){C(t,"href",s=`/#/artist/${r[31]}`),C(t,"class","text-letkwet-500")},m(a,o){W(a,t,o),K(t,n),W(a,i,o)},p(a,o){o[0]&512&&e!==(e=a[31]+"")&&He(n,e),o[0]&512&&s!==(s=`/#/artist/${a[31]}`)&&C(t,"href",s)},d(a){a&&(I(t),I(i))}}}function Nm(r){let t,e='<svg xmlns="http://www.w3.org/2000/svg" fill="#fff" viewBox="0 0 576 512"><path d="M320 224H416c17.67 0 32-14.33 32-32s-14.33-32-32-32h-95.1c-17.67 0-32 14.33-32 32S302.3 224 320 224zM320 352H480c17.67 0 32-14.33 32-32s-14.33-32-32-32h-159.1c-17.67 0-32 14.33-32 32S302.3 352 320 352zM320 96h32c17.67 0 31.1-14.33 31.1-32s-14.33-32-31.1-32h-32c-17.67 0-32 14.33-32 32S302.3 96 320 96zM544 416h-223.1c-17.67 0-32 14.33-32 32s14.33 32 32 32H544c17.67 0 32-14.33 32-32S561.7 416 544 416zM192.4 330.7L160 366.1V64.03C160 46.33 145.7 32 128 32S96 46.33 96 64.03v302L63.6 330.7c-6.312-6.883-14.94-10.38-23.61-10.38c-7.719 0-15.47 2.781-21.61 8.414c-13.03 11.95-13.9 32.22-1.969 45.27l87.1 96.09c12.12 13.26 35.06 13.26 47.19 0l87.1-96.09c11.94-13.05 11.06-33.31-1.969-45.27C224.6 316.8 204.4 317.7 192.4 330.7z"></path></svg>',n,s;return{c(){t=Z("button"),t.innerHTML=e,this.h()},l(i){t=Q(i,"BUTTON",{class:!0,title:!0,["data-svelte-h"]:!0}),jt(t)!=="svelte-sdwfks"&&(t.innerHTML=e),this.h()},h(){C(t,"class","w-10 h-10 rounded bg-green-500 text-white p-3"),C(t,"title","Auto-scroll")},m(i,a){W(i,t,a),n||(s=Ue(t,"click",r[21]),n=!0)},p:H,d(i){i&&I(t),n=!1,s()}}}function Fm(r){let t,e,n,s,i,a,o,l,f,c,h='<svg xmlns="http://www.w3.org/2000/svg" fill="#fff" viewBox="0 0 512 512"><path d="M256 0C114.6 0 0 114.6 0 256c0 141.4 114.6 256 256 256s256-114.6 256-256C512 114.6 397.4 0 256 0zM352 328c0 13.2-10.8 24-24 24h-144C170.8 352 160 341.2 160 328v-144C160 170.8 170.8 160 184 160h144C341.2 160 352 170.8 352 184V328z"></path></svg>',d,y;return{c(){t=Z("button"),e=Oe("svg"),n=Oe("path"),i=Te(),a=Z("b"),o=me("x"),l=me(r[2]),f=Te(),c=Z("button"),c.innerHTML=h,this.h()},l($){t=Q($,"BUTTON",{class:!0,title:!0});var v=U(t);e=Le(v,"svg",{xmlns:!0,fill:!0,viewBox:!0});var A=U(e);n=Le(A,"path",{d:!0}),U(n).forEach(I),A.forEach(I),v.forEach(I),i=Pe($),a=Q($,"B",{class:!0});var x=U(a);o=de(x,"x"),l=de(x,r[2]),x.forEach(I),f=Pe($),c=Q($,"BUTTON",{class:!0,title:!0,["data-svelte-h"]:!0}),jt(c)!=="svelte-f27xbg"&&(c.innerHTML=h),this.h()},h(){C(n,"d","M169.4 278.6C175.6 284.9 183.8 288 192 288s16.38-3.125 22.62-9.375l160-160c12.5-12.5 12.5-32.75 0-45.25s-32.75-12.5-45.25 0L192 210.8L54.63 73.38c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25L169.4 278.6zM329.4 265.4L192 402.8L54.63 265.4c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25l160 160C175.6 476.9 183.8 480 192 480s16.38-3.125 22.62-9.375l160-160c12.5-12.5 12.5-32.75 0-45.25S341.9 252.9 329.4 265.4z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","#fff"),C(e,"viewBox","0 0 384 512"),t.disabled=s=r[2]>=4,C(t,"class","w-10 h-10 rounded bg-green-500 text-white p-4"),C(t,"title","Speed Up"),C(a,"class","text-center"),C(c,"class","w-10 h-10 rounded bg-green-500 text-white p-3"),C(c,"title","Speed Up")},m($,v){W($,t,v),K(t,e),K(e,n),W($,i,v),W($,a,v),K(a,o),K(a,l),W($,f,v),W($,c,v),d||(y=[Ue(t,"click",r[19]),Ue(c,"click",r[20])],d=!0)},p($,v){v[0]&4&&s!==(s=$[2]>=4)&&(t.disabled=s),v[0]&4&&He(l,$[2])},d($){$&&(I(t),I(i),I(a),I(f),I(c)),d=!1,zn(y)}}}function Km(r){let t=!1,e=()=>{t=!1},n,s,i,a,o,l,f,c,h,d,y,$,v,A,x,S="♭",D,P,O,j,L,N,F="♯",V,G,Y,pe,ce,$e,Ee,Ce;cu(r[15]);let ie=r[9]&&il(r);function Fe(ue,Se){return ue[2]>0?Fm:Nm}let Ke=Fe(r),Me=Ke(r);function ot(ue){r[23](ue)}function yt(ue){r[24](ue)}let Lt={instrument:r[11],open:r[6]};return r[4]!==void 0&&(Lt.chordsInfo=r[4]),r[5]!==void 0&&(Lt.chordDisplay=r[5]),Y=new Dm({props:Lt}),ks.push(()=>Za(Y,"chordsInfo",ot)),ks.push(()=>Za(Y,"chordDisplay",yt)),Y.$on("close",r[25]),{c(){s=Z("div"),i=Z("div"),a=Z("span"),o=me(r[8]),l=Te(),ie&&ie.c(),f=Te(),c=Z("div"),h=Z("article"),d=Z("div"),y=new uu(!1),$=Te(),v=Z("div"),A=Z("div"),x=Z("button"),x.textContent=S,D=Te(),P=Z("button"),O=me(r[7]),L=Te(),N=Z("button"),N.textContent=F,V=Te(),Me.c(),G=Te(),st(Y.$$.fragment),this.h()},l(ue){s=Q(ue,"DIV",{class:!0});var Se=U(s);i=Q(Se,"DIV",{class:!0});var We=U(i);a=Q(We,"SPAN",{class:!0});var Dt=U(a);o=de(Dt,r[8]),Dt.forEach(I),l=Pe(We),ie&&ie.l(We),We.forEach(I),f=Pe(Se),c=Q(Se,"DIV",{class:!0,style:!0});var bt=U(c);h=Q(bt,"ARTICLE",{class:!0});var Xt=U(h);d=Q(Xt,"DIV",{});var Zt=U(d);y=fu(Zt,!1),Zt.forEach(I),Xt.forEach(I),$=Pe(bt),v=Q(bt,"DIV",{class:!0});var kt=U(v);A=Q(kt,"DIV",{class:!0});var tt=U(A);x=Q(tt,"BUTTON",{class:!0,["data-svelte-h"]:!0}),jt(x)!=="svelte-xrnsp6"&&(x.textContent=S),D=Pe(tt),P=Q(tt,"BUTTON",{class:!0});var _t=U(P);O=de(_t,r[7]),_t.forEach(I),L=Pe(tt),N=Q(tt,"BUTTON",{class:!0,["data-svelte-h"]:!0}),jt(N)!=="svelte-13kg417"&&(N.textContent=F),V=Pe(tt),Me.l(tt),tt.forEach(I),kt.forEach(I),bt.forEach(I),Se.forEach(I),G=Pe(ue),gt(Y.$$.fragment,ue),this.h()},h(){C(a,"class","text-bold"),C(i,"class","p-2"),y.a=null,C(h,"class","grow"),C(x,"class","w-10 h-10 rounded bg-letkwet-500 text-white font-bold text-xl"),C(P,"class","w-10 h-10 rounded bg-gray-500 text-white font-bold text-xl"),P.disabled=j=r[7]==0,C(N,"class","w-10 h-10 rounded bg-letkwet-500 text-white font-bold text-xl"),C(A,"class","sticky top-2 gap-2 flex flex-col"),C(v,"class","pr-2"),C(c,"class","flex"),xs(c,"align-items","stretch"),C(s,"class","flex flex-col mt-4")},m(ue,Se){W(ue,s,Se),K(s,i),K(i,a),K(a,o),K(i,l),ie&&ie.m(i,null),K(s,f),K(s,c),K(c,h),K(h,d),y.m(r[10],d),K(c,$),K(c,v),K(v,A),K(A,x),K(A,D),K(A,P),K(P,O),K(A,L),K(A,N),K(A,V),Me.m(A,null),r[22](s),W(ue,G,Se),it(Y,ue,Se),$e=!0,Ee||(Ce=[Ue(window,"scroll",()=>{t=!0,clearTimeout(n),n=setTimeout(e,100),r[15]()}),Ue(h,"click",r[12]),Ue(x,"click",r[16]),Ue(P,"click",r[17]),Ue(N,"click",r[18])],Ee=!0)},p(ue,Se){Se[0]&2&&!t&&(t=!0,clearTimeout(n),scrollTo(window.pageXOffset,ue[1]),n=setTimeout(e,100)),(!$e||Se[0]&256)&&He(o,ue[8]),ue[9]?ie?ie.p(ue,Se):(ie=il(ue),ie.c(),ie.m(i,null)):ie&&(ie.d(1),ie=null),(!$e||Se[0]&1024)&&y.p(ue[10]),(!$e||Se[0]&128)&&He(O,ue[7]),(!$e||Se[0]&128&&j!==(j=ue[7]==0))&&(P.disabled=j),Ke===(Ke=Fe(ue))&&Me?Me.p(ue,Se):(Me.d(1),Me=Ke(ue),Me&&(Me.c(),Me.m(A,null)));const We={};Se[0]&64&&(We.open=ue[6]),!pe&&Se[0]&16&&(pe=!0,We.chordsInfo=ue[4],Ya(()=>pe=!1)),!ce&&Se[0]&32&&(ce=!0,We.chordDisplay=ue[5],Ya(()=>ce=!1)),Y.$set(We)},i(ue){$e||(fe(Y.$$.fragment,ue),$e=!0)},o(ue){ge(Y.$$.fragment,ue),$e=!1},d(ue){ue&&(I(s),I(G)),ie&&ie.d(),Me.d(),r[22](null),at(Y,ue),Ee=!1,zn(Ce)}}}const Rm=/(([A-G][\#b]?)([A-Za-z\d\#\/\(\)]{0,9}))/m;function Bm(r){const t=Rm.exec(r);if(t){const[e,n,s,i]=t;return[s,i||""]}return[r,""]}function zm(r,t,e){let n,s;const{ChordProParser:i,HtmlDivFormatter:a}=hm;let{song:o}=t,l=[],f,c=!1,h=0,d,y,$=0,v;const A=new i,x=new a;let S,D;const P=nl.instrument,O={};function j(ie){const Fe=ie.target;if(Fe instanceof HTMLElement){if((Fe==null?void 0:Fe.className.split(" ").indexOf("chord"))<0)return;const Ke=Fe.innerText;if(O[Ke])e(4,l=O[Ke]),e(6,c=!0);else{const[Me,ot]=Bm(Ke),yt=nl.getChords(Me,ot);yt.length>0&&(e(4,l=yt),O[Ke]=yt,e(6,c=!0))}}}function L(){e(1,y=window.pageYOffset)}const N=()=>{e(3,n=n.transposeDown()),e(7,h--,h)},F=()=>{e(3,n=n.transpose(h*-1)),e(7,h=0)},V=()=>{e(3,n=n.transposeUp()),e(7,h++,h)},G=()=>e(2,$++,$),Y=()=>e(2,$=0),pe=()=>e(2,$++,$);function ce(ie){ks[ie?"unshift":"push"](()=>{d=ie,e(0,d)})}function $e(ie){l=ie,e(4,l)}function Ee(ie){f=ie,e(5,f)}const Ce=()=>e(6,c=!1);return r.$$set=ie=>{"song"in ie&&e(13,o=ie.song)},r.$$.update=()=>{if(r.$$.dirty[0]&8192&&o&&e(7,h=0),r.$$.dirty[0]&8192&&e(3,n=A.parse(o)),r.$$.dirty[0]&8&&n&&(e(8,S=n.title),n.artist===void 0||Array.isArray(n.artist)?e(9,D=n.artist):e(9,D=[n.artist])),r.$$.dirty[0]&8&&e(10,s=x.format(n).replace(/<h1>.+<\/h1>/,"")),r.$$.dirty[0]&16391)if($>0){v&&clearInterval(v);const ie=d.scrollHeight/(420-$*60)/5;e(14,v=setInterval(()=>{e(1,y+=ie),y>=d.scrollHeight&&clearInterval(v)},100))}else clearInterval(v)},[d,y,$,n,l,f,c,h,S,D,s,P,j,o,v,L,N,F,V,G,Y,pe,ce,$e,Ee,Ce]}class Vm extends dt{constructor(t){super(),pt(this,t,zm,Km,mt,{song:13},null,[-1,-1])}}function ol(r){let t,e,n,s={ctx:r,current:null,token:null,hasCatch:!1,pending:qm,then:Um,catch:Gm,value:2,blocks:[,,,]};return Ut(e=r[0],s),{c(){t=ve(),s.block.c()},l(i){t=ve(),s.block.l(i)},m(i,a){W(i,t,a),s.block.m(i,s.anchor=a),s.mount=()=>t.parentNode,s.anchor=t,n=!0},p(i,a){r=i,s.ctx=r,a&1&&e!==(e=r[0])&&Ut(e,s)||Tn(s,r,a)},i(i){n||(fe(s.block),n=!0)},o(i){for(let a=0;a<3;a+=1){const o=s.blocks[a];ge(o)}n=!1},d(i){i&&I(t),s.block.d(i),s.token=null,s=null}}}function Gm(r){return{c:H,l:H,m:H,p:H,i:H,o:H,d:H}}function Um(r){let t,e,n=r[2]&&ll(r);return{c(){n&&n.c(),t=ve()},l(s){n&&n.l(s),t=ve()},m(s,i){n&&n.m(s,i),W(s,t,i),e=!0},p(s,i){s[2]?n?(n.p(s,i),i&1&&fe(n,1)):(n=ll(s),n.c(),fe(n,1),n.m(t.parentNode,t)):n&&(Ct(),ge(n,1,1,()=>{n=null}),xt())},i(s){e||(fe(n),e=!0)},o(s){ge(n),e=!1},d(s){s&&I(t),n&&n.d(s)}}}function ll(r){let t,e;return t=new Vm({props:{song:r[2].lyrics}}),{c(){st(t.$$.fragment)},l(n){gt(t.$$.fragment,n)},m(n,s){it(t,n,s),e=!0},p(n,s){const i={};s&1&&(i.song=n[2].lyrics),t.$set(i)},i(n){e||(fe(t.$$.fragment,n),e=!0)},o(n){ge(t.$$.fragment,n),e=!1},d(n){at(t,n)}}}function qm(r){return{c:H,l:H,m:H,p:H,i:H,o:H,d:H}}function Hm(r){let t,e,n=r[0]&&ol(r);return{c(){t=Z("div"),n&&n.c()},l(s){t=Q(s,"DIV",{});var i=U(t);n&&n.l(i),i.forEach(I)},m(s,i){W(s,t,i),n&&n.m(t,null),e=!0},p(s,[i]){s[0]?n?(n.p(s,i),i&1&&fe(n,1)):(n=ol(s),n.c(),fe(n,1),n.m(t,null)):n&&(Ct(),ge(n,1,1,()=>{n=null}),xt())},i(s){e||(fe(n),e=!0)},o(s){ge(n),e=!1},d(s){s&&I(t),n&&n.d()}}}function Wm(r,t,e){let n,{params:s={song:null}}=t;return r.$$set=i=>{"params"in i&&e(1,s=i.params)},r.$$.update=()=>{r.$$.dirty&2&&e(0,n=s.song!==null?kr.songs.get(s.song):null)},[n,s]}class Ym extends dt{constructor(t){super(),pt(this,t,Wm,Hm,mt,{params:1})}}function cl(r,t,e){const n=r.slice();return n[3]=t[e],n}function ul(r){let t,e,n={ctx:r,current:null,token:null,hasCatch:!1,pending:Qm,then:Zm,catch:Xm,value:2};return Ut(e=r[1],n),{c(){t=ve(),n.block.c()},l(s){t=ve(),n.block.l(s)},m(s,i){W(s,t,i),n.block.m(s,n.anchor=i),n.mount=()=>t.parentNode,n.anchor=t},p(s,i){r=s,n.ctx=r,i&2&&e!==(e=r[1])&&Ut(e,n)||Tn(n,r,i)},d(s){s&&I(t),n.block.d(s),n.token=null,n=null}}}function Xm(r){return{c:H,l:H,m:H,p:H,d:H}}function Zm(r){let t,e=r[2]&&fl(r);return{c(){e&&e.c(),t=ve()},l(n){e&&e.l(n),t=ve()},m(n,s){e&&e.m(n,s),W(n,t,s)},p(n,s){n[2]?e?e.p(n,s):(e=fl(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){n&&I(t),e&&e.d(n)}}}function fl(r){let t,e=r[0].artist+"",n,s,i,a,o=Ve(r[2]),l=[];for(let f=0;f<o.length;f+=1)l[f]=hl(cl(r,o,f));return{c(){t=Z("h3"),n=me(e),s=me(" သီချင်းများ"),i=Te(),a=Z("div");for(let f=0;f<l.length;f+=1)l[f].c();this.h()},l(f){t=Q(f,"H3",{class:!0});var c=U(t);n=de(c,e),s=de(c," သီချင်းများ"),c.forEach(I),i=Pe(f),a=Q(f,"DIV",{class:!0});var h=U(a);for(let d=0;d<l.length;d+=1)l[d].l(h);h.forEach(I),this.h()},h(){C(t,"class","text-lg font-bold my-4 px-10"),C(a,"class","flex flex-col")},m(f,c){W(f,t,c),K(t,n),K(t,s),W(f,i,c),W(f,a,c);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(a,null)},p(f,c){if(c&1&&e!==(e=f[0].artist+"")&&He(n,e),c&2){o=Ve(f[2]);let h;for(h=0;h<o.length;h+=1){const d=cl(f,o,h);l[h]?l[h].p(d,c):(l[h]=hl(d),l[h].c(),l[h].m(a,null))}for(;h<l.length;h+=1)l[h].d(1);l.length=o.length}},d(f){f&&(I(t),I(i),I(a)),It(l,f)}}}function hl(r){let t,e,n=r[3].title+"",s,i,a;return{c(){t=Z("a"),e=me("♫ "),s=me(n),i=Te(),this.h()},l(o){t=Q(o,"A",{href:!0,class:!0});var l=U(t);e=de(l,"♫ "),s=de(l,n),i=Pe(l),l.forEach(I),this.h()},h(){C(t,"href",a=`#/song/${r[3].key}`),C(t,"class","text-letkwet-600 border-t-2 py-4 px-8")},m(o,l){W(o,t,l),K(t,e),K(t,s),K(t,i)},p(o,l){l&2&&n!==(n=o[3].title+"")&&He(s,n),l&2&&a!==(a=`#/song/${o[3].key}`)&&C(t,"href",a)},d(o){o&&I(t)}}}function Qm(r){return{c:H,l:H,m:H,p:H,d:H}}function Jm(r){let t,e=r[1]&&ul(r);return{c(){t=Z("div"),e&&e.c()},l(n){t=Q(n,"DIV",{});var s=U(t);e&&e.l(s),s.forEach(I)},m(n,s){W(n,t,s),e&&e.m(t,null)},p(n,[s]){n[1]?e?e.p(n,s):(e=ul(n),e.c(),e.m(t,null)):e&&(e.d(1),e=null)},i:H,o:H,d(n){n&&I(t),e&&e.d()}}}function ed(r,t,e){let n,{params:s={artist:null}}=t;return r.$$set=i=>{"params"in i&&e(0,s=i.params)},r.$$.update=()=>{r.$$.dirty&1&&e(1,n=s.artist!==null?kr.songs.where("artists").equalsIgnoreCase(s.artist).toArray():null)},[s,n]}class td extends dt{constructor(t){super(),pt(this,t,ed,Jm,mt,{params:0})}}function rd(r){let t,e="သီချင်းအမည် သို့မဟုတ် အဆိုတော်အမည်ဖြင့် ရှာဖွေပါ";return{c(){t=Z("div"),t.textContent=e,this.h()},l(n){t=Q(n,"DIV",{class:!0,["data-svelte-h"]:!0}),jt(t)!=="svelte-19rk3sy"&&(t.textContent=e),this.h()},h(){C(t,"class","text-gray-500 mt-40 mx-auto w-3/4 text-center")},m(n,s){W(n,t,s)},p:H,i:H,o:H,d(n){n&&I(t)}}}class nd extends dt{constructor(t){super(),pt(this,t,null,rd,mt,{})}}function sd(r){let t,e;return t=new Wl({props:{routes:r[2]}}),{c(){st(t.$$.fragment)},l(n){gt(t.$$.fragment,n)},m(n,s){it(t,n,s),e=!0},p:H,i(n){e||(fe(t.$$.fragment,n),e=!0)},o(n){ge(t.$$.fragment,n),e=!1},d(n){at(t,n)}}}function id(r){let t,e;return t=new Wl({props:{routes:r[2]}}),{c(){st(t.$$.fragment)},l(n){gt(t.$$.fragment,n)},m(n,s){it(t,n,s),e=!0},p:H,i(n){e||(fe(t.$$.fragment,n),e=!0)},o(n){ge(t.$$.fragment,n),e=!1},d(n){at(t,n)}}}function ad(r){let t,e="သီခငျ်းများရယူနေပါသည်...";return{c(){t=Z("div"),t.textContent=e,this.h()},l(n){t=Q(n,"DIV",{class:!0,["data-svelte-h"]:!0}),jt(t)!=="svelte-1em2us4"&&(t.textContent=e),this.h()},h(){C(t,"class","text-letkwet-500 font-bold mt-40 mx-auto w-3/4 text-center")},m(n,s){W(n,t,s)},p:H,i:H,o:H,d(n){n&&I(t)}}}function od(r){let t,e,n,s,i,a,o,l,f,c,h,d="🗙",y,$,v,A,x,S,D;$=new Af({props:{query:r[1]}}),$.$on("selected",r[3]);let P={ctx:r,current:null,token:null,hasCatch:!0,pending:ad,then:id,catch:sd,blocks:[,,,]};return Ut(r[4],P),{c(){t=Z("main"),e=Z("nav"),n=Z("div"),s=Z("a"),i=Z("img"),o=Te(),l=Z("div"),f=Z("input"),c=Te(),h=Z("button"),h.textContent=d,y=Te(),st($.$$.fragment),v=Te(),A=Z("div"),P.block.c(),this.h()},l(O){t=Q(O,"MAIN",{class:!0});var j=U(t);e=Q(j,"NAV",{});var L=U(e);n=Q(L,"DIV",{class:!0});var N=U(n);s=Q(N,"A",{href:!0});var F=U(s);i=Q(F,"IMG",{src:!0,class:!0,alt:!0}),F.forEach(I),o=Pe(N),l=Q(N,"DIV",{class:!0});var V=U(l);f=Q(V,"INPUT",{placeholder:!0,class:!0}),c=Pe(V),h=Q(V,"BUTTON",{class:!0,["data-svelte-h"]:!0}),jt(h)!=="svelte-42mvbl"&&(h.textContent=d),V.forEach(I),N.forEach(I),L.forEach(I),y=Pe(j),gt($.$$.fragment,j),v=Pe(j),A=Q(j,"DIV",{});var G=U(A);P.block.l(G),G.forEach(I),j.forEach(I),this.h()},h(){hu(i.src,a=bs+"/letkwet.svg")||C(i,"src",a),C(i,"class","w-8"),C(i,"alt","Letkwet"),C(s,"href","/"),C(f,"placeholder","သီချင်းအမည်၊ အဆိုတော်အမည် ရှာပါ"),C(f,"class","w-20 border rounded p-2 w-full"),C(h,"class","absolute right-2 top-1 text-gray-400 text-lg"),C(l,"class","grow relative"),C(n,"class","flex gap-4 py-2 px-4 items-center"),C(t,"class","max-w-lg mx-auto")},m(O,j){W(O,t,j),K(t,e),K(e,n),K(n,s),K(s,i),K(n,o),K(n,l),K(l,f),Xa(f,r[0]),K(l,c),K(l,h),K(t,y),it($,t,null),K(t,v),K(t,A),P.block.m(A,P.anchor=null),P.mount=()=>A,P.anchor=null,x=!0,S||(D=[Ue(f,"input",r[5]),Ue(h,"click",r[3])],S=!0)},p(O,[j]){r=O,j&1&&f.value!==r[0]&&Xa(f,r[0]);const L={};j&2&&(L.query=r[1]),$.$set(L),Tn(P,r,j)},i(O){x||(fe($.$$.fragment,O),fe(P.block),x=!0)},o(O){ge($.$$.fragment,O);for(let j=0;j<3;j+=1){const L=P.blocks[j];ge(L)}x=!1},d(O){O&&I(t),at($),P.block.d(),P.token=null,P=null,S=!1,zn(D)}}}function ld(r=400){let t;return e=>{clearTimeout(t),t=setTimeout(()=>{e()},r)}}function cd(r,t,e){const n={"/":nd,"/artist/:artist":td,"/song/:song":Ym};let s="",i="";const a=ld();function o(){e(0,s=""),e(1,i="")}let l=kr._meta.limit(1).first().then(async c=>{if(c){const h=await fetch(`${bs}/songs.json`,{method:"HEAD"});if(h.ok){const d=h.headers.get("Last-Modified"),y=d?Date.parse(d):0;if(c.last_modified<y){const $=await fetch(`${bs}/songs.json`),{songs:v}=await $.json();return kr.updateSongs(v,y)}}}else{const h=await fetch(`${bs}/songs.json`);if(h.ok){const d=h.headers.get("Last-Modified"),y=d?Date.parse(d):0,{songs:$}=await h.json();return kr.updateSongs($,y)}}});function f(){s=this.value,e(0,s)}return r.$$.update=()=>{r.$$.dirty&1&&a(()=>e(1,i=s))},[s,i,n,o,l,f]}class pd extends dt{constructor(t){super(),pt(this,t,cd,od,mt,{})}}export{pd as component,dd as universal};
