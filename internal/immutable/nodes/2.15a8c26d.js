var Qc=Object.defineProperty;var Jc=(r,t,e)=>t in r?Qc(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var Q=(r,t,e)=>(Jc(r,typeof t!="symbol"?t+"":t,e),e);import{A as eu,B as tu,C as os,D as ru,s as ot,e as ve,i as X,d as P,E as zn,b as nu,F as su,t as iu,G as $i,q as Es,H as ml,y as Z,f as W,a as $e,g as Y,h as U,c as we,j as C,x as F,I as yt,l as me,m as pe,n as He,J as It,K as ze,r as au,L as ou,u as lu,v as cu,w as uu,M as Vn,N as Oe,O as Le,k as ks,p as Tn,P as fu,Q as hu,R as du,S as Ya,T as mu,U as Xa}from"../chunks/scheduler.6ae58f8a.js";import{g as _t,t as be,c as vt,a as ce,S as lt,i as ct,b as et,d as bt,m as tt,e as rt,f as Za}from"../chunks/index.d95b2dc9.js";import{d as pl,r as pu,w as bu,b as gs}from"../chunks/paths.a98c476e.js";function Ut(r,t){const e=t.token={};function n(s,i,a,o){if(t.token!==e)return;t.resolved=o;let l=t.ctx;a!==void 0&&(l=l.slice(),l[a]=o);const u=s&&(t.current=s)(l);let c=!1;t.block&&(t.blocks?t.blocks.forEach((h,m)=>{m!==i&&h&&(_t(),be(h,1,1,()=>{t.blocks[m]===h&&(t.blocks[m]=null)}),vt())}):t.block.d(1),u.c(),ce(u,1),u.m(t.mount(),t.anchor),c=!0),t.block=u,t.blocks&&(t.blocks[i]=u),c&&ru()}if(eu(r)){const s=tu();if(r.then(i=>{os(s),n(t.then,1,t.value,i),os(null)},i=>{if(os(s),n(t.catch,2,t.error,i),os(null),!t.hasCatch)throw i}),t.current!==t.pending)return n(t.pending,0),!0}else{if(t.current!==t.then)return n(t.then,1,t.value,r),!0;t.resolved=r}}function Pn(r,t,e){const n=t.slice(),{resolved:s}=r;r.current===r.then&&(n[r.value]=s),r.current===r.catch&&(n[r.error]=s),r.block.p(n,e)}function Ge(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function bl(r,t){const e={},n={},s={$$scope:1};let i=r.length;for(;i--;){const a=r[i],o=t[i];if(o){for(const l in a)l in o||(n[l]=1);for(const l in o)s[l]||(e[l]=o[l],s[l]=1);r[i]=o}else for(const l in a)s[l]=1}for(const a in n)a in e||(e[a]=void 0);return e}function gl(r){return typeof r=="object"&&r!==null?r:{}}const gu=!0,yu=!1,ym=Object.freeze(Object.defineProperty({__proto__:null,prerender:gu,ssr:yu},Symbol.toStringTag,{value:"Module"})),je=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ve=Object.keys,Ze=Array.isArray;function nt(r,t){return typeof t!="object"||Ve(t).forEach(function(e){r[e]=t[e]}),r}typeof Promise>"u"||je.Promise||(je.Promise=Promise);const jn=Object.getPrototypeOf,_u={}.hasOwnProperty;function pt(r,t){return _u.call(r,t)}function tn(r,t){typeof t=="function"&&(t=t(jn(r))),(typeof Reflect>"u"?Ve:Reflect.ownKeys)(t).forEach(e=>{Ht(r,e,t[e])})}const yl=Object.defineProperty;function Ht(r,t,e,n){yl(r,t,nt(e&&pt(e,"get")&&typeof e.get=="function"?{get:e.get,set:e.set,configurable:!0}:{value:e,configurable:!0,writable:!0},n))}function qr(r){return{from:function(t){return r.prototype=Object.create(t.prototype),Ht(r.prototype,"constructor",r),{extend:tn.bind(null,r.prototype)}}}}const vu=Object.getOwnPropertyDescriptor;function ta(r,t){let e;return vu(r,t)||(e=jn(r))&&ta(e,t)}const $u=[].slice;function Ss(r,t,e){return $u.call(r,t,e)}function _l(r,t){return t(r)}function $n(r){if(!r)throw new Error("Assertion Failed")}function vl(r){je.setImmediate?setImmediate(r):setTimeout(r,0)}function $l(r,t){return r.reduce((e,n,s)=>{var i=t(n,s);return i&&(e[i[0]]=i[1]),e},{})}function Wt(r,t){if(pt(r,t))return r[t];if(!t)return r;if(typeof t!="string"){for(var e=[],n=0,s=t.length;n<s;++n){var i=Wt(r,t[n]);e.push(i)}return e}var a=t.indexOf(".");if(a!==-1){var o=r[t.substr(0,a)];return o===void 0?void 0:Wt(o,t.substr(a+1))}}function kt(r,t,e){if(r&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(r)))if(typeof t!="string"&&"length"in t){$n(typeof e!="string"&&"length"in e);for(var n=0,s=t.length;n<s;++n)kt(r,t[n],e[n])}else{var i=t.indexOf(".");if(i!==-1){var a=t.substr(0,i),o=t.substr(i+1);if(o==="")e===void 0?Ze(r)&&!isNaN(parseInt(a))?r.splice(a,1):delete r[a]:r[a]=e;else{var l=r[a];l&&pt(r,a)||(l=r[a]={}),kt(l,o,e)}}else e===void 0?Ze(r)&&!isNaN(parseInt(t))?r.splice(t,1):delete r[t]:r[t]=e}}function wl(r){var t={};for(var e in r)pt(r,e)&&(t[e]=r[e]);return t}const wu=[].concat;function xl(r){return wu.apply([],r)}const Cl="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(xl([8,16,32,64].map(r=>["Int","Uint","Float"].map(t=>t+r+"Array")))).filter(r=>je[r]),xu=Cl.map(r=>je[r]);$l(Cl,r=>[r,!0]);let rr=null;function Gn(r){rr=typeof WeakMap<"u"&&new WeakMap;const t=wi(r);return rr=null,t}function wi(r){if(!r||typeof r!="object")return r;let t=rr&&rr.get(r);if(t)return t;if(Ze(r)){t=[],rr&&rr.set(r,t);for(var e=0,n=r.length;e<n;++e)t.push(wi(r[e]))}else if(xu.indexOf(r.constructor)>=0)t=r;else{const i=jn(r);for(var s in t=i===Object.prototype?{}:Object.create(i),rr&&rr.set(r,t),r)pt(r,s)&&(t[s]=wi(r[s]))}return t}const{toString:Cu}={};function xi(r){return Cu.call(r).slice(8,-1)}const Ci=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Eu=typeof Ci=="symbol"?function(r){var t;return r!=null&&(t=r[Ci])&&t.apply(r)}:function(){return null},Vr={};function Gt(r){var t,e,n,s;if(arguments.length===1){if(Ze(r))return r.slice();if(this===Vr&&typeof r=="string")return[r];if(s=Eu(r)){for(e=[];!(n=s.next()).done;)e.push(n.value);return e}if(r==null)return[r];if(typeof(t=r.length)=="number"){for(e=new Array(t);t--;)e[t]=r[t];return e}return[r]}for(t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return e}const ra=typeof Symbol<"u"?r=>r[Symbol.toStringTag]==="AsyncFunction":()=>!1;var Ot=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function El(r,t){Ot=r,kl=t}var kl=()=>!0;const ku=!new Error("").stack;function jr(){if(ku)try{throw jr.arguments,new Error}catch(r){return r}return new Error}function Ei(r,t){var e=r.stack;return e?(t=t||0,e.indexOf(r.name)===0&&(t+=(r.name+r.message).split(`
`).length),e.split(`
`).slice(t).filter(kl).map(n=>`
`+n).join("")):""}var Sl=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],na=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Sl),Su={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Hr(r,t){this._e=jr(),this.name=r,this.message=t}function Al(r,t){return r+". Errors: "+Object.keys(t).map(e=>t[e].toString()).filter((e,n,s)=>s.indexOf(e)===n).join(`
`)}function As(r,t,e,n){this._e=jr(),this.failures=t,this.failedKeys=n,this.successCount=e,this.message=Al(r,t)}function xn(r,t){this._e=jr(),this.name="BulkError",this.failures=Object.keys(t).map(e=>t[e]),this.failuresByPos=t,this.message=Al(r,t)}qr(Hr).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Ei(this._e,2))}},toString:function(){return this.name+": "+this.message}}),qr(As).from(Hr),qr(xn).from(Hr);var sa=na.reduce((r,t)=>(r[t]=t+"Error",r),{});const Au=Hr;var oe=na.reduce((r,t)=>{var e=t+"Error";function n(s,i){this._e=jr(),this.name=e,s?typeof s=="string"?(this.message=`${s}${i?`
 `+i:""}`,this.inner=i||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=Su[t]||e,this.inner=null)}return qr(n).from(Au),r[t]=n,r},{});oe.Syntax=SyntaxError,oe.Type=TypeError,oe.Range=RangeError;var Qa=Sl.reduce((r,t)=>(r[t+"Error"]=oe[t],r),{}),ys=na.reduce((r,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(r[t+"Error"]=oe[t]),r),{});function Pe(){}function In(r){return r}function Tu(r,t){return r==null||r===In?t:function(e){return t(r(e))}}function Sr(r,t){return function(){r.apply(this,arguments),t.apply(this,arguments)}}function Pu(r,t){return r===Pe?t:function(){var e=r.apply(this,arguments);e!==void 0&&(arguments[0]=e);var n=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Sr(n,this.onsuccess):n),s&&(this.onerror=this.onerror?Sr(s,this.onerror):s),i!==void 0?i:e}}function ju(r,t){return r===Pe?t:function(){r.apply(this,arguments);var e=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),e&&(this.onsuccess=this.onsuccess?Sr(e,this.onsuccess):e),n&&(this.onerror=this.onerror?Sr(n,this.onerror):n)}}function Iu(r,t){return r===Pe?t:function(e){var n=r.apply(this,arguments);nt(e,n);var s=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Sr(s,this.onsuccess):s),i&&(this.onerror=this.onerror?Sr(i,this.onerror):i),n===void 0?a===void 0?void 0:a:nt(n,a)}}function Ou(r,t){return r===Pe?t:function(){return t.apply(this,arguments)!==!1&&r.apply(this,arguments)}}function ia(r,t){return r===Pe?t:function(){var e=r.apply(this,arguments);if(e&&typeof e.then=="function"){for(var n=this,s=arguments.length,i=new Array(s);s--;)i[s]=arguments[s];return e.then(function(){return t.apply(n,i)})}return t.apply(this,arguments)}}ys.ModifyError=As,ys.DexieError=Hr,ys.BulkError=xn;var On={};const Tl=100,[ki,Ts,Si]=typeof Promise>"u"?[]:(()=>{let r=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[r,jn(r),r];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,jn(t),r]})(),Pl=Ts&&Ts.then,_s=ki&&ki.constructor,aa=!!Si;var Ai=!1,Lu=Si?()=>{Si.then(ls)}:je.setImmediate?setImmediate.bind(null,ls):je.MutationObserver?()=>{var r=document.createElement("div");new MutationObserver(()=>{ls(),r=null}).observe(r,{attributes:!0}),r.setAttribute("i","1")}:()=>{setTimeout(ls,0)},Cn=function(r,t){wn.push([r,t]),Ps&&(Lu(),Ps=!1)},Ti=!0,Ps=!0,xr=[],vs=[],Pi=null,ji=In,Wr={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:to,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(r=>{try{to(r[0],r[1])}catch{}})}},ee=Wr,wn=[],Cr=0,$s=[];function q(r){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Pe,this._lib=!1;var t=this._PSD=ee;if(Ot&&(this._stackHolder=jr(),this._prev=null,this._numPrev=0),typeof r!="function"){if(r!==On)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Oi(this,this._value))}this._state=null,this._value=null,++t.ref,Il(this,r)}const Ii={get:function(){var r=ee,t=js;function e(n,s){var i=!r.global&&(r!==ee||t!==js);const a=i&&!Yt();var o=new q((l,u)=>{oa(this,new jl(Is(n,r,i,a),Is(s,r,i,a),l,u,r))});return Ot&&Dl(o,this),o}return e.prototype=On,e},set:function(r){Ht(this,"then",r&&r.prototype===On?Ii:{get:function(){return r},set:Ii.set})}};function jl(r,t,e,n,s){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof t=="function"?t:null,this.resolve=e,this.reject=n,this.psd=s}function Il(r,t){try{t(e=>{if(r._state===null){if(e===r)throw new TypeError("A promise cannot be resolved with itself.");var n=r._lib&&Un();e&&typeof e.then=="function"?Il(r,(s,i)=>{e instanceof q?e._then(s,i):e.then(s,i)}):(r._state=!0,r._value=e,Ol(r)),n&&qn()}},Oi.bind(null,r))}catch(e){Oi(r,e)}}function Oi(r,t){if(vs.push(t),r._state===null){var e=r._lib&&Un();t=ji(t),r._state=!1,r._value=t,Ot&&t!==null&&typeof t=="object"&&!t._promise&&function(n,s,i){try{n.apply(null,i)}catch(a){s&&s(a)}}(()=>{var n=ta(t,"stack");t._promise=r,Ht(t,"stack",{get:()=>Ai?n&&(n.get?n.get.apply(t):n.value):r.stack})}),function(n){xr.some(s=>s._value===n._value)||xr.push(n)}(r),Ol(r),e&&qn()}}function Ol(r){var t=r._listeners;r._listeners=[];for(var e=0,n=t.length;e<n;++e)oa(r,t[e]);var s=r._PSD;--s.ref||s.finalize(),Cr===0&&(++Cr,Cn(()=>{--Cr==0&&la()},[]))}function oa(r,t){if(r._state!==null){var e=r._state?t.onFulfilled:t.onRejected;if(e===null)return(r._state?t.resolve:t.reject)(r._value);++t.psd.ref,++Cr,Cn(Du,[e,r,t])}else r._listeners.push(t)}function Du(r,t,e){try{Pi=t;var n,s=t._value;t._state?n=r(s):(vs.length&&(vs=[]),n=r(s),vs.indexOf(s)===-1&&function(i){for(var a=xr.length;a;)if(xr[--a]._value===i._value)return void xr.splice(a,1)}(t)),e.resolve(n)}catch(i){e.reject(i)}finally{Pi=null,--Cr==0&&la(),--e.psd.ref||e.psd.finalize()}}function Ll(r,t,e){if(t.length===e)return t;var n="";if(r._state===!1){var s,i,a=r._value;a!=null?(s=a.name||"Error",i=a.message||a,n=Ei(a,0)):(s=a,i=""),t.push(s+(i?": "+i:"")+n)}return Ot&&((n=Ei(r._stackHolder,2))&&t.indexOf(n)===-1&&t.push(n),r._prev&&Ll(r._prev,t,e)),t}function Dl(r,t){var e=t?t._numPrev+1:0;e<100&&(r._prev=t,r._numPrev=e)}function ls(){Un()&&qn()}function Un(){var r=Ti;return Ti=!1,Ps=!1,r}function qn(){var r,t,e;do for(;wn.length>0;)for(r=wn,wn=[],e=r.length,t=0;t<e;++t){var n=r[t];n[0].apply(null,n[1])}while(wn.length>0);Ti=!0,Ps=!0}function la(){var r=xr;xr=[],r.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=$s.slice(0),e=t.length;e;)t[--e]()}function cs(r){return new q(On,!1,r)}function Ie(r,t){var e=ee;return function(){var n=Un(),s=ee;try{return lr(e,!0),r.apply(this,arguments)}catch(i){t&&t(i)}finally{lr(s,!1),n&&qn()}}}tn(q.prototype,{then:Ii,_then:function(r,t){oa(this,new jl(null,null,r,t,ee))},catch:function(r){if(arguments.length===1)return this.then(null,r);var t=arguments[0],e=arguments[1];return typeof t=="function"?this.then(null,n=>n instanceof t?e(n):cs(n)):this.then(null,n=>n&&n.name===t?e(n):cs(n))},finally:function(r){return this.then(t=>(r(),t),t=>(r(),cs(t)))},stack:{get:function(){if(this._stack)return this._stack;try{Ai=!0;var r=Ll(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=r),r}finally{Ai=!1}}},timeout:function(r,t){return r<1/0?new q((e,n)=>{var s=setTimeout(()=>n(new oe.Timeout(t)),r);this.then(e,n).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Ht(q.prototype,Symbol.toStringTag,"Dexie.Promise"),Wr.env=Ml(),tn(q,{all:function(){var r=Gt.apply(null,arguments).map(us);return new q(function(t,e){r.length===0&&t([]);var n=r.length;r.forEach((s,i)=>q.resolve(s).then(a=>{r[i]=a,--n||t(r)},e))})},resolve:r=>{if(r instanceof q)return r;if(r&&typeof r.then=="function")return new q((e,n)=>{r.then(e,n)});var t=new q(On,!0,r);return Dl(t,Pi),t},reject:cs,race:function(){var r=Gt.apply(null,arguments).map(us);return new q((t,e)=>{r.map(n=>q.resolve(n).then(t,e))})},PSD:{get:()=>ee,set:r=>ee=r},totalEchoes:{get:()=>js},newPSD:or,usePSD:an,scheduler:{get:()=>Cn,set:r=>{Cn=r}},rejectionMapper:{get:()=>ji,set:r=>{ji=r}},follow:(r,t)=>new q((e,n)=>or((s,i)=>{var a=ee;a.unhandleds=[],a.onunhandled=i,a.finalize=Sr(function(){(function(o){function l(){o(),$s.splice($s.indexOf(l),1)}$s.push(l),++Cr,Cn(()=>{--Cr==0&&la()},[])})(()=>{this.unhandleds.length===0?s():i(this.unhandleds[0])})},a.finalize),r()},t,e,n))}),_s&&(_s.allSettled&&Ht(q,"allSettled",function(){const r=Gt.apply(null,arguments).map(us);return new q(t=>{r.length===0&&t([]);let e=r.length;const n=new Array(e);r.forEach((s,i)=>q.resolve(s).then(a=>n[i]={status:"fulfilled",value:a},a=>n[i]={status:"rejected",reason:a}).then(()=>--e||t(n)))})}),_s.any&&typeof AggregateError<"u"&&Ht(q,"any",function(){const r=Gt.apply(null,arguments).map(us);return new q((t,e)=>{r.length===0&&e(new AggregateError([]));let n=r.length;const s=new Array(n);r.forEach((i,a)=>q.resolve(i).then(o=>t(o),o=>{s[a]=o,--n||e(new AggregateError(s))}))})}));const Xe={awaits:0,echoes:0,id:0};var Mu=0,ws=[],oi=0,js=0,Nu=0;function or(r,t,e,n){var s=ee,i=Object.create(s);i.parent=s,i.ref=0,i.global=!1,i.id=++Nu;var a=Wr.env;i.env=aa?{Promise:q,PromiseProp:{value:q,configurable:!0,writable:!0},all:q.all,race:q.race,allSettled:q.allSettled,any:q.any,resolve:q.resolve,reject:q.reject,nthen:Ja(a.nthen,i),gthen:Ja(a.gthen,i)}:{},t&&nt(i,t),++s.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=an(i,r,e,n);return i.ref===0&&i.finalize(),o}function sn(){return Xe.id||(Xe.id=++Mu),++Xe.awaits,Xe.echoes+=Tl,Xe.id}function Yt(){return!!Xe.awaits&&(--Xe.awaits==0&&(Xe.id=0),Xe.echoes=Xe.awaits*Tl,!0)}function us(r){return Xe.echoes&&r&&r.constructor===_s?(sn(),r.then(t=>(Yt(),t),t=>(Yt(),qe(t)))):r}function Fu(r){++js,Xe.echoes&&--Xe.echoes!=0||(Xe.echoes=Xe.id=0),ws.push(ee),lr(r,!0)}function Ru(){var r=ws[ws.length-1];ws.pop(),lr(r,!1)}function lr(r,t){var e=ee;if((t?!Xe.echoes||oi++&&r===ee:!oi||--oi&&r===ee)||Nl(t?Fu.bind(null,r):Ru),r!==ee&&(ee=r,e===Wr&&(Wr.env=Ml()),aa)){var n=Wr.env.Promise,s=r.env;Ts.then=s.nthen,n.prototype.then=s.gthen,(e.global||r.global)&&(Object.defineProperty(je,"Promise",s.PromiseProp),n.all=s.all,n.race=s.race,n.resolve=s.resolve,n.reject=s.reject,s.allSettled&&(n.allSettled=s.allSettled),s.any&&(n.any=s.any))}}function Ml(){var r=je.Promise;return aa?{Promise:r,PromiseProp:Object.getOwnPropertyDescriptor(je,"Promise"),all:r.all,race:r.race,allSettled:r.allSettled,any:r.any,resolve:r.resolve,reject:r.reject,nthen:Ts.then,gthen:r.prototype.then}:{}}function an(r,t,e,n,s){var i=ee;try{return lr(r,!0),t(e,n,s)}finally{lr(i,!1)}}function Nl(r){Pl.call(ki,r)}function Is(r,t,e,n){return typeof r!="function"?r:function(){var s=ee;e&&sn(),lr(t,!0);try{return r.apply(this,arguments)}finally{lr(s,!1),n&&Nl(Yt)}}}function Ja(r,t){return function(e,n){return r.call(this,Is(e,t),Is(n,t))}}(""+Pl).indexOf("[native code]")===-1&&(sn=Yt=Pe);const eo="unhandledrejection";function to(r,t){var e;try{e=t.onuncatched(r)}catch{}if(e!==!1)try{var n,s={promise:t,reason:r};if(je.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(eo,!0,!0),nt(n,s)):je.CustomEvent&&nt(n=new CustomEvent(eo,{detail:s}),s),n&&je.dispatchEvent&&(dispatchEvent(n),!je.PromiseRejectionEvent&&je.onunhandledrejection))try{je.onunhandledrejection(n)}catch{}Ot&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${r.stack||r}`)}catch{}}var qe=q.reject;function Li(r,t,e,n){if(r.idbdb&&(r._state.openComplete||ee.letThrough||r._vip)){var s=r._createTransaction(t,e,r._dbSchema);try{s.create(),r._state.PR1398_maxLoop=3}catch(i){return i.name===sa.InvalidState&&r.isOpen()&&--r._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),r._close(),r.open().then(()=>Li(r,t,e,n))):qe(i)}return s._promise(t,(i,a)=>or(()=>(ee.trans=s,n(i,a,s)))).then(i=>s._completion.then(()=>i))}if(r._state.openComplete)return qe(new oe.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._options.autoOpen)return qe(new oe.DatabaseClosed);r.open().catch(Pe)}return r._state.dbReadyPromise.then(()=>Li(r,t,e,n))}const ro="3.2.4",vr=String.fromCharCode(65535),Di=-1/0,Kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Fl="String expected.",En=[],Vs=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Ku=Vs,Bu=Vs,Rl=r=>!/(dexie\.js|dexie\.min\.js)/.test(r),Gs="__dbnames",li="readonly",ci="readwrite";function Ar(r,t){return r?t?function(){return r.apply(this,arguments)&&t.apply(this,arguments)}:r:t}const Kl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function fs(r){return typeof r!="string"||/\./.test(r)?t=>t:t=>(t[r]===void 0&&r in t&&delete(t=Gn(t))[r],t)}class zu{_trans(t,e,n){const s=this._tx||ee.trans,i=this.name;function a(l,u,c){if(!c.schema[i])throw new oe.NotFound("Table "+i+" not part of transaction");return e(c.idbtrans,c)}const o=Un();try{return s&&s.db===this.db?s===ee.trans?s._promise(t,a,n):or(()=>s._promise(t,a,n),{trans:s,transless:ee.transless||ee}):Li(this.db,t,[this.name],a)}finally{o&&qn()}}get(t,e){return t&&t.constructor===Object?this.where(t).first(e):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(s=>this.hook.reading.fire(s))).then(e)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(Ze(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const e=Ve(t);if(e.length===1)return this.where(e[0]).equals(t[e[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(u=>u.compound&&e.every(c=>u.keyPath.indexOf(c)>=0)&&u.keyPath.every(c=>e.indexOf(c)>=0))[0];if(n&&this.db._maxKey!==vr)return this.where(n.name).equals(n.keyPath.map(u=>t[u]));!n&&Ot&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${e.join("+")}]`);const{idxByName:s}=this.schema,i=this.db._deps.indexedDB;function a(u,c){try{return i.cmp(u,c)===0}catch{return!1}}const[o,l]=e.reduce(([u,c],h)=>{const m=s[h],y=t[h];return[u||m,u||!m?Ar(c,m&&m.multi?$=>{const _=Wt($,h);return Ze(_)&&_.some(S=>a(y,S))}:$=>a(y,Wt($,h))):c]},[null,null]);return o?this.where(o.name).equals(t[o.keyPath]).filter(l):n?this.filter(l):this.where(e).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,Ze(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const e=n=>{if(!n)return n;const s=Object.create(t.prototype);for(var i in n)if(pt(n,i))try{s[i]=n[i]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=e,this.hook("reading",e),t}defineClass(){return this.mapToClass(function(t){nt(this,t)})}add(t,e){const{auto:n,keyPath:s}=this.schema.primKey;let i=t;return s&&n&&(i=fs(s)(t)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"add",keys:e!=null?[e]:null,values:[i]})).then(a=>a.numFailures?q.reject(a.failures[0]):a.lastResult).then(a=>{if(s)try{kt(t,s,a)}catch{}return a})}update(t,e){if(typeof t!="object"||Ze(t))return this.where(":id").equals(t).modify(e);{const n=Wt(t,this.schema.primKey.keyPath);if(n===void 0)return qe(new oe.InvalidArgument("Given object does not contain its primary key"));try{typeof e!="function"?Ve(e).forEach(s=>{kt(t,s,e[s])}):e(t,{value:t,primKey:n})}catch{}return this.where(":id").equals(n).modify(e)}}put(t,e){const{auto:n,keyPath:s}=this.schema.primKey;let i=t;return s&&n&&(i=fs(s)(t)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"put",values:[i],keys:e!=null?[e]:null})).then(a=>a.numFailures?q.reject(a.failures[0]):a.lastResult).then(a=>{if(s)try{kt(t,s,a)}catch{}return a})}delete(t){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"delete",keys:[t]})).then(e=>e.numFailures?q.reject(e.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:Kl})).then(t=>t.numFailures?q.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",e=>this.core.getMany({keys:t,trans:e}).then(n=>n.map(s=>this.hook.reading.fire(s))))}bulkAdd(t,e,n){const s=Array.isArray(e)?e:void 0,i=(n=n||(s?void 0:e))?n.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&s)throw new oe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let c=l&&o?t.map(fs(l)):t;return this.core.mutate({trans:a,type:"add",keys:s,values:c,wantResults:i}).then(({numFailures:h,results:m,lastResult:y,failures:$})=>{if(h===0)return i?m:y;throw new xn(`${this.name}.bulkAdd(): ${h} of ${u} operations failed`,$)})})}bulkPut(t,e,n){const s=Array.isArray(e)?e:void 0,i=(n=n||(s?void 0:e))?n.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&s)throw new oe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let c=l&&o?t.map(fs(l)):t;return this.core.mutate({trans:a,type:"put",keys:s,values:c,wantResults:i}).then(({numFailures:h,results:m,lastResult:y,failures:$})=>{if(h===0)return i?m:y;throw new xn(`${this.name}.bulkPut(): ${h} of ${u} operations failed`,$)})})}bulkDelete(t){const e=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:s,failures:i})=>{if(n===0)return s;throw new xn(`${this.name}.bulkDelete(): ${n} of ${e} operations failed`,i)})}}function kn(r){var t={},e=function(a,o){if(o){for(var l=arguments.length,u=new Array(l-1);--l;)u[l-1]=arguments[l];return t[a].subscribe.apply(null,u),r}if(typeof a=="string")return t[a]};e.addEventType=i;for(var n=1,s=arguments.length;n<s;++n)i(arguments[n]);return e;function i(a,o,l){if(typeof a!="object"){var u;o||(o=Ou),l||(l=Pe);var c={subscribers:[],fire:l,subscribe:function(h){c.subscribers.indexOf(h)===-1&&(c.subscribers.push(h),c.fire=o(c.fire,h))},unsubscribe:function(h){c.subscribers=c.subscribers.filter(function(m){return m!==h}),c.fire=c.subscribers.reduce(o,l)}};return t[a]=e[a]=c,c}Ve(u=a).forEach(function(h){var m=u[h];if(Ze(m))i(h,u[h][0],u[h][1]);else{if(m!=="asap")throw new oe.InvalidArgument("Invalid event config");var y=i(h,In,function(){for(var $=arguments.length,_=new Array($);$--;)_[$]=arguments[$];y.subscribers.forEach(function(S){vl(function(){S.apply(null,_)})})})}})}}function vn(r,t){return qr(t).from({prototype:r}),t}function Br(r,t){return!(r.filter||r.algorithm||r.or)&&(t?r.justLimit:!r.replayFilter)}function ui(r,t){r.filter=Ar(r.filter,t)}function fi(r,t,e){var n=r.replayFilter;r.replayFilter=n?()=>Ar(n(),t()):t,r.justLimit=e&&!n}function xs(r,t){if(r.isPrimKey)return t.primaryKey;const e=t.getIndexByKeyPath(r.index);if(!e)throw new oe.Schema("KeyPath "+r.index+" on object store "+t.name+" is not indexed");return e}function no(r,t,e){const n=xs(r,t.schema);return t.openCursor({trans:e,values:!r.keysOnly,reverse:r.dir==="prev",unique:!!r.unique,query:{index:n,range:r.range}})}function hs(r,t,e,n){const s=r.replayFilter?Ar(r.filter,r.replayFilter()):r.filter;if(r.or){const i={},a=(o,l,u)=>{if(!s||s(l,u,m=>l.stop(m),m=>l.fail(m))){var c=l.primaryKey,h=""+c;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(c)),pt(i,h)||(i[h]=!0,t(o,l,u))}};return Promise.all([r.or._iterate(a,e),so(no(r,n,e),r.algorithm,a,!r.keysOnly&&r.valueMapper)])}return so(no(r,n,e),Ar(r.algorithm,s),t,!r.keysOnly&&r.valueMapper)}function so(r,t,e,n){var s=Ie(n?(i,a,o)=>e(n(i),a,o):e);return r.then(i=>{if(i)return i.start(()=>{var a=()=>i.continue();t&&!t(i,o=>a=o,o=>{i.stop(o),a=Pe},o=>{i.fail(o),a=Pe})||s(i.value,i,o=>a=o),a()})})}function Qe(r,t){try{const e=io(r),n=io(t);if(e!==n)return e==="Array"?1:n==="Array"?-1:e==="binary"?1:n==="binary"?-1:e==="string"?1:n==="string"?-1:e==="Date"?1:n!=="Date"?NaN:-1;switch(e){case"number":case"Date":case"string":return r>t?1:r<t?-1:0;case"binary":return function(s,i){const a=s.length,o=i.length,l=a<o?a:o;for(let u=0;u<l;++u)if(s[u]!==i[u])return s[u]<i[u]?-1:1;return a===o?0:a<o?-1:1}(ao(r),ao(t));case"Array":return function(s,i){const a=s.length,o=i.length,l=a<o?a:o;for(let u=0;u<l;++u){const c=Qe(s[u],i[u]);if(c!==0)return c}return a===o?0:a<o?-1:1}(r,t)}}catch{}return NaN}function io(r){const t=typeof r;if(t!=="object")return t;if(ArrayBuffer.isView(r))return"binary";const e=xi(r);return e==="ArrayBuffer"?"binary":e}function ao(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r)}class Vu{_read(t,e){var n=this._ctx;return n.error?n.table._trans(null,qe.bind(null,n.error)):n.table._trans("readonly",t).then(e)}_write(t){var e=this._ctx;return e.error?e.table._trans(null,qe.bind(null,e.error)):e.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var e=this._ctx;e.algorithm=Ar(e.algorithm,t)}_iterate(t,e){return hs(this._ctx,t,e,this._ctx.table.core)}clone(t){var e=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&nt(n,t),e._ctx=n,e}raw(){return this._ctx.valueMapper=null,this}each(t){var e=this._ctx;return this._read(n=>hs(e,t,n,e.table.core))}count(t){return this._read(e=>{const n=this._ctx,s=n.table.core;if(Br(n,!0))return s.count({trans:e,query:{index:xs(n,s.schema),range:n.range}}).then(a=>Math.min(a,n.limit));var i=0;return hs(n,()=>(++i,!1),e,s).then(()=>i)}).then(t)}sortBy(t,e){const n=t.split(".").reverse(),s=n[0],i=n.length-1;function a(u,c){return c?a(u[n[c]],c-1):u[s]}var o=this._ctx.dir==="next"?1:-1;function l(u,c){var h=a(u,i),m=a(c,i);return h<m?-o:h>m?o:0}return this.toArray(function(u){return u.sort(l)}).then(e)}toArray(t){return this._read(e=>{var n=this._ctx;if(n.dir==="next"&&Br(n,!0)&&n.limit>0){const{valueMapper:s}=n,i=xs(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then(({result:a})=>s?a.map(s):a)}{const s=[];return hs(n,i=>s.push(i),e,n.table.core).then(()=>s)}},t)}offset(t){var e=this._ctx;return t<=0||(e.offset+=t,Br(e)?fi(e,()=>{var n=t;return(s,i)=>n===0||(n===1?(--n,!1):(i(()=>{s.advance(n),n=0}),!1))}):fi(e,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),fi(this._ctx,()=>{var e=t;return function(n,s,i){return--e<=0&&s(i),e>=0}},!0),this}until(t,e){return ui(this._ctx,function(n,s,i){return!t(n.value)||(s(i),e)}),this}first(t){return this.limit(1).toArray(function(e){return e[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var e,n;return ui(this._ctx,function(s){return t(s.value)}),e=this._ctx,n=t,e.isMatch=Ar(e.isMatch,n),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(n,s){t(s.key,s)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(n,s){t(s.primaryKey,s)})}keys(t){var e=this._ctx;e.keysOnly=!e.isMatch;var n=[];return this.each(function(s,i){n.push(i.key)}).then(function(){return n}).then(t)}primaryKeys(t){var e=this._ctx;if(e.dir==="next"&&Br(e,!0)&&e.limit>0)return this._read(s=>{var i=xs(e,e.table.core.schema);return e.table.core.query({trans:s,values:!1,limit:e.limit,query:{index:i,range:e.range}})}).then(({result:s})=>s).then(t);e.keysOnly=!e.isMatch;var n=[];return this.each(function(s,i){n.push(i.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(e){return e[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,e=t.index&&t.table.schema.idxByName[t.index];if(!e||!e.multi)return this;var n={};return ui(this._ctx,function(s){var i=s.primaryKey.toString(),a=pt(n,i);return n[i]=!0,!a}),this}modify(t){var e=this._ctx;return this._write(n=>{var s;if(typeof t=="function")s=t;else{var i=Ve(t),a=i.length;s=function(_){for(var S=!1,x=0;x<a;++x){var E=i[x],M=t[E];Wt(_,E)!==M&&(kt(_,E,M),S=!0)}return S}}const o=e.table.core,{outbound:l,extractKey:u}=o.schema.primaryKey,c=this.db._options.modifyChunkSize||200,h=[];let m=0;const y=[],$=(_,S)=>{const{failures:x,numFailures:E}=S;m+=_-E;for(let M of Ve(x))h.push(x[M])};return this.clone().primaryKeys().then(_=>{const S=x=>{const E=Math.min(c,_.length-x);return o.getMany({trans:n,keys:_.slice(x,x+E),cache:"immutable"}).then(M=>{const j=[],O=[],L=l?[]:null,I=[];for(let D=0;D<E;++D){const V=M[D],G={value:Gn(V),primKey:_[x+D]};s.call(G,G.value,G)!==!1&&(G.value==null?I.push(_[x+D]):l||Qe(u(V),u(G.value))===0?(O.push(G.value),l&&L.push(_[x+D])):(I.push(_[x+D]),j.push(G.value)))}const N=Br(e)&&e.limit===1/0&&(typeof t!="function"||t===hi)&&{index:e.index,range:e.range};return Promise.resolve(j.length>0&&o.mutate({trans:n,type:"add",values:j}).then(D=>{for(let V in D.failures)I.splice(parseInt(V),1);$(j.length,D)})).then(()=>(O.length>0||N&&typeof t=="object")&&o.mutate({trans:n,type:"put",keys:L,values:O,criteria:N,changeSpec:typeof t!="function"&&t}).then(D=>$(O.length,D))).then(()=>(I.length>0||N&&t===hi)&&o.mutate({trans:n,type:"delete",keys:I,criteria:N}).then(D=>$(I.length,D))).then(()=>_.length>x+E&&S(x+c))})};return S(0).then(()=>{if(h.length>0)throw new As("Error modifying one or more objects",h,m,y);return _.length})})})}delete(){var t=this._ctx,e=t.range;return Br(t)&&(t.isPrimKey&&!Bu||e.type===3)?this._write(n=>{const{primaryKey:s}=t.table.core.schema,i=e;return t.table.core.count({trans:n,query:{index:s,range:i}}).then(a=>t.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(({failures:o,lastResult:l,results:u,numFailures:c})=>{if(c)throw new As("Could not delete some values",Object.keys(o).map(h=>o[h]),a-c);return a-c}))}):this.modify(hi)}}const hi=(r,t)=>t.value=null;function Gu(r,t){return r<t?-1:r===t?0:1}function Uu(r,t){return r>t?-1:r===t?0:1}function mt(r,t,e){var n=r instanceof zl?new r.Collection(r):r;return n._ctx.error=e?new e(t):new TypeError(t),n}function zr(r){return new r.Collection(r,()=>Bl("")).limit(0)}function qu(r,t,e,n,s,i){for(var a=Math.min(r.length,n.length),o=-1,l=0;l<a;++l){var u=t[l];if(u!==n[l])return s(r[l],e[l])<0?r.substr(0,l)+e[l]+e.substr(l+1):s(r[l],n[l])<0?r.substr(0,l)+n[l]+e.substr(l+1):o>=0?r.substr(0,o)+t[o]+e.substr(o+1):null;s(r[l],u)<0&&(o=l)}return a<n.length&&i==="next"?r+e.substr(r.length):a<r.length&&i==="prev"?r.substr(0,e.length):o<0?null:r.substr(0,o)+n[o]+e.substr(o+1)}function ds(r,t,e,n){var s,i,a,o,l,u,c,h=e.length;if(!e.every(_=>typeof _=="string"))return mt(r,Fl);function m(_){s=function(x){return x==="next"?E=>E.toUpperCase():E=>E.toLowerCase()}(_),i=function(x){return x==="next"?E=>E.toLowerCase():E=>E.toUpperCase()}(_),a=_==="next"?Gu:Uu;var S=e.map(function(x){return{lower:i(x),upper:s(x)}}).sort(function(x,E){return a(x.lower,E.lower)});o=S.map(function(x){return x.upper}),l=S.map(function(x){return x.lower}),u=_,c=_==="next"?"":n}m("next");var y=new r.Collection(r,()=>tr(o[0],l[h-1]+n));y._ondirectionchange=function(_){m(_)};var $=0;return y._addAlgorithm(function(_,S,x){var E=_.key;if(typeof E!="string")return!1;var M=i(E);if(t(M,l,$))return!0;for(var j=null,O=$;O<h;++O){var L=qu(E,M,o[O],l[O],a,u);L===null&&j===null?$=O+1:(j===null||a(j,L)>0)&&(j=L)}return S(j!==null?function(){_.continue(j+c)}:x),!1}),y}function tr(r,t,e,n){return{type:2,lower:r,upper:t,lowerOpen:e,upperOpen:n}}function Bl(r){return{type:1,lower:r,upper:r}}class zl{get Collection(){return this._ctx.table.db.Collection}between(t,e,n,s){n=n!==!1,s=s===!0;try{return this._cmp(t,e)>0||this._cmp(t,e)===0&&(n||s)&&(!n||!s)?zr(this):new this.Collection(this,()=>tr(t,e,!n,!s))}catch{return mt(this,Kt)}}equals(t){return t==null?mt(this,Kt):new this.Collection(this,()=>Bl(t))}above(t){return t==null?mt(this,Kt):new this.Collection(this,()=>tr(t,void 0,!0))}aboveOrEqual(t){return t==null?mt(this,Kt):new this.Collection(this,()=>tr(t,void 0,!1))}below(t){return t==null?mt(this,Kt):new this.Collection(this,()=>tr(void 0,t,!1,!0))}belowOrEqual(t){return t==null?mt(this,Kt):new this.Collection(this,()=>tr(void 0,t))}startsWith(t){return typeof t!="string"?mt(this,Fl):this.between(t,t+vr,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):ds(this,(e,n)=>e.indexOf(n[0])===0,[t],vr)}equalsIgnoreCase(t){return ds(this,(e,n)=>e===n[0],[t],"")}anyOfIgnoreCase(){var t=Gt.apply(Vr,arguments);return t.length===0?zr(this):ds(this,(e,n)=>n.indexOf(e)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=Gt.apply(Vr,arguments);return t.length===0?zr(this):ds(this,(e,n)=>n.some(s=>e.indexOf(s)===0),t,vr)}anyOf(){const t=Gt.apply(Vr,arguments);let e=this._cmp;try{t.sort(e)}catch{return mt(this,Kt)}if(t.length===0)return zr(this);const n=new this.Collection(this,()=>tr(t[0],t[t.length-1]));n._ondirectionchange=i=>{e=i==="next"?this._ascending:this._descending,t.sort(e)};let s=0;return n._addAlgorithm((i,a,o)=>{const l=i.key;for(;e(l,t[s])>0;)if(++s,s===t.length)return a(o),!1;return e(l,t[s])===0||(a(()=>{i.continue(t[s])}),!1)}),n}notEqual(t){return this.inAnyRange([[Di,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=Gt.apply(Vr,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return mt(this,Kt)}const e=t.reduce((n,s)=>n?n.concat([[n[n.length-1][1],s]]):[[Di,s]],null);return e.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,e){const n=this._cmp,s=this._ascending,i=this._descending,a=this._min,o=this._max;if(t.length===0)return zr(this);if(!t.every(E=>E[0]!==void 0&&E[1]!==void 0&&s(E[0],E[1])<=0))return mt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",oe.InvalidArgument);const l=!e||e.includeLowers!==!1,u=e&&e.includeUppers===!0;let c,h=s;function m(E,M){return h(E[0],M[0])}try{c=t.reduce(function(E,M){let j=0,O=E.length;for(;j<O;++j){const L=E[j];if(n(M[0],L[1])<0&&n(M[1],L[0])>0){L[0]=a(L[0],M[0]),L[1]=o(L[1],M[1]);break}}return j===O&&E.push(M),E},[]),c.sort(m)}catch{return mt(this,Kt)}let y=0;const $=u?E=>s(E,c[y][1])>0:E=>s(E,c[y][1])>=0,_=l?E=>i(E,c[y][0])>0:E=>i(E,c[y][0])>=0;let S=$;const x=new this.Collection(this,()=>tr(c[0][0],c[c.length-1][1],!l,!u));return x._ondirectionchange=E=>{E==="next"?(S=$,h=s):(S=_,h=i),c.sort(m)},x._addAlgorithm((E,M,j)=>{for(var O=E.key;S(O);)if(++y,y===c.length)return M(j),!1;return!!function(L){return!$(L)&&!_(L)}(O)||(this._cmp(O,c[y][1])===0||this._cmp(O,c[y][0])===0||M(()=>{h===s?E.continue(c[y][0]):E.continue(c[y][1])}),!1)}),x}startsWithAnyOf(){const t=Gt.apply(Vr,arguments);return t.every(e=>typeof e=="string")?t.length===0?zr(this):this.inAnyRange(t.map(e=>[e,e+vr])):mt(this,"startsWithAnyOf() only works with strings")}}function jt(r){return Ie(function(t){return Ln(t),r(t.target.error),!1})}function Ln(r){r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault()}const Dn="storagemutated",nr="x-storagemutated-1",cr=kn(null,Dn);class Hu{_lock(){return $n(!ee.global),++this._reculock,this._reculock!==1||ee.global||(ee.lockOwnerFor=this),this}_unlock(){if($n(!ee.global),--this._reculock==0)for(ee.global||(ee.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{an(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&ee.lockOwnerFor!==this}create(t){if(!this.mode)return this;const e=this.db.idbdb,n=this.db._state.dbOpenError;if($n(!this.idbtrans),!t&&!e)switch(n&&n.name){case"DatabaseClosedError":throw new oe.DatabaseClosed(n);case"MissingAPIError":throw new oe.MissingAPI(n.message,n);default:throw new oe.OpenFailed(n)}if(!this.active)throw new oe.TransactionInactive;return $n(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):e.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Ie(s=>{Ln(s),this._reject(t.error)}),t.onabort=Ie(s=>{Ln(s),this.active&&this._reject(new oe.Abort(t.error)),this.active=!1,this.on("abort").fire(s)}),t.oncomplete=Ie(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&cr.storagemutated.fire(t.mutatedParts)}),this}_promise(t,e,n){if(t==="readwrite"&&this.mode!=="readwrite")return qe(new oe.ReadOnly("Transaction is readonly"));if(!this.active)return qe(new oe.TransactionInactive);if(this._locked())return new q((i,a)=>{this._blockedFuncs.push([()=>{this._promise(t,e,n).then(i,a)},ee])});if(n)return or(()=>{var i=new q((a,o)=>{this._lock();const l=e(a,o,this);l&&l.then&&l.then(a,o)});return i.finally(()=>this._unlock()),i._lib=!0,i});var s=new q((i,a)=>{var o=e(i,a,this);o&&o.then&&o.then(i,a)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(t){var e=this._root();const n=q.resolve(t);if(e._waitingFor)e._waitingFor=e._waitingFor.then(()=>n);else{e._waitingFor=n,e._waitingQueue=[];var s=e.idbtrans.objectStore(e.storeNames[0]);(function a(){for(++e._spinCount;e._waitingQueue.length;)e._waitingQueue.shift()();e._waitingFor&&(s.get(-1/0).onsuccess=a)})()}var i=e._waitingFor;return new q((a,o)=>{n.then(l=>e._waitingQueue.push(Ie(a.bind(null,l))),l=>e._waitingQueue.push(Ie(o.bind(null,l)))).finally(()=>{e._waitingFor===i&&(e._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new oe.Abort))}table(t){const e=this._memoizedTables||(this._memoizedTables={});if(pt(e,t))return e[t];const n=this.schema[t];if(!n)throw new oe.NotFound("Table "+t+" not part of transaction");const s=new this.db.Table(t,n,this);return s.core=this.db.core.table(t),e[t]=s,s}}function Mi(r,t,e,n,s,i,a){return{name:r,keyPath:t,unique:e,multi:n,auto:s,compound:i,src:(e&&!a?"&":"")+(n?"*":"")+(s?"++":"")+Vl(t)}}function Vl(r){return typeof r=="string"?r:r?"["+[].join.call(r,"+")+"]":""}function Gl(r,t,e){return{name:r,primKey:t,indexes:e,mappedClass:null,idxByName:$l(e,n=>[n.name,n])}}let Mn=r=>{try{return r.only([[]]),Mn=()=>[[]],[[]]}catch{return Mn=()=>vr,vr}};function Ni(r){return r==null?()=>{}:typeof r=="string"?function(t){return t.split(".").length===1?n=>n[t]:n=>Wt(n,t)}(r):t=>Wt(t,r)}function oo(r){return[].slice.call(r)}let Wu=0;function Sn(r){return r==null?":id":typeof r=="string"?r:`[${r.join("+")}]`}function Yu(r,t,e){function n(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:u,upper:c,lowerOpen:h,upperOpen:m}=l;return u===void 0?c===void 0?null:t.upperBound(c,!!m):c===void 0?t.lowerBound(u,!!h):t.bound(u,c,!!h,!!m)}const{schema:s,hasGetAll:i}=function(l,u){const c=oo(l.objectStoreNames);return{schema:{name:l.name,tables:c.map(h=>u.objectStore(h)).map(h=>{const{keyPath:m,autoIncrement:y}=h,$=Ze(m),_=m==null,S={},x={name:h.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:_,compound:$,keyPath:m,autoIncrement:y,unique:!0,extractKey:Ni(m)},indexes:oo(h.indexNames).map(E=>h.index(E)).map(E=>{const{name:M,unique:j,multiEntry:O,keyPath:L}=E,I={name:M,compound:Ze(L),keyPath:L,unique:j,multiEntry:O,extractKey:Ni(L)};return S[Sn(L)]=I,I}),getIndexByKeyPath:E=>S[Sn(E)]};return S[":id"]=x.primaryKey,m!=null&&(S[Sn(m)]=x.primaryKey),x})},hasGetAll:c.length>0&&"getAll"in u.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(r,e),a=s.tables.map(l=>function(u){const c=u.name;return{name:c,schema:u,mutate:function({trans:h,type:m,keys:y,values:$,range:_}){return new Promise((S,x)=>{S=Ie(S);const E=h.objectStore(c),M=E.keyPath==null,j=m==="put"||m==="add";if(!j&&m!=="delete"&&m!=="deleteRange")throw new Error("Invalid operation type: "+m);const{length:O}=y||$||{length:1};if(y&&$&&y.length!==$.length)throw new Error("Given keys array must have same length as given values array.");if(O===0)return S({numFailures:0,failures:{},results:[],lastResult:void 0});let L;const I=[],N=[];let D=0;const V=H=>{++D,Ln(H)};if(m==="deleteRange"){if(_.type===4)return S({numFailures:D,failures:N,results:[],lastResult:void 0});_.type===3?I.push(L=E.clear()):I.push(L=E.delete(n(_)))}else{const[H,he]=j?M?[$,y]:[$,null]:[y,null];if(j)for(let le=0;le<O;++le)I.push(L=he&&he[le]!==void 0?E[m](H[le],he[le]):E[m](H[le])),L.onerror=V;else for(let le=0;le<O;++le)I.push(L=E[m](H[le])),L.onerror=V}const G=H=>{const he=H.target.result;I.forEach((le,xe)=>le.error!=null&&(N[xe]=le.error)),S({numFailures:D,failures:N,results:m==="delete"?y:I.map(le=>le.result),lastResult:he})};L.onerror=H=>{V(H),G(H)},L.onsuccess=G})},getMany:({trans:h,keys:m})=>new Promise((y,$)=>{y=Ie(y);const _=h.objectStore(c),S=m.length,x=new Array(S);let E,M=0,j=0;const O=I=>{const N=I.target;x[N._pos]=N.result,++j===M&&y(x)},L=jt($);for(let I=0;I<S;++I)m[I]!=null&&(E=_.get(m[I]),E._pos=I,E.onsuccess=O,E.onerror=L,++M);M===0&&y(x)}),get:({trans:h,key:m})=>new Promise((y,$)=>{y=Ie(y);const _=h.objectStore(c).get(m);_.onsuccess=S=>y(S.target.result),_.onerror=jt($)}),query:function(h){return m=>new Promise((y,$)=>{y=Ie(y);const{trans:_,values:S,limit:x,query:E}=m,M=x===1/0?void 0:x,{index:j,range:O}=E,L=_.objectStore(c),I=j.isPrimaryKey?L:L.index(j.name),N=n(O);if(x===0)return y({result:[]});if(h){const D=S?I.getAll(N,M):I.getAllKeys(N,M);D.onsuccess=V=>y({result:V.target.result}),D.onerror=jt($)}else{let D=0;const V=S||!("openKeyCursor"in I)?I.openCursor(N):I.openKeyCursor(N),G=[];V.onsuccess=H=>{const he=V.result;return he?(G.push(S?he.value:he.primaryKey),++D===x?y({result:G}):void he.continue()):y({result:G})},V.onerror=jt($)}})}(i),openCursor:function({trans:h,values:m,query:y,reverse:$,unique:_}){return new Promise((S,x)=>{S=Ie(S);const{index:E,range:M}=y,j=h.objectStore(c),O=E.isPrimaryKey?j:j.index(E.name),L=$?_?"prevunique":"prev":_?"nextunique":"next",I=m||!("openKeyCursor"in O)?O.openCursor(n(M),L):O.openKeyCursor(n(M),L);I.onerror=jt(x),I.onsuccess=Ie(N=>{const D=I.result;if(!D)return void S(null);D.___id=++Wu,D.done=!1;const V=D.continue.bind(D);let G=D.continuePrimaryKey;G&&(G=G.bind(D));const H=D.advance.bind(D),he=()=>{throw new Error("Cursor not stopped")};D.trans=h,D.stop=D.continue=D.continuePrimaryKey=D.advance=()=>{throw new Error("Cursor not started")},D.fail=Ie(x),D.next=function(){let le=1;return this.start(()=>le--?this.continue():this.stop()).then(()=>this)},D.start=le=>{const xe=new Promise((ke,ie)=>{ke=Ie(ke),I.onerror=jt(ie),D.fail=ie,D.stop=Fe=>{D.stop=D.continue=D.continuePrimaryKey=D.advance=he,ke(Fe)}}),Ee=()=>{if(I.result)try{le()}catch(ke){D.fail(ke)}else D.done=!0,D.start=()=>{throw new Error("Cursor behind last entry")},D.stop()};return I.onsuccess=Ie(ke=>{I.onsuccess=Ee,Ee()}),D.continue=V,D.continuePrimaryKey=G,D.advance=H,Ee(),xe},S(D)},x)})},count({query:h,trans:m}){const{index:y,range:$}=h;return new Promise((_,S)=>{const x=m.objectStore(c),E=y.isPrimaryKey?x:x.index(y.name),M=n($),j=M?E.count(M):E.count();j.onsuccess=Ie(O=>_(O.target.result)),j.onerror=jt(S)})}}}(l)),o={};return a.forEach(l=>o[l.name]=l),{stack:"dbcore",transaction:r.transaction.bind(r),table(l){if(!o[l])throw new Error(`Table '${l}' not found`);return o[l]},MIN_KEY:-1/0,MAX_KEY:Mn(t),schema:s}}function Fi({_novip:r},t){const e=t.db,n=function(s,i,{IDBKeyRange:a,indexedDB:o},l){return{dbcore:function(c,h){return h.reduce((m,{create:y})=>({...m,...y(m)}),c)}(Yu(i,a,l),s.dbcore)}}(r._middlewares,e,r._deps,t);r.core=n.dbcore,r.tables.forEach(s=>{const i=s.name;r.core.schema.tables.some(a=>a.name===i)&&(s.core=r.core.table(i),r[i]instanceof r.Table&&(r[i].core=s.core))})}function Os({_novip:r},t,e,n){e.forEach(s=>{const i=n[s];t.forEach(a=>{const o=ta(a,s);(!o||"value"in o&&o.value===void 0)&&(a===r.Transaction.prototype||a instanceof r.Transaction?Ht(a,s,{get(){return this.table(s)},set(l){yl(this,s,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):a[s]=new r.Table(s,i))})})}function Ri({_novip:r},t){t.forEach(e=>{for(let n in e)e[n]instanceof r.Table&&delete e[n]})}function Xu(r,t){return r._cfg.version-t._cfg.version}function Zu(r,t,e,n){const s=r._dbSchema,i=r._createTransaction("readwrite",r._storeNames,s);i.create(e),i._completion.catch(n);const a=i._reject.bind(i),o=ee.transless||ee;or(()=>{ee.trans=i,ee.transless=o,t===0?(Ve(s).forEach(l=>{di(e,l,s[l].primKey,s[l].indexes)}),Fi(r,e),q.follow(()=>r.on.populate.fire(i)).catch(a)):function({_novip:l},u,c,h){const m=[],y=l._versions;let $=l._dbSchema=Bi(l,l.idbdb,h),_=!1;const S=y.filter(E=>E._cfg.version>=u);function x(){return m.length?q.resolve(m.shift()(c.idbtrans)).then(x):q.resolve()}return S.forEach(E=>{m.push(()=>{const M=$,j=E._cfg.dbschema;zi(l,M,h),zi(l,j,h),$=l._dbSchema=j;const O=Ul(M,j);O.add.forEach(I=>{di(h,I[0],I[1].primKey,I[1].indexes)}),O.change.forEach(I=>{if(I.recreate)throw new oe.Upgrade("Not yet support for changing primary key");{const N=h.objectStore(I.name);I.add.forEach(D=>Ki(N,D)),I.change.forEach(D=>{N.deleteIndex(D.name),Ki(N,D)}),I.del.forEach(D=>N.deleteIndex(D))}});const L=E._cfg.contentUpgrade;if(L&&E._cfg.version>u){Fi(l,h),c._memoizedTables={},_=!0;let I=wl(j);O.del.forEach(G=>{I[G]=M[G]}),Ri(l,[l.Transaction.prototype]),Os(l,[l.Transaction.prototype],Ve(I),I),c.schema=I;const N=ra(L);let D;N&&sn();const V=q.follow(()=>{if(D=L(c),D&&N){var G=Yt.bind(null,null);D.then(G,G)}});return D&&typeof D.then=="function"?q.resolve(D):V.then(()=>D)}}),m.push(M=>{(!_||!Ku)&&function(j,O){[].slice.call(O.db.objectStoreNames).forEach(L=>j[L]==null&&O.db.deleteObjectStore(L))}(E._cfg.dbschema,M),Ri(l,[l.Transaction.prototype]),Os(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),c.schema=l._dbSchema})}),x().then(()=>{var E,M;M=h,Ve(E=$).forEach(j=>{M.db.objectStoreNames.contains(j)||di(M,j,E[j].primKey,E[j].indexes)})})}(r,t,i,e).catch(a)})}function Ul(r,t){const e={del:[],add:[],change:[]};let n;for(n in r)t[n]||e.del.push(n);for(n in t){const s=r[n],i=t[n];if(s){const a={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||s.primKey.auto!==i.primKey.auto&&!Vs)a.recreate=!0,e.change.push(a);else{const o=s.idxByName,l=i.idxByName;let u;for(u in o)l[u]||a.del.push(u);for(u in l){const c=o[u],h=l[u];c?c.src!==h.src&&a.change.push(h):a.add.push(h)}(a.del.length>0||a.add.length>0||a.change.length>0)&&e.change.push(a)}}else e.add.push([n,i])}return e}function di(r,t,e,n){const s=r.db.createObjectStore(t,e.keyPath?{keyPath:e.keyPath,autoIncrement:e.auto}:{autoIncrement:e.auto});return n.forEach(i=>Ki(s,i)),s}function Ki(r,t){r.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Bi(r,t,e){const n={};return Ss(t.objectStoreNames,0).forEach(s=>{const i=e.objectStore(s);let a=i.keyPath;const o=Mi(Vl(a),a||"",!1,!1,!!i.autoIncrement,a&&typeof a!="string",!0),l=[];for(let c=0;c<i.indexNames.length;++c){const h=i.index(i.indexNames[c]);a=h.keyPath;var u=Mi(h.name,a,!!h.unique,!!h.multiEntry,!1,a&&typeof a!="string",!1);l.push(u)}n[s]=Gl(s,o,l)}),n}function zi({_novip:r},t,e){const n=e.db.objectStoreNames;for(let s=0;s<n.length;++s){const i=n[s],a=e.objectStore(i);r._hasGetAll="getAll"in a;for(let o=0;o<a.indexNames.length;++o){const l=a.indexNames[o],u=a.index(l).keyPath,c=typeof u=="string"?u:"["+Ss(u).join("+")+"]";if(t[i]){const h=t[i].idxByName[c];h&&(h.name=l,delete t[i].idxByName[c],t[i].idxByName[l]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&je.WorkerGlobalScope&&je instanceof je.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}class Qu{_parseStoresSpec(t,e){Ve(t).forEach(n=>{if(t[n]!==null){var s=t[n].split(",").map((a,o)=>{const l=(a=a.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return Mi(l,u||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),Ze(u),o===0)}),i=s.shift();if(i.multi)throw new oe.Schema("Primary key cannot be multi-valued");s.forEach(a=>{if(a.auto)throw new oe.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new oe.Schema("Index must have a name and cannot be an empty string")}),e[n]=Gl(n,i,s)}})}stores(t){const e=this.db;this._cfg.storesSource=this._cfg.storesSource?nt(this._cfg.storesSource,t):t;const n=e._versions,s={};let i={};return n.forEach(a=>{nt(s,a._cfg.storesSource),i=a._cfg.dbschema={},a._parseStoresSpec(s,i)}),e._dbSchema=i,Ri(e,[e._allTables,e,e.Transaction.prototype]),Os(e,[e._allTables,e,e.Transaction.prototype,this._cfg.tables],Ve(i),i),e._storeNames=Ve(i),this}upgrade(t){return this._cfg.contentUpgrade=ia(this._cfg.contentUpgrade||Pe,t),this}}function ca(r,t){let e=r._dbNamesDB;return e||(e=r._dbNamesDB=new Er(Gs,{addons:[],indexedDB:r,IDBKeyRange:t}),e.version(1).stores({dbnames:"name"})),e.table("dbnames")}function ua(r){return r&&typeof r.databases=="function"}function Vi(r){return or(function(){return ee.letThrough=!0,r()})}function Ju(){var r;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var e=function(){return indexedDB.databases().finally(t)};r=setInterval(e,100),e()}).finally(function(){return clearInterval(r)}):Promise.resolve()}function ef(r){const t=r._state,{indexedDB:e}=r._deps;if(t.isBeingOpened||r.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?qe(t.dbOpenError):r);Ot&&(t.openCanceller._stackHolder=jr()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function s(){if(t.openCanceller!==n)throw new oe.DatabaseClosed("db.open() was cancelled")}let i=t.dbReadyResolve,a=null,o=!1;return q.race([n,(typeof navigator>"u"?q.resolve():Ju()).then(()=>new q((l,u)=>{if(s(),!e)throw new oe.MissingAPI;const c=r.name,h=t.autoSchema?e.open(c):e.open(c,Math.round(10*r.verno));if(!h)throw new oe.MissingAPI;h.onerror=jt(u),h.onblocked=Ie(r._fireOnBlocked),h.onupgradeneeded=Ie(m=>{if(a=h.transaction,t.autoSchema&&!r._options.allowEmptyDB){h.onerror=Ln,a.abort(),h.result.close();const $=e.deleteDatabase(c);$.onsuccess=$.onerror=Ie(()=>{u(new oe.NoSuchDatabase(`Database ${c} doesnt exist`))})}else{a.onerror=jt(u);var y=m.oldVersion>Math.pow(2,62)?0:m.oldVersion;o=y<1,r._novip.idbdb=h.result,Zu(r,y/10,a,u)}},u),h.onsuccess=Ie(()=>{a=null;const m=r._novip.idbdb=h.result,y=Ss(m.objectStoreNames);if(y.length>0)try{const _=m.transaction(($=y).length===1?$[0]:$,"readonly");t.autoSchema?function({_novip:S},x,E){S.verno=x.version/10;const M=S._dbSchema=Bi(0,x,E);S._storeNames=Ss(x.objectStoreNames,0),Os(S,[S._allTables],Ve(M),M)}(r,m,_):(zi(r,r._dbSchema,_),function(S,x){const E=Ul(Bi(0,S.idbdb,x),S._dbSchema);return!(E.add.length||E.change.some(M=>M.add.length||M.change.length))}(r,_)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Fi(r,_)}catch{}var $;En.push(r),m.onversionchange=Ie(_=>{t.vcFired=!0,r.on("versionchange").fire(_)}),m.onclose=Ie(_=>{r.on("close").fire(_)}),o&&function({indexedDB:_,IDBKeyRange:S},x){!ua(_)&&x!==Gs&&ca(_,S).put({name:x}).catch(Pe)}(r._deps,c),l()},u)}))]).then(()=>(s(),t.onReadyBeingFired=[],q.resolve(Vi(()=>r.on.ready.fire(r.vip))).then(function l(){if(t.onReadyBeingFired.length>0){let u=t.onReadyBeingFired.reduce(ia,Pe);return t.onReadyBeingFired=[],q.resolve(Vi(()=>u(r.vip))).then(l)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>r).catch(l=>{t.dbOpenError=l;try{a&&a.abort()}catch{}return n===t.openCanceller&&r._close(),qe(l)}).finally(()=>{t.openComplete=!0,i()})}function Gi(r){var t=i=>r.next(i),e=s(t),n=s(i=>r.throw(i));function s(i){return a=>{var o=i(a),l=o.value;return o.done?l:l&&typeof l.then=="function"?l.then(e,n):Ze(l)?Promise.all(l).then(e,n):e(l)}}return s(t)()}function tf(r,t,e){var n=arguments.length;if(n<2)throw new oe.InvalidArgument("Too few arguments");for(var s=new Array(n-1);--n;)s[n-1]=arguments[n];return e=s.pop(),[r,xl(s),e]}function ql(r,t,e,n,s){return q.resolve().then(()=>{const i=ee.transless||ee,a=r._createTransaction(t,e,r._dbSchema,n),o={trans:a,transless:i};if(n)a.idbtrans=n.idbtrans;else try{a.create(),r._state.PR1398_maxLoop=3}catch(h){return h.name===sa.InvalidState&&r.isOpen()&&--r._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),r._close(),r.open().then(()=>ql(r,t,e,null,s))):qe(h)}const l=ra(s);let u;l&&sn();const c=q.follow(()=>{if(u=s.call(a,a),u)if(l){var h=Yt.bind(null,null);u.then(h,h)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=Gi(u))},o);return(u&&typeof u.then=="function"?q.resolve(u).then(h=>a.active?h:qe(new oe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>u)).then(h=>(n&&a._resolve(),a._completion.then(()=>h))).catch(h=>(a._reject(h),qe(h)))})}function ms(r,t,e){const n=Ze(r)?r.slice():[r];for(let s=0;s<e;++s)n.push(t);return n}const rf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(r){return{...r,table(t){const e=r.table(t),{schema:n}=e,s={},i=[];function a(c,h,m){const y=Sn(c),$=s[y]=s[y]||[],_=c==null?0:typeof c=="string"?1:c.length,S=h>0,x={...m,isVirtual:S,keyTail:h,keyLength:_,extractKey:Ni(c),unique:!S&&m.unique};return $.push(x),x.isPrimaryKey||i.push(x),_>1&&a(_===2?c[0]:c.slice(0,_-1),h+1,m),$.sort((E,M)=>E.keyTail-M.keyTail),x}const o=a(n.primaryKey.keyPath,0,n.primaryKey);s[":id"]=[o];for(const c of n.indexes)a(c.keyPath,0,c);function l(c){const h=c.query.index;return h.isVirtual?{...c,query:{index:h,range:(m=c.query.range,y=h.keyTail,{type:m.type===1?2:m.type,lower:ms(m.lower,m.lowerOpen?r.MAX_KEY:r.MIN_KEY,y),lowerOpen:!0,upper:ms(m.upper,m.upperOpen?r.MIN_KEY:r.MAX_KEY,y),upperOpen:!0})}}:c;var m,y}return{...e,schema:{...n,primaryKey:o,indexes:i,getIndexByKeyPath:function(c){const h=s[Sn(c)];return h&&h[0]}},count:c=>e.count(l(c)),query:c=>e.query(l(c)),openCursor(c){const{keyTail:h,isVirtual:m,keyLength:y}=c.query.index;return m?e.openCursor(l(c)).then($=>$&&function(_){return Object.create(_,{continue:{value:function(x){x!=null?_.continue(ms(x,c.reverse?r.MAX_KEY:r.MIN_KEY,h)):c.unique?_.continue(_.key.slice(0,y).concat(c.reverse?r.MIN_KEY:r.MAX_KEY,h)):_.continue()}},continuePrimaryKey:{value(x,E){_.continuePrimaryKey(ms(x,r.MAX_KEY,h),E)}},primaryKey:{get:()=>_.primaryKey},key:{get(){const x=_.key;return y===1?x[0]:x.slice(0,y)}},value:{get:()=>_.value}})}($)):e.openCursor(c)}}}}}};function fa(r,t,e,n){return e=e||{},n=n||"",Ve(r).forEach(s=>{if(pt(t,s)){var i=r[s],a=t[s];if(typeof i=="object"&&typeof a=="object"&&i&&a){const o=xi(i);o!==xi(a)?e[n+s]=t[s]:o==="Object"?fa(i,a,e,n+s+"."):i!==a&&(e[n+s]=t[s])}else i!==a&&(e[n+s]=t[s])}else e[n+s]=void 0}),Ve(t).forEach(s=>{pt(r,s)||(e[n+s]=t[s])}),e}const nf={stack:"dbcore",name:"HooksMiddleware",level:2,create:r=>({...r,table(t){const e=r.table(t),{primaryKey:n}=e.schema;return{...e,mutate(i){const a=ee.trans,{deleting:o,creating:l,updating:u}=a.table(t).hook;switch(i.type){case"add":if(l.fire===Pe)break;return a._promise("readwrite",()=>c(i),!0);case"put":if(l.fire===Pe&&u.fire===Pe)break;return a._promise("readwrite",()=>c(i),!0);case"delete":if(o.fire===Pe)break;return a._promise("readwrite",()=>c(i),!0);case"deleteRange":if(o.fire===Pe)break;return a._promise("readwrite",()=>function(m){return h(m.trans,m.range,1e4)}(i),!0)}return e.mutate(i);function c(m){const y=ee.trans,$=m.keys||function(_,S){return S.type==="delete"?S.keys:S.keys||S.values.map(_.extractKey)}(n,m);if(!$)throw new Error("Keys missing");return(m=m.type==="add"||m.type==="put"?{...m,keys:$}:{...m}).type!=="delete"&&(m.values=[...m.values]),m.keys&&(m.keys=[...m.keys]),function(_,S,x){return S.type==="add"?Promise.resolve([]):_.getMany({trans:S.trans,keys:x,cache:"immutable"})}(e,m,$).then(_=>{const S=$.map((x,E)=>{const M=_[E],j={onerror:null,onsuccess:null};if(m.type==="delete")o.fire.call(j,x,M,y);else if(m.type==="add"||M===void 0){const O=l.fire.call(j,x,m.values[E],y);x==null&&O!=null&&(x=O,m.keys[E]=x,n.outbound||kt(m.values[E],n.keyPath,x))}else{const O=fa(M,m.values[E]),L=u.fire.call(j,O,x,M,y);if(L){const I=m.values[E];Object.keys(L).forEach(N=>{pt(I,N)?I[N]=L[N]:kt(I,N,L[N])})}}return j});return e.mutate(m).then(({failures:x,results:E,numFailures:M,lastResult:j})=>{for(let O=0;O<$.length;++O){const L=E?E[O]:$[O],I=S[O];L==null?I.onerror&&I.onerror(x[O]):I.onsuccess&&I.onsuccess(m.type==="put"&&_[O]?m.values[O]:L)}return{failures:x,results:E,numFailures:M,lastResult:j}}).catch(x=>(S.forEach(E=>E.onerror&&E.onerror(x)),Promise.reject(x)))})}function h(m,y,$){return e.query({trans:m,values:!1,query:{index:n,range:y},limit:$}).then(({result:_})=>c({type:"delete",keys:_,trans:m}).then(S=>S.numFailures>0?Promise.reject(S.failures[0]):_.length<$?{failures:[],numFailures:0,lastResult:void 0}:h(m,{...y,lower:_[_.length-1],lowerOpen:!0},$)))}}}}})};function Hl(r,t,e){try{if(!t||t.keys.length<r.length)return null;const n=[];for(let s=0,i=0;s<t.keys.length&&i<r.length;++s)Qe(t.keys[s],r[i])===0&&(n.push(e?Gn(t.values[s]):t.values[s]),++i);return n.length===r.length?n:null}catch{return null}}const sf={stack:"dbcore",level:-1,create:r=>({table:t=>{const e=r.table(t);return{...e,getMany:n=>{if(!n.cache)return e.getMany(n);const s=Hl(n.keys,n.trans._cache,n.cache==="clone");return s?q.resolve(s):e.getMany(n).then(i=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?Gn(i):i},i))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),e.mutate(n))}}})};function ha(r){return!("from"in r)}const Vt=function(r,t){if(!this){const e=new Vt;return r&&"d"in r&&nt(e,r),e}nt(this,arguments.length?{d:1,from:r,to:arguments.length>1?t:r}:{d:0})};function Nn(r,t,e){const n=Qe(t,e);if(isNaN(n))return;if(n>0)throw RangeError();if(ha(r))return nt(r,{from:t,to:e,d:1});const s=r.l,i=r.r;if(Qe(e,r.from)<0)return s?Nn(s,t,e):r.l={from:t,to:e,d:1,l:null,r:null},lo(r);if(Qe(t,r.to)>0)return i?Nn(i,t,e):r.r={from:t,to:e,d:1,l:null,r:null},lo(r);Qe(t,r.from)<0&&(r.from=t,r.l=null,r.d=i?i.d+1:1),Qe(e,r.to)>0&&(r.to=e,r.r=null,r.d=r.l?r.l.d+1:1);const a=!r.r;s&&!r.l&&Ls(r,s),i&&a&&Ls(r,i)}function Ls(r,t){ha(t)||function e(n,{from:s,to:i,l:a,r:o}){Nn(n,s,i),a&&e(n,a),o&&e(n,o)}(r,t)}function af(r,t){const e=Ui(t);let n=e.next();if(n.done)return!1;let s=n.value;const i=Ui(r);let a=i.next(s.from),o=a.value;for(;!n.done&&!a.done;){if(Qe(o.from,s.to)<=0&&Qe(o.to,s.from)>=0)return!0;Qe(s.from,o.from)<0?s=(n=e.next(o.from)).value:o=(a=i.next(s.from)).value}return!1}function Ui(r){let t=ha(r)?null:{s:0,n:r};return{next(e){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Qe(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Qe(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function lo(r){var t,e;const n=(((t=r.r)===null||t===void 0?void 0:t.d)||0)-(((e=r.l)===null||e===void 0?void 0:e.d)||0),s=n>1?"r":n<-1?"l":"";if(s){const i=s==="r"?"l":"r",a={...r},o=r[s];r.from=o.from,r.to=o.to,r[s]=o[s],a[s]=o[i],r[i]=a,a.d=co(a)}r.d=co(r)}function co({r,l:t}){return(r?t?Math.max(r.d,t.d):r.d:t?t.d:0)+1}tn(Vt.prototype,{add(r){return Ls(this,r),this},addKey(r){return Nn(this,r,r),this},addKeys(r){return r.forEach(t=>Nn(this,t,t)),this},[Ci](){return Ui(this)}});const of={stack:"dbcore",level:0,create:r=>{const t=r.schema.name,e=new Vt(r.MIN_KEY,r.MAX_KEY);return{...r,table:n=>{const s=r.table(n),{schema:i}=s,{primaryKey:a}=i,{extractKey:o,outbound:l}=a,u={...s,mutate:m=>{const y=m.trans,$=y.mutatedParts||(y.mutatedParts={}),_=L=>{const I=`idb://${t}/${n}/${L}`;return $[I]||($[I]=new Vt)},S=_(""),x=_(":dels"),{type:E}=m;let[M,j]=m.type==="deleteRange"?[m.range]:m.type==="delete"?[m.keys]:m.values.length<50?[[],m.values]:[];const O=m.trans._cache;return s.mutate(m).then(L=>{if(Ze(M)){E!=="delete"&&(M=L.results),S.addKeys(M);const I=Hl(M,O);I||E==="add"||x.addKeys(M),(I||j)&&function(N,D,V,G){function H(he){const le=N(he.name||"");function xe(ke){return ke!=null?he.extractKey(ke):null}const Ee=ke=>he.multiEntry&&Ze(ke)?ke.forEach(ie=>le.addKey(ie)):le.addKey(ke);(V||G).forEach((ke,ie)=>{const Fe=V&&xe(V[ie]),Re=G&&xe(G[ie]);Qe(Fe,Re)!==0&&(Fe!=null&&Ee(Fe),Re!=null&&Ee(Re))})}D.indexes.forEach(H)}(_,i,I,j)}else if(M){const I={from:M.lower,to:M.upper};x.add(I),S.add(I)}else S.add(e),x.add(e),i.indexes.forEach(I=>_(I.name).add(e));return L})}},c=({query:{index:m,range:y}})=>{var $,_;return[m,new Vt(($=y.lower)!==null&&$!==void 0?$:r.MIN_KEY,(_=y.upper)!==null&&_!==void 0?_:r.MAX_KEY)]},h={get:m=>[a,new Vt(m.key)],getMany:m=>[a,new Vt().addKeys(m.keys)],count:c,query:c,openCursor:c};return Ve(h).forEach(m=>{u[m]=function(y){const{subscr:$}=ee;if($){const _=j=>{const O=`idb://${t}/${n}/${j}`;return $[O]||($[O]=new Vt)},S=_(""),x=_(":dels"),[E,M]=h[m](y);if(_(E.name||"").add(M),!E.isPrimaryKey){if(m!=="count"){const j=m==="query"&&l&&y.values&&s.query({...y,values:!1});return s[m].apply(this,arguments).then(O=>{if(m==="query"){if(l&&y.values)return j.then(({result:I})=>(S.addKeys(I),O));const L=y.values?O.result.map(o):O.result;y.values?S.addKeys(L):x.addKeys(L)}else if(m==="openCursor"){const L=O,I=y.values;return L&&Object.create(L,{key:{get:()=>(x.addKey(L.primaryKey),L.key)},primaryKey:{get(){const N=L.primaryKey;return x.addKey(N),N}},value:{get:()=>(I&&S.addKey(L.primaryKey),L.value)}})}return O})}x.add(e)}}return s[m].apply(this,arguments)}}),u}}}};class Er{constructor(t,e){this._middlewares={},this.verno=0;const n=Er.dependencies;this._options=e={addons:Er.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...e},this._deps={indexedDB:e.indexedDB,IDBKeyRange:e.IDBKeyRange};const{addons:s}=e;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Pe,dbReadyPromise:null,cancelOpen:Pe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a;i.dbReadyPromise=new q(o=>{i.dbReadyResolve=o}),i.openCanceller=new q((o,l)=>{i.cancelOpen=l}),this._state=i,this.name=t,this.on=kn(this,"populate","blocked","versionchange","close",{ready:[ia,Pe]}),this.on.ready.subscribe=_l(this.on.ready.subscribe,o=>(l,u)=>{Er.vip(()=>{const c=this._state;if(c.openComplete)c.dbOpenError||q.resolve().then(l),u&&o(l);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(l),u&&o(l);else{o(l);const h=this;u||o(function m(){h.on.ready.unsubscribe(l),h.on.ready.unsubscribe(m)})}})}),this.Collection=(a=this,vn(Vu.prototype,function(o,l){this.db=a;let u=Kl,c=null;if(l)try{u=l()}catch($){c=$}const h=o._ctx,m=h.table,y=m.hook.reading.fire;this._ctx={table:m,index:h.index,isPrimKey:!h.index||m.schema.primKey.keyPath&&h.index===m.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:h.or,valueMapper:y!==In?y:null}})),this.Table=function(o){return vn(zu.prototype,function(l,u,c){this.db=o,this._tx=c,this.name=l,this.schema=u,this.hook=o._allTables[l]?o._allTables[l].hook:kn(null,{creating:[Pu,Pe],reading:[Tu,In],updating:[Iu,Pe],deleting:[ju,Pe]})})}(this),this.Transaction=function(o){return vn(Hu.prototype,function(l,u,c,h,m){this.db=o,this.mode=l,this.storeNames=u,this.schema=c,this.chromeTransactionDurability=h,this.idbtrans=null,this.on=kn(this,"complete","error","abort"),this.parent=m||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new q((y,$)=>{this._resolve=y,this._reject=$}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},y=>{var $=this.active;return this.active=!1,this.on.error.fire(y),this.parent?this.parent._reject(y):$&&this.idbtrans&&this.idbtrans.abort(),qe(y)})})}(this),this.Version=function(o){return vn(Qu.prototype,function(l){this.db=o,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(o){return vn(zl.prototype,function(l,u,c){this.db=o,this._ctx={table:l,index:u===":id"?null:u,or:c};const h=o._deps.indexedDB;if(!h)throw new oe.MissingAPI;this._cmp=this._ascending=h.cmp.bind(h),this._descending=(m,y)=>h.cmp(y,m),this._max=(m,y)=>h.cmp(m,y)>0?m:y,this._min=(m,y)=>h.cmp(m,y)<0?m:y,this._IDBKeyRange=o._deps.IDBKeyRange})}(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=Mn(e.IDBKeyRange),this._createTransaction=(o,l,u,c)=>new this.Transaction(o,l,u,this._options.chromeTransactionDurability,c),this._fireOnBlocked=o=>{this.on("blocked").fire(o),En.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(o))},this.use(rf),this.use(nf),this.use(of),this.use(sf),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(o=>o(this))}version(t){if(isNaN(t)||t<.1)throw new oe.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new oe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const e=this._versions;var n=e.filter(s=>s._cfg.version===t)[0];return n||(n=new this.Version(t),e.push(n),e.sort(Xu),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||ee.letThrough||this._vip)?t():new q((e,n)=>{if(this._state.openComplete)return n(new oe.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new oe.DatabaseClosed);this.open().catch(Pe)}this._state.dbReadyPromise.then(e,n)}).then(t)}use({stack:t,create:e,level:n,name:s}){s&&this.unuse({stack:t,name:s});const i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:e,level:n??10,name:s}),i.sort((a,o)=>a.level-o.level),this}unuse({stack:t,name:e,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(s=>n?s.create!==n:!!e&&s.name!==e)),this}open(){return ef(this)}_close(){const t=this._state,e=En.indexOf(this);if(e>=0&&En.splice(e,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new q(n=>{t.dbReadyResolve=n}),t.openCanceller=new q((n,s)=>{t.cancelOpen=s})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new oe.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,e=this._state;return new q((n,s)=>{const i=()=>{this.close();var a=this._deps.indexedDB.deleteDatabase(this.name);a.onsuccess=Ie(()=>{(function({indexedDB:o,IDBKeyRange:l},u){!ua(o)&&u!==Gs&&ca(o,l).delete(u).catch(Pe)})(this._deps,this.name),n()}),a.onerror=jt(s),a.onblocked=this._fireOnBlocked};if(t)throw new oe.InvalidArgument("Arguments not allowed in db.delete()");e.isBeingOpened?e.dbReadyPromise.then(i):i()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Ve(this._allTables).map(t=>this._allTables[t])}transaction(){const t=tf.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,e,n){let s=ee.trans;s&&s.db===this&&t.indexOf("!")===-1||(s=null);const i=t.indexOf("?")!==-1;let a,o;t=t.replace("!","").replace("?","");try{if(o=e.map(u=>{var c=u instanceof this.Table?u.name:u;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),t=="r"||t===li)a=li;else{if(t!="rw"&&t!=ci)throw new oe.InvalidArgument("Invalid transaction mode: "+t);a=ci}if(s){if(s.mode===li&&a===ci){if(!i)throw new oe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&o.forEach(u=>{if(s&&s.storeNames.indexOf(u)===-1){if(!i)throw new oe.SubTransaction("Table "+u+" not included in parent transaction.");s=null}}),i&&s&&!s.active&&(s=null)}}catch(u){return s?s._promise(null,(c,h)=>{h(u)}):qe(u)}const l=ql.bind(null,this,a,o,s,n);return s?s._promise(a,l,"lock"):ee.trans?an(ee.transless,()=>this._whenReady(l)):this._whenReady(l)}table(t){if(!pt(this._allTables,t))throw new oe.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const lf=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class cf{constructor(t){this._subscribe=t}subscribe(t,e,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:e,complete:n})}[lf](){return this}}function Wl(r,t){return Ve(t).forEach(e=>{Ls(r[e]||(r[e]=new Vt),t[e])}),r}function uf(r){let t,e=!1;const n=new cf(s=>{const i=ra(r);let a=!1,o={},l={};const u={get closed(){return a},unsubscribe:()=>{a=!0,cr.storagemutated.unsubscribe(y)}};s.start&&s.start(u);let c=!1,h=!1;function m(){return Ve(l).some(_=>o[_]&&af(o[_],l[_]))}const y=_=>{Wl(o,_),m()&&$()},$=()=>{if(c||a)return;o={};const _={},S=function(x){i&&sn();const E=()=>or(r,{subscr:x,trans:null}),M=ee.trans?an(ee.transless,E):E();return i&&M.then(Yt,Yt),M}(_);h||(cr(Dn,y),h=!0),c=!0,Promise.resolve(S).then(x=>{e=!0,t=x,c=!1,a||(m()?$():(o={},l=_,s.next&&s.next(x)))},x=>{c=!1,e=!1,s.error&&s.error(x),u.unsubscribe()})};return $(),u});return n.hasValue=()=>e,n.getValue=()=>t,n}let qi;try{qi={indexedDB:je.indexedDB||je.mozIndexedDB||je.webkitIndexedDB||je.msIndexedDB,IDBKeyRange:je.IDBKeyRange||je.webkitIDBKeyRange}}catch{qi={indexedDB:null,IDBKeyRange:null}}const gr=Er;function Cs(r){let t=qt;try{qt=!0,cr.storagemutated.fire(r)}finally{qt=t}}tn(gr,{...ys,delete:r=>new gr(r,{addons:[]}).delete(),exists:r=>new gr(r,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(r){try{return function({indexedDB:t,IDBKeyRange:e}){return ua(t)?Promise.resolve(t.databases()).then(n=>n.map(s=>s.name).filter(s=>s!==Gs)):ca(t,e).toCollection().primaryKeys()}(gr.dependencies).then(r)}catch{return qe(new oe.MissingAPI)}},defineClass:()=>function(r){nt(this,r)},ignoreTransaction:r=>ee.trans?an(ee.transless,r):r(),vip:Vi,async:function(r){return function(){try{var t=Gi(r.apply(this,arguments));return t&&typeof t.then=="function"?t:q.resolve(t)}catch(e){return qe(e)}}},spawn:function(r,t,e){try{var n=Gi(r.apply(e,t||[]));return n&&typeof n.then=="function"?n:q.resolve(n)}catch(s){return qe(s)}},currentTransaction:{get:()=>ee.trans||null},waitFor:function(r,t){const e=q.resolve(typeof r=="function"?gr.ignoreTransaction(r):r).timeout(t||6e4);return ee.trans?ee.trans.waitFor(e):e},Promise:q,debug:{get:()=>Ot,set:r=>{El(r,r==="dexie"?()=>!0:Rl)}},derive:qr,extend:nt,props:tn,override:_l,Events:kn,on:cr,liveQuery:uf,extendObservabilitySet:Wl,getByKeyPath:Wt,setByKeyPath:kt,delByKeyPath:function(r,t){typeof t=="string"?kt(r,t,void 0):"length"in t&&[].map.call(t,function(e){kt(r,e,void 0)})},shallowClone:wl,deepClone:Gn,getObjectDiff:fa,cmp:Qe,asap:vl,minKey:Di,addons:[],connections:En,errnames:sa,dependencies:qi,semVer:ro,version:ro.split(".").map(r=>parseInt(r)).reduce((r,t,e)=>r+t/Math.pow(10,2*e))}),gr.maxKey=Mn(gr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(cr(Dn,r=>{if(!qt){let t;Vs?(t=document.createEvent("CustomEvent"),t.initCustomEvent(nr,!0,!0,r)):t=new CustomEvent(nr,{detail:r}),qt=!0,dispatchEvent(t),qt=!1}}),addEventListener(nr,({detail:r})=>{qt||Cs(r)}));let qt=!1;if(typeof BroadcastChannel<"u"){const r=new BroadcastChannel(nr);typeof r.unref=="function"&&r.unref(),cr(Dn,t=>{qt||r.postMessage(t)}),r.onmessage=t=>{t.data&&Cs(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){cr(Dn,t=>{try{qt||(typeof localStorage<"u"&&localStorage.setItem(nr,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(e=>e.postMessage({type:nr,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===nr){const e=JSON.parse(t.newValue);e&&Cs(e.changedParts)}});const r=self.document&&navigator.serviceWorker;r&&r.addEventListener("message",function({data:t}){t&&t.type===nr&&Cs(t.changedParts)})}q.rejectionMapper=function(r,t){if(!r||r instanceof Hr||r instanceof TypeError||r instanceof SyntaxError||!r.name||!Qa[r.name])return r;var e=new Qa[r.name](t||r.message,r);return"stack"in r&&Ht(e,"stack",{get:function(){return this.inner.stack}}),e},El(Ot,Rl);class ff extends Er{constructor(){super("letkwet");Q(this,"songs");Q(this,"_meta");this.version(1).stores({songs:"&key,*artists,title",_meta:"last_modified"})}async updateSongs(e,n){const s=this.songs.bulkPut(e);await this._meta.clear();const i=this._meta.add({last_modified:n});return Promise.all([s,i])}}let kr=new ff;function hf(r,t){if(r instanceof RegExp)return{keys:!1,pattern:r};var e,n,s,i,a=[],o="",l=r.split("/");for(l[0]||l.shift();s=l.shift();)e=s[0],e==="*"?(a.push("wild"),o+="/(.*)"):e===":"?(n=s.indexOf("?",1),i=s.indexOf(".",1),a.push(s.substring(1,~n?n:~i?i:s.length)),o+=~n&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(o+=(~n?"?":"")+"\\"+s.substring(i))):o+="/"+s;return{keys:a,pattern:new RegExp("^"+o+(t?"(?=$|/)":"/?$"),"i")}}function df(r){let t,e,n;const s=[r[2]];var i=r[0];function a(o){let l={};for(let u=0;u<s.length;u+=1)l=ml(l,s[u]);return{props:l}}return i&&(t=Es(i,a()),t.$on("routeEvent",r[7])),{c(){t&&et(t.$$.fragment),e=ve()},l(o){t&&bt(t.$$.fragment,o),e=ve()},m(o,l){t&&tt(t,o,l),X(o,e,l),n=!0},p(o,l){const u=l&4?bl(s,[gl(o[2])]):{};if(l&1&&i!==(i=o[0])){if(t){_t();const c=t;be(c.$$.fragment,1,0,()=>{rt(c,1)}),vt()}i?(t=Es(i,a()),t.$on("routeEvent",o[7]),et(t.$$.fragment),ce(t.$$.fragment,1),tt(t,e.parentNode,e)):t=null}else i&&t.$set(u)},i(o){n||(t&&ce(t.$$.fragment,o),n=!0)},o(o){t&&be(t.$$.fragment,o),n=!1},d(o){o&&P(e),t&&rt(t,o)}}}function mf(r){let t,e,n;const s=[{params:r[1]},r[2]];var i=r[0];function a(o){let l={};for(let u=0;u<s.length;u+=1)l=ml(l,s[u]);return{props:l}}return i&&(t=Es(i,a()),t.$on("routeEvent",r[6])),{c(){t&&et(t.$$.fragment),e=ve()},l(o){t&&bt(t.$$.fragment,o),e=ve()},m(o,l){t&&tt(t,o,l),X(o,e,l),n=!0},p(o,l){const u=l&6?bl(s,[l&2&&{params:o[1]},l&4&&gl(o[2])]):{};if(l&1&&i!==(i=o[0])){if(t){_t();const c=t;be(c.$$.fragment,1,0,()=>{rt(c,1)}),vt()}i?(t=Es(i,a()),t.$on("routeEvent",o[6]),et(t.$$.fragment),ce(t.$$.fragment,1),tt(t,e.parentNode,e)):t=null}else i&&t.$set(u)},i(o){n||(t&&ce(t.$$.fragment,o),n=!0)},o(o){t&&be(t.$$.fragment,o),n=!1},d(o){o&&P(e),t&&rt(t,o)}}}function pf(r){let t,e,n,s;const i=[mf,df],a=[];function o(l,u){return l[1]?0:1}return t=o(r),e=a[t]=i[t](r),{c(){e.c(),n=ve()},l(l){e.l(l),n=ve()},m(l,u){a[t].m(l,u),X(l,n,u),s=!0},p(l,[u]){let c=t;t=o(l),t===c?a[t].p(l,u):(_t(),be(a[c],1,1,()=>{a[c]=null}),vt(),e=a[t],e?e.p(l,u):(e=a[t]=i[t](l),e.c()),ce(e,1),e.m(n.parentNode,n))},i(l){s||(ce(e),s=!0)},o(l){be(e),s=!1},d(l){l&&P(n),a[t].d(l)}}}function uo(){const r=window.location.href.indexOf("#/");let t=r>-1?window.location.href.substr(r+1):"/";const e=t.indexOf("?");let n="";return e>-1&&(n=t.substr(e+1),t=t.substr(0,e)),{location:t,querystring:n}}const da=pu(null,function(t){t(uo());const e=()=>{t(uo())};return window.addEventListener("hashchange",e,!1),function(){window.removeEventListener("hashchange",e,!1)}});pl(da,r=>r.location);pl(da,r=>r.querystring);const fo=bu(void 0);function bf(r){r?window.scrollTo(r.__svelte_spa_router_scrollX,r.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function gf(r,t,e){let{routes:n={}}=t,{prefix:s=""}=t,{restoreScrollState:i=!1}=t;class a{constructor(O,L){if(!L||typeof L!="function"&&(typeof L!="object"||L._sveltesparouter!==!0))throw Error("Invalid component object");if(!O||typeof O=="string"&&(O.length<1||O.charAt(0)!="/"&&O.charAt(0)!="*")||typeof O=="object"&&!(O instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:I,keys:N}=hf(O);this.path=O,typeof L=="object"&&L._sveltesparouter===!0?(this.component=L.component,this.conditions=L.conditions||[],this.userData=L.userData,this.props=L.props||{}):(this.component=()=>Promise.resolve(L),this.conditions=[],this.props={}),this._pattern=I,this._keys=N}match(O){if(s){if(typeof s=="string")if(O.startsWith(s))O=O.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const D=O.match(s);if(D&&D[0])O=O.substr(D[0].length)||"/";else return null}}const L=this._pattern.exec(O);if(L===null)return null;if(this._keys===!1)return L;const I={};let N=0;for(;N<this._keys.length;){try{I[this._keys[N]]=decodeURIComponent(L[N+1]||"")||null}catch{I[this._keys[N]]=null}N++}return I}async checkConditions(O){for(let L=0;L<this.conditions.length;L++)if(!await this.conditions[L](O))return!1;return!0}}const o=[];n instanceof Map?n.forEach((j,O)=>{o.push(new a(O,j))}):Object.keys(n).forEach(j=>{o.push(new a(j,n[j]))});let l=null,u=null,c={};const h=zn();async function m(j,O){await iu(),h(j,O)}let y=null,$=null;i&&($=j=>{j.state&&(j.state.__svelte_spa_router_scrollY||j.state.__svelte_spa_router_scrollX)?y=j.state:y=null},window.addEventListener("popstate",$),nu(()=>{bf(y)}));let _=null,S=null;const x=da.subscribe(async j=>{_=j;let O=0;for(;O<o.length;){const L=o[O].match(j.location);if(!L){O++;continue}const I={route:o[O].path,location:j.location,querystring:j.querystring,userData:o[O].userData,params:L&&typeof L=="object"&&Object.keys(L).length?L:null};if(!await o[O].checkConditions(I)){e(0,l=null),S=null,m("conditionsFailed",I);return}m("routeLoading",Object.assign({},I));const N=o[O].component;if(S!=N){N.loading?(e(0,l=N.loading),S=N,e(1,u=N.loadingParams),e(2,c={}),m("routeLoaded",Object.assign({},I,{component:l,name:l.name,params:u}))):(e(0,l=null),S=null);const D=await N();if(j!=_)return;e(0,l=D&&D.default||D),S=N}L&&typeof L=="object"&&Object.keys(L).length?e(1,u=L):e(1,u=null),e(2,c=o[O].props),m("routeLoaded",Object.assign({},I,{component:l,name:l.name,params:u})).then(()=>{fo.set(u)});return}e(0,l=null),S=null,fo.set(void 0)});su(()=>{x(),$&&window.removeEventListener("popstate",$)});function E(j){$i.call(this,r,j)}function M(j){$i.call(this,r,j)}return r.$$set=j=>{"routes"in j&&e(3,n=j.routes),"prefix"in j&&e(4,s=j.prefix),"restoreScrollState"in j&&e(5,i=j.restoreScrollState)},r.$$.update=()=>{r.$$.dirty&32&&(history.scrollRestoration=i?"manual":"auto")},[l,u,c,n,s,i,E,M]}class Yl extends lt{constructor(t){super(),ct(this,t,gf,pf,ot,{routes:3,prefix:4,restoreScrollState:5})}}function ho(r,t,e){const n=r.slice();return n[6]=t[e],n}function mo(r,t,e){const n=r.slice();return n[10]=t[e],n}function po(r){let t,e,n,s,i,a={ctx:r,current:null,token:null,hasCatch:!1,pending:wf,then:_f,catch:yf,value:9};Ut(n=r[1],a);let o={ctx:r,current:null,token:null,hasCatch:!1,pending:Sf,then:Cf,catch:xf,value:5};return Ut(i=r[2],o),{c(){t=W("div"),e=W("div"),a.block.c(),s=$e(),o.block.c(),this.h()},l(l){t=Y(l,"DIV",{class:!0});var u=U(t);e=Y(u,"DIV",{class:!0});var c=U(e);a.block.l(c),s=we(c),o.block.l(c),c.forEach(P),u.forEach(P),this.h()},h(){C(e,"class","shadow border rounded absolute top-0 left-4 right-4 bg-white max-w-lg"),C(t,"class","relative z-10")},m(l,u){X(l,t,u),F(t,e),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=s,F(e,s),o.block.m(e,o.anchor=null),o.mount=()=>e,o.anchor=null},p(l,u){r=l,a.ctx=r,u&2&&n!==(n=r[1])&&Ut(n,a)||Pn(a,r,u),o.ctx=r,u&4&&i!==(i=r[2])&&Ut(i,o)||Pn(o,r,u)},d(l){l&&P(t),a.block.d(),a.token=null,a=null,o.block.d(),o.token=null,o=null}}}function yf(r){return{c:Z,l:Z,m:Z,p:Z,d:Z}}function _f(r){let t,e,n="",s;function i(l,u){return l[9]&&l[9].length>0?$f:vf}let a=i(r),o=a(r);return{c(){t=W("div"),e=W("h3"),e.textContent=n,s=$e(),o.c(),this.h()},l(l){t=Y(l,"DIV",{});var u=U(t);e=Y(u,"H3",{class:!0,["data-svelte-h"]:!0}),yt(e)!=="svelte-1ykeg2m"&&(e.textContent=n),s=we(u),o.l(u),u.forEach(P),this.h()},h(){C(e,"class","text-md font-bold my-4 mx-8")},m(l,u){X(l,t,u),F(t,e),F(t,s),o.m(t,null)},p(l,u){a===(a=i(l))&&o?o.p(l,u):(o.d(1),o=a(l),o&&(o.c(),o.m(t,null)))},d(l){l&&P(t),o.d()}}}function vf(r){let t,e,n,s;return{c(){t=W("div"),e=me('"'),n=me(r[0]),s=me('"  '),this.h()},l(i){t=Y(i,"DIV",{class:!0});var a=U(t);e=pe(a,'"'),n=pe(a,r[0]),s=pe(a,'"  '),a.forEach(P),this.h()},h(){C(t,"class","text-gray-400 px-6 py-4")},m(i,a){X(i,t,a),F(t,e),F(t,n),F(t,s)},p(i,a){a&1&&He(n,i[0])},d(i){i&&P(t)}}}function $f(r){let t,e=Ge(r[9]),n=[];for(let s=0;s<e.length;s+=1)n[s]=bo(mo(r,e,s));return{c(){t=W("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){t=Y(s,"DIV",{class:!0});var i=U(t);for(let a=0;a<n.length;a+=1)n[a].l(i);i.forEach(P),this.h()},h(){C(t,"class","flex flex-col")},m(s,i){X(s,t,i);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(t,null)},p(s,i){if(i&10){e=Ge(s[9]);let a;for(a=0;a<e.length;a+=1){const o=mo(s,e,a);n[a]?n[a].p(o,i):(n[a]=bo(o),n[a].c(),n[a].m(t,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=e.length}},d(s){s&&P(t),It(n,s)}}}function bo(r){let t,e,n=r[10].title+"",s,i,a,o,l,u=r[10].artists.join(", ")+"",c,h,m,y,$;return{c(){t=W("a"),e=me(" "),s=me(n),i=$e(),a=W("br"),o=me(`
              (`),l=W("span"),c=me(u),h=me(`)
              `),this.h()},l(_){t=Y(_,"A",{href:!0,class:!0});var S=U(t);e=pe(S," "),s=pe(S,n),i=we(S),a=Y(S,"BR",{}),o=pe(S,`
              (`),l=Y(S,"SPAN",{class:!0});var x=U(l);c=pe(x,u),x.forEach(P),h=pe(S,`)
              `),S.forEach(P),this.h()},h(){C(l,"class","text-letkwet-600"),C(t,"href",m=`#/song/${r[10].key}`),C(t,"class","border-t py-4 px-6")},m(_,S){X(_,t,S),F(t,e),F(t,s),F(t,i),F(t,a),F(t,o),F(t,l),F(l,c),F(t,h),y||($=ze(t,"click",r[3]),y=!0)},p(_,S){S&2&&n!==(n=_[10].title+"")&&He(s,n),S&2&&u!==(u=_[10].artists.join(", ")+"")&&He(c,u),S&2&&m!==(m=`#/song/${_[10].key}`)&&C(t,"href",m)},d(_){_&&P(t),y=!1,$()}}}function wf(r){return{c:Z,l:Z,m:Z,p:Z,d:Z}}function xf(r){return{c:Z,l:Z,m:Z,p:Z,d:Z}}function Cf(r){let t,e,n="",s;function i(l,u){return l[5]&&l[5].length>0?kf:Ef}let a=i(r),o=a(r);return{c(){t=W("div"),e=W("h3"),e.textContent=n,s=$e(),o.c(),this.h()},l(l){t=Y(l,"DIV",{});var u=U(t);e=Y(u,"H3",{class:!0,["data-svelte-h"]:!0}),yt(e)!=="svelte-acv08w"&&(e.textContent=n),s=we(u),o.l(u),u.forEach(P),this.h()},h(){C(e,"class","text-md font-bold my-4 mx-8")},m(l,u){X(l,t,u),F(t,e),F(t,s),o.m(t,null)},p(l,u){a===(a=i(l))&&o?o.p(l,u):(o.d(1),o=a(l),o&&(o.c(),o.m(t,null)))},d(l){l&&P(t),o.d()}}}function Ef(r){let t,e,n,s;return{c(){t=W("div"),e=me('"'),n=me(r[0]),s=me('"  '),this.h()},l(i){t=Y(i,"DIV",{class:!0});var a=U(t);e=pe(a,'"'),n=pe(a,r[0]),s=pe(a,'"  '),a.forEach(P),this.h()},h(){C(t,"class","text-gray-400 px-6 py-4")},m(i,a){X(i,t,a),F(t,e),F(t,n),F(t,s)},p(i,a){a&1&&He(n,i[0])},d(i){i&&P(t)}}}function kf(r){let t,e=Ge(r[5]),n=[];for(let s=0;s<e.length;s+=1)n[s]=go(ho(r,e,s));return{c(){t=W("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){t=Y(s,"DIV",{class:!0});var i=U(t);for(let a=0;a<n.length;a+=1)n[a].l(i);i.forEach(P),this.h()},h(){C(t,"class","flex flex-col")},m(s,i){X(s,t,i);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(t,null)},p(s,i){if(i&12){e=Ge(s[5]);let a;for(a=0;a<e.length;a+=1){const o=ho(s,e,a);n[a]?n[a].p(o,i):(n[a]=go(o),n[a].c(),n[a].m(t,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=e.length}},d(s){s&&P(t),It(n,s)}}}function go(r){let t,e,n=r[6]+"",s,i,a,o,l;return{c(){t=W("a"),e=me(" "),s=me(n),i=$e(),this.h()},l(u){t=Y(u,"A",{href:!0,class:!0});var c=U(t);e=pe(c," "),s=pe(c,n),i=we(c),c.forEach(P),this.h()},h(){C(t,"href",a=`#/artist/${r[6]}`),C(t,"class","border-t py-4 px-6 text-letkwet-400 font-bold")},m(u,c){X(u,t,c),F(t,e),F(t,s),F(t,i),o||(l=ze(t,"click",r[3]),o=!0)},p(u,c){c&4&&n!==(n=u[6]+"")&&He(s,n),c&4&&a!==(a=`#/artist/${u[6]}`)&&C(t,"href",a)},d(u){u&&P(t),o=!1,l()}}}function Sf(r){return{c:Z,l:Z,m:Z,p:Z,d:Z}}function Af(r){let t,e=r[1]!=null&&r[2]!=null&&po(r);return{c(){e&&e.c(),t=ve()},l(n){e&&e.l(n),t=ve()},m(n,s){e&&e.m(n,s),X(n,t,s)},p(n,[s]){n[1]!=null&&n[2]!=null?e?e.p(n,s):(e=po(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:Z,o:Z,d(n){n&&P(t),e&&e.d(n)}}}function Tf(r,t,e){let{query:n}=t;const s=zn();function i(){s("selected")}let a=null,o=null;return r.$$set=l=>{"query"in l&&e(0,n=l.query)},r.$$.update=()=>{r.$$.dirty&1&&(n.length>1?(e(1,a=kr.songs.where("title").startsWithIgnoreCase(n).limit(10).toArray()),e(2,o=kr.songs.where("artists").startsWithIgnoreCase(n).toArray().then(l=>Object.keys(l.reduce((u,c)=>(c.artists.forEach(h=>u[h]=h),u),{}))))):(e(1,a=null),e(2,o=null)))},[n,a,o,i]}class Pf extends lt{constructor(t){super(),ct(this,t,Tf,Af,ot,{query:0})}}var ps=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var If="Expected a function",Xl="__lodash_hash_undefined__",Zl=1/0,Of="[object Function]",Lf="[object GeneratorFunction]",Df="[object Symbol]",Mf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Nf=/^\w*$/,Ff=/^\./,Rf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Kf=/[\\^$.*+?()[\]{}|]/g,Bf=/\\(\\)?/g,zf=/^\[object .+?Constructor\]$/,Vf=typeof ps=="object"&&ps&&ps.Object===Object&&ps,Gf=typeof self=="object"&&self&&self.Object===Object&&self,ma=Vf||Gf||Function("return this")();function Uf(r,t){return r==null?void 0:r[t]}function qf(r){var t=!1;if(r!=null&&typeof r.toString!="function")try{t=!!(r+"")}catch{}return t}var Hf=Array.prototype,Wf=Function.prototype,Ql=Object.prototype,mi=ma["__core-js_shared__"],yo=function(){var r=/[^.]+$/.exec(mi&&mi.keys&&mi.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Jl=Wf.toString,pa=Ql.hasOwnProperty,ec=Ql.toString,Yf=RegExp("^"+Jl.call(pa).replace(Kf,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_o=ma.Symbol,Xf=Hf.splice,Zf=tc(ma,"Map"),Fn=tc(Object,"create"),vo=_o?_o.prototype:void 0,$o=vo?vo.toString:void 0;function Tr(r){var t=-1,e=r?r.length:0;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}function Qf(){this.__data__=Fn?Fn(null):{}}function Jf(r){return this.has(r)&&delete this.__data__[r]}function eh(r){var t=this.__data__;if(Fn){var e=t[r];return e===Xl?void 0:e}return pa.call(t,r)?t[r]:void 0}function th(r){var t=this.__data__;return Fn?t[r]!==void 0:pa.call(t,r)}function rh(r,t){var e=this.__data__;return e[r]=Fn&&t===void 0?Xl:t,this}Tr.prototype.clear=Qf;Tr.prototype.delete=Jf;Tr.prototype.get=eh;Tr.prototype.has=th;Tr.prototype.set=rh;function on(r){var t=-1,e=r?r.length:0;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}function nh(){this.__data__=[]}function sh(r){var t=this.__data__,e=Us(t,r);if(e<0)return!1;var n=t.length-1;return e==n?t.pop():Xf.call(t,e,1),!0}function ih(r){var t=this.__data__,e=Us(t,r);return e<0?void 0:t[e][1]}function ah(r){return Us(this.__data__,r)>-1}function oh(r,t){var e=this.__data__,n=Us(e,r);return n<0?e.push([r,t]):e[n][1]=t,this}on.prototype.clear=nh;on.prototype.delete=sh;on.prototype.get=ih;on.prototype.has=ah;on.prototype.set=oh;function Ir(r){var t=-1,e=r?r.length:0;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}function lh(){this.__data__={hash:new Tr,map:new(Zf||on),string:new Tr}}function ch(r){return qs(this,r).delete(r)}function uh(r){return qs(this,r).get(r)}function fh(r){return qs(this,r).has(r)}function hh(r,t){return qs(this,r).set(r,t),this}Ir.prototype.clear=lh;Ir.prototype.delete=ch;Ir.prototype.get=uh;Ir.prototype.has=fh;Ir.prototype.set=hh;function Us(r,t){for(var e=r.length;e--;)if(xh(r[e][0],t))return e;return-1}function dh(r,t){t=gh(t,r)?[t]:bh(t);for(var e=0,n=t.length;r!=null&&e<n;)r=r[$h(t[e++])];return e&&e==n?r:void 0}function mh(r){if(!nc(r)||_h(r))return!1;var t=Ch(r)||qf(r)?Yf:zf;return t.test(wh(r))}function ph(r){if(typeof r=="string")return r;if(ga(r))return $o?$o.call(r):"";var t=r+"";return t=="0"&&1/r==-Zl?"-0":t}function bh(r){return rc(r)?r:vh(r)}function qs(r,t){var e=r.__data__;return yh(t)?e[typeof t=="string"?"string":"hash"]:e.map}function tc(r,t){var e=Uf(r,t);return mh(e)?e:void 0}function gh(r,t){if(rc(r))return!1;var e=typeof r;return e=="number"||e=="symbol"||e=="boolean"||r==null||ga(r)?!0:Nf.test(r)||!Mf.test(r)||t!=null&&r in Object(t)}function yh(r){var t=typeof r;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?r!=="__proto__":r===null}function _h(r){return!!yo&&yo in r}var vh=ba(function(r){r=kh(r);var t=[];return Ff.test(r)&&t.push(""),r.replace(Rf,function(e,n,s,i){t.push(s?i.replace(Bf,"$1"):n||e)}),t});function $h(r){if(typeof r=="string"||ga(r))return r;var t=r+"";return t=="0"&&1/r==-Zl?"-0":t}function wh(r){if(r!=null){try{return Jl.call(r)}catch{}try{return r+""}catch{}}return""}function ba(r,t){if(typeof r!="function"||t&&typeof t!="function")throw new TypeError(If);var e=function(){var n=arguments,s=t?t.apply(this,n):n[0],i=e.cache;if(i.has(s))return i.get(s);var a=r.apply(this,n);return e.cache=i.set(s,a),a};return e.cache=new(ba.Cache||Ir),e}ba.Cache=Ir;function xh(r,t){return r===t||r!==r&&t!==t}var rc=Array.isArray;function Ch(r){var t=nc(r)?ec.call(r):"";return t==Of||t==Lf}function nc(r){var t=typeof r;return!!r&&(t=="object"||t=="function")}function Eh(r){return!!r&&typeof r=="object"}function ga(r){return typeof r=="symbol"||Eh(r)&&ec.call(r)==Df}function kh(r){return r==null?"":ph(r)}function Sh(r,t,e){var n=r==null?void 0:dh(r,t);return n===void 0?e:n}var Ah=Sh;const Th=jf(Ah);function pi(r,t,e){return e=e||" ",r.length>t?r:(t-=r.length,e+=e.repeat(t),r+e.slice(0,t))}class Yr extends Error{static buildMessage(t,e){function n(u){return u.charCodeAt(0).toString(16).toUpperCase()}function s(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function i(u){return u.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function a(u){switch(u.type){case"literal":return'"'+s(u.text)+'"';case"class":const c=u.parts.map(h=>Array.isArray(h)?i(h[0])+"-"+i(h[1]):i(h));return"["+(u.inverted?"^":"")+c+"]";case"any":return"any character";case"end":return"end of input";case"other":return u.description}}function o(u){const c=u.map(a);let h,m;if(c.sort(),c.length>0){for(h=1,m=1;h<c.length;h++)c[h-1]!==c[h]&&(c[m]=c[h],m++);c.length=m}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}function l(u){return u?'"'+s(u)+'"':"end of input"}return"Expected "+o(t)+" but "+l(e)+" found."}constructor(t,e,n,s){super(),this.message=t,this.expected=e,this.found=n,this.location=s,this.name="PeggySyntaxError",typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(this,Yr.prototype):this.__proto__=Yr.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Yr)}format(t){let e="Error: "+this.message;if(this.location){let n=null,s;for(s=0;s<t.length;s++)if(t[s].grammarSource===this.location.source){n=t[s].text.split(/\r\n|\n|\r/g);break}let i=this.location.start,a=this.location.source+":"+i.line+":"+i.column;if(n){let o=this.location.end,l=pi("",i.line.toString().length," "),u=n[i.line-1],c=i.line===o.line?o.column:u.length+1;e+=`
 --> `+a+`
`+l+` |
`+i.line+" | "+u+`
`+l+" | "+pi("",i.column-1," ")+pi("",c-i.column,"^")}else e+=`
 at `+a}return e}}function Ph(r,t){t=t!==void 0?t:{};const e={},n=t.grammarSource,s={Chord:mr};let i=mr;const a=function(w){return{type:"chord",...w,column:Or().start.column}},o="#",l=Ne("#",!1),u="b",c=Ne("b",!1),h=/^[a-zA-Z0-9()#+]/,m=fr([["a","z"],["A","Z"],["0","9"],"(",")","#","+"],!1,!1),y=function(w,B,R,te){return{base:w,modifier:B,suffix:R,...te,chordType:"symbol"}},$=/^[A-Ga-g]/,_=fr([["A","G"],["a","g"]],!1,!1),S="/",x=Ne("/",!1),E=function(w,B){return{bassBase:w,bassModifier:B}},M=function(w,B,R,te){return{base:B,modifier:w,suffix:R,...te,chordType:"numeral"}},j="III",O=Ne("III",!1),L="iii",I=Ne("iii",!1),N="VII",D=Ne("VII",!1),V="vii",G=Ne("vii",!1),H="II",he=Ne("II",!1),le="ii",xe=Ne("ii",!1),Ee="IV",ke=Ne("IV",!1),ie="iv",Fe=Ne("iv",!1),Re="VI",Me=Ne("VI",!1),ut="vi",$t=Ne("vi",!1),Lt="I",fe=Ne("I",!1),Te="i",We=Ne("i",!1),Dt="V",gt=Ne("V",!1),Xt="v",Zt=Ne("v",!1),St=function(w,B){return{bassBase:B,bassModifier:w}},st=function(w,B,R,te){return{base:B,modifier:w,suffix:R,...te,chordType:"numeric"}},wt=/^[1-7]/,Qt=fr([["1","7"]],!1,!1);let K=0,ft=0;const Mt=[{line:1,column:1}];let it=0,ur=[],Nt;if(t.startRule!==void 0){if(!(t.startRule in s))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');i=s[t.startRule]}function Or(){return dr(ft,K)}function Ne(w,B){return{type:"literal",text:w,ignoreCase:B}}function fr(w,B,R){return{type:"class",parts:w,inverted:B,ignoreCase:R}}function Lr(){return{type:"end"}}function hr(w){let B=Mt[w],R;if(B)return B;for(R=w-1;!Mt[R];)R--;for(B=Mt[R],B={line:B.line,column:B.column};R<w;)r.charCodeAt(R)===10?(B.line++,B.column=1):B.column++,R++;return Mt[w]=B,B}function dr(w,B){const R=hr(w),te=hr(B);return{source:n,start:{offset:w,line:R.line,column:R.column},end:{offset:B,line:te.line,column:te.column}}}function Se(w){K<it||(K>it&&(it=K,ur=[]),ur.push(w))}function ln(w,B,R){return new Yr(Yr.buildMessage(w,B),w,B,R)}function mr(){let w,B;return w=K,B=un(),B===e&&(B=v(),B===e&&(B=pr())),B!==e&&(ft=w,B=a(B)),w=B,w}function xt(){let w;return r.charCodeAt(K)===35?(w=o,K++):(w=e,Se(l)),w===e&&(r.charCodeAt(K)===98?(w=u,K++):(w=e,Se(c))),w}function Jt(){let w,B;for(w=[],h.test(r.charAt(K))?(B=r.charAt(K),K++):(B=e,Se(m));B!==e;)w.push(B),h.test(r.charAt(K))?(B=r.charAt(K),K++):(B=e,Se(m));return w}function pr(){let w,B,R,te,_e;return w=K,B=br(),B!==e?(R=xt(),R===e&&(R=null),R!==e?(te=K,_e=Jt(),_e!==e?te=r.substring(te,K):te=_e,te!==e?(_e=cn(),_e===e&&(_e=null),_e!==e?(ft=w,B=y(B,R,te,_e),w=B):(K=w,w=e)):(K=w,w=e)):(K=w,w=e)):(K=w,w=e),w}function br(){let w;return $.test(r.charAt(K))?(w=r.charAt(K),K++):(w=e,Se(_)),w}function cn(){let w,B,R,te;return w=K,r.charCodeAt(K)===47?(B=S,K++):(B=e,Se(x)),B!==e?(R=br(),R!==e?(te=xt(),te===e&&(te=null),te!==e?(ft=w,B=E(R,te),w=B):(K=w,w=e)):(K=w,w=e)):(K=w,w=e),w}function un(){let w,B,R,te,_e;return w=K,B=xt(),B===e&&(B=null),B!==e?(R=Dr(),R!==e?(te=K,_e=Jt(),_e!==e?te=r.substring(te,K):te=_e,te!==e?(_e=fn(),_e===e&&(_e=null),_e!==e?(ft=w,B=M(B,R,te,_e),w=B):(K=w,w=e)):(K=w,w=e)):(K=w,w=e)):(K=w,w=e),w}function Dr(){let w;return r.substr(K,3)===j?(w=j,K+=3):(w=e,Se(O)),w===e&&(r.substr(K,3)===L?(w=L,K+=3):(w=e,Se(I)),w===e&&(r.substr(K,3)===N?(w=N,K+=3):(w=e,Se(D)),w===e&&(r.substr(K,3)===V?(w=V,K+=3):(w=e,Se(G)),w===e&&(r.substr(K,2)===H?(w=H,K+=2):(w=e,Se(he)),w===e&&(r.substr(K,2)===le?(w=le,K+=2):(w=e,Se(xe)),w===e&&(r.substr(K,2)===Ee?(w=Ee,K+=2):(w=e,Se(ke)),w===e&&(r.substr(K,2)===ie?(w=ie,K+=2):(w=e,Se(Fe)),w===e&&(r.substr(K,2)===Re?(w=Re,K+=2):(w=e,Se(Me)),w===e&&(r.substr(K,2)===ut?(w=ut,K+=2):(w=e,Se($t)),w===e&&(r.charCodeAt(K)===73?(w=Lt,K++):(w=e,Se(fe)),w===e&&(r.charCodeAt(K)===105?(w=Te,K++):(w=e,Se(We)),w===e&&(r.charCodeAt(K)===86?(w=Dt,K++):(w=e,Se(gt)),w===e&&(r.charCodeAt(K)===118?(w=Xt,K++):(w=e,Se(Zt))))))))))))))),w}function fn(){let w,B,R,te;return w=K,r.charCodeAt(K)===47?(B=S,K++):(B=e,Se(x)),B!==e?(R=xt(),R===e&&(R=null),R!==e?(te=Dr(),te!==e?(ft=w,B=St(R,te),w=B):(K=w,w=e)):(K=w,w=e)):(K=w,w=e),w}function v(){let w,B,R,te,_e;return w=K,B=xt(),B===e&&(B=null),B!==e?(R=de(),R!==e?(te=K,_e=Jt(),_e!==e?te=r.substring(te,K):te=_e,te!==e?(_e=Ft(),_e===e&&(_e=null),_e!==e?(ft=w,B=st(B,R,te,_e),w=B):(K=w,w=e)):(K=w,w=e)):(K=w,w=e)):(K=w,w=e),w}function de(){let w;return wt.test(r.charAt(K))?(w=r.charAt(K),K++):(w=e,Se(Qt)),w}function Ft(){let w,B,R,te;return w=K,r.charCodeAt(K)===47?(B=S,K++):(B=e,Se(x)),B!==e?(R=xt(),R===e&&(R=null),R!==e?(te=de(),te!==e?(ft=w,B=St(R,te),w=B):(K=w,w=e)):(K=w,w=e)):(K=w,w=e),w}if(Nt=i(),Nt!==e&&K===r.length)return Nt;throw Nt!==e&&K<r.length&&Se(Lr()),ln(ur,it<r.length?r.charAt(it):null,it<r.length?dr(it,it+1):dr(it,it))}const jh=Ph,Pr="verse",ir="chorus",ar="none",ya="indeterminate",Hi="tab",Xr="symbol",Zr="numeric",$r="numeral",Wi=["I","II","III","IV","V","VI","VII"],Ih="A".charCodeAt(0),Oh="G".charCodeAt(0),wo={1:0,2:2,3:4,4:5,5:7,6:9,7:11},xo={1:0,2:2,3:3,4:5,5:7,6:8,7:11};function Lh(r){return r.toUpperCase().charCodeAt(0)}function Co(r,t,e){let n=r;return n<t?n+=7:n>e&&(n-=7),n}function Dh(r){for(let t=0,e=Wi.length;t<e;t+=1){const n=Wi[t];if(n===r||n.toLowerCase()===r)return t+1}return null}function Mh(r){return Wi[r-1]}class Gr{constructor({note:t,type:e,minor:n=!1}){Q(this,"minor",!1);this._note=t,this.type=e,this.minor=n}static parse(t){const e=t.toString();if(/^[A-Ga-g]$/.test(e))return new Gr({note:e.toUpperCase(),type:Xr});if(/^[1-7]$/.test(e))return new Gr({note:parseInt(e,10),type:Zr});const n=Dh(e);if(n)return new Gr({note:n,type:$r,minor:e.toLowerCase()===t});throw new Error(`Invalid note ${t}`)}toNumeral(){if(this.isNumeral())return this.clone();if(this.isNumeric())return this.set({type:$r});throw new Error(`Converting a ${this.type} note to numeral is not supported`)}toNumeric(){if(this.isNumeric())return this.clone();if(this.isNumeral())return this.set({type:Zr});throw new Error(`Converting a ${this.type} note to numeric is not supported`)}isMinor(){return this.minor}equals(t){return this._note===t._note&&this.type===t.type&&this.minor===t.minor}clone(){return this.set({})}up(){return this.change(1)}down(){return this.change(-1)}isOneOf(...t){return t.includes(this._note)}isNumeric(){return this.is(Zr)}isChordSymbol(){return this.is(Xr)}isNumeral(){return this.is($r)}is(t){return this.type===t}getTransposeDistance(t){if(typeof this._note=="number"){if(t&&this._note in xo)return xo[this._note];if(this._note in wo)return wo[this._note]}return 0}change(t){if(this.isChordSymbol()){let n;return n=Lh(this._note),n+=t,n=Co(n,Ih,Oh),this.set({note:String.fromCharCode(n)})}let e=Co(this._note+t,1,7);return e<1?e+=7:e>7&&(e-=7),this.set({note:e})}get note(){if(this.isNumeral()){const t=Mh(this._note);return this.isMinor()?t.toLowerCase():t}return this._note}toString(){const t=this.note;switch(this.type){case $r:return`${this.minor?t.toLowerCase():t.toUpperCase()}`;default:return`${this.note}`}}set(t){return new Gr({note:this._note,type:this.type,minor:this.minor,...t})}}var Eo=Gr;const Nh={Ab:{B:"Cb"},Cb:{B:"Cb","A#":"Bb",E:"Fb"},C:{"C#":"Db","D#":"Eb","F#":"Gb","G#":"Ab","A#":"Bb"},"C#":{Eb:"D#",Bb:"A#"},Db:{B:"Cb","F#":"Gb"},D:{"D#":"Eb","A#":"Bb",Gb:"F#"},Eb:{"D#":"Eb","F#":"Gb","G#":"Ab","A#":"Bb"},E:{Ab:"G#","A#":"Bb","D#":"Eb",Db:"C#",Eb:"D#"},F:{"A#":"Bb","F#":"Gb","C#":"Db","D#":"Eb","G#":"Ab"},"F#":{Bb:"A#",Eb:"D#"},Gb:{"A#":"Bb","D#":"Eb","G#":"Ab",B:"Cb",E:"Fb"},G:{"A#":"Bb","D#":"Eb","G#":"Ab","C#":"Db"},"G#":{"A#":"Bb","D#":"Eb",Cb:"B#"},Am:{Gb:"G","G#":"Ab","F#":"Gb","C#":"Db","D#":"Eb","A#":"Bb"},Bbm:{Cb:"B",Gb:"F#"},Bm:{"A#":"Bb","D#":"Eb"},"C#m":{"A#":"Bb","D#":"Eb",Gb:"F#"},Cm:{"G#":"Ab","A#":"Bb","D#":"Eb","F#":"Gb","C#":"Db"},Dm:{"A#":"Bb","D#":"Eb","F#":"Gb","G#":"Ab","C#":"Db"},Em:{"A#":"Bb","D#":"Eb","C#":"Db"},"F#m":{"A#":"Bb","D#":"Eb",Gb:"F#",Ab:"G#",Db:"C#"},Fm:{"G#":"Ab","A#":"Bb","D#":"Eb","F#":"Gb","C#":"Db"},Gm:{"G#":"Ab","A#":"Bb","D#":"Eb","C#":"Db","F#":"Gb"},"G#m":{"A#":"Bb","D#":"Eb"},B:{Eb:"D#"}};var Fh=Nh;const sc=r=>r.items.some(t=>t instanceof Je&&!!t.chords),_a=r=>"evaluate"in r&&typeof r.evaluate=="function",ko=(r,t)=>{let e=r;for(let n=r.length;n<t;n+=1,e+=" ");return e};function Rh(r){return r.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function Kh(r,t=""){return Object.entries(r).map(([e,n])=>{const s=Object.entries(n).map(([a,o])=>`${Rh(a)}: ${o};`).join(`
  `);return`
${`${t} ${e}`.trim()} {
  ${s}
}`.substring(1)}).join(`

`)}function ic(r){try{throw new Error(`DEPRECATION: ${r}`)}catch(t){const e=t,n=globalThis.process;typeof n=="object"&&typeof n.emitWarning=="function"?n.emitWarning(`${r}
${e.stack}`):console.warn(`${r}
${e.stack}`)}}function So(r){throw new Error(`BREAKING CHANGE: ${r}`)}function Hs(r){return r==null||r===""}function Bh(r){return typeof r!="string"?!1:r[0]==="m"&&r.substring(0,3).toLowerCase()!=="maj"}function ac(r){return r.replace(/\r\n?/g,`
`)}const Bt="b",zt="#",zh=/^(?<note>[A-G])(?<modifier>#|b)?(?<minor>m)?$/i,Vh=/^(?<modifier>#|b)?(?<note>[1-7])(?<minor>m)?$/,Gh=/^(?<modifier>#|b)?(?<note>I{1,3}|IV|VI{0,2}|i{1,3}|iv|vi{0,2})$/,Ao=[zh,Vh,Gh];function Uh(r){switch(r){case zt:return 1;case Bt:return-1;default:return 0}}class Pt{constructor({note:t,modifier:e=null,minor:n=!1}){Q(this,"modifier",null);Q(this,"minor",!1);this.note=t instanceof Eo?t:Eo.parse(t),this.modifier=e||null,this.minor=n||!1,this.minor&&(this.note.minor=!0)}get unicodeModifier(){switch(this.modifier){case Bt:return"";case zt:return"";default:return null}}static parse(t){if(!t||Hs(t))return null;for(let e=0,n=Ao.length;e<n;e+=1){const s=t.match(Ao[e]);if(s){const{note:i,modifier:a,minor:o}=s.groups;return new Pt({note:i,modifier:a,minor:!!o})}}return null}static parseOrFail(t){const e=this.parse(t);if(!e)throw new Error(`Failed to parse ${t}`);return e}static wrap(t){return t instanceof Pt?t:this.parse(t)}static wrapOrFail(t=null){if(t===null)throw new Error("Unexpected null key");const e=this.wrap(t);if(e===null)throw new Error(`Failed: invalid key ${t}`);return e}static toString(t){return`${Pt.wrapOrFail(t)}`}static distance(t,e){return this.wrapOrFail(t).distanceTo(e)}distanceTo(t){const e=Pt.wrapOrFail(t);let n=this.useModifier(e.modifier),s=0;for(;!n.equals(e)&&s<20;)n=n.transposeUp().useModifier(e.modifier),s+=1;return s}isMinor(){return this.minor||this.note.isMinor()}clone(){return this.set({})}toChordSymbol(t){if(this.is(Xr))return this.clone();const e=this.note.getTransposeDistance(t.minor)+Uh(this.modifier);return t.transpose(e).normalize().useModifier(t.modifier)}toChordSymbolString(t){return this.toChordSymbol(t).toString()}is(t){return this.note.is(t)}isNumeric(){return this.is(Zr)}isChordSymbol(){return this.is(Xr)}isNumeral(){return this.is($r)}equals(t){return this.note.equals(t.note)&&this.modifier===t.modifier}toNumeric(t=null){if(this.isNumeric())return this.clone();if(this.isNumeral())return this.set({note:this.note.toNumeric()});if(!t)throw new Error("key is required");return this.transposeNoteUpToKey(1,t)}toNumericString(t=null){return this.toNumeric(t).toString()}toNumeral(t=null){return this.isNumeral()?this.clone():this.isNumeric()?this.set({note:this.note.toNumeral()}):t?this.transposeNoteUpToKey("I",t):this.clone()}toNumeralString(t=null){return this.toNumeral(t).toString()}toString({showMinor:t=!0,useUnicodeModifier:e=!1}={}){switch(this.note.type){case Xr:return this.formatChordSymbolString(t,e);case Zr:return this.formatNumericString(t);case $r:return this.formatNumeralString();default:throw new Error(`Unexpected note type ${this.note.type}`)}}formatChordSymbolString(t,e){const n=e?this.unicodeModifier:this.modifier;return`${this.note}${n||""}${this.minor&&t?"m":""}`}formatNumericString(t){return`${this.modifier||""}${this.note}${this.minor&&t?"m":""}`}formatNumeralString(){return`${this.modifier||""}${this.note}`}transpose(t){if(t===0)return this;const e=this.modifier;let n=this.clone();const s=t<0?"transposeDown":"transposeUp";for(let i=0,a=Math.abs(t);i<a;i+=1)n=n[s]();return n.useModifier(e)}transposeUp(){return this.modifier===Bt?this.set({modifier:null}):this.note.isOneOf(3,7,"E","B")?this.set({note:this.note.up()}):this.modifier===zt?this.set({note:this.note.up(),modifier:null}):this.set({modifier:zt})}transposeDown(){return this.modifier===zt?this.set({modifier:null}):this.note.isOneOf(1,4,"C","F")?this.set({note:this.note.down()}):this.modifier===Bt?this.set({note:this.note.down(),modifier:null}):this.set({modifier:Bt})}useModifier(t){return this.modifier===Bt&&t===zt?this.set({note:this.note.down(),modifier:zt}):this.modifier===zt&&t===Bt?this.set({note:this.note.up(),modifier:Bt}):this.clone()}normalize(){return this.modifier===zt&&this.note.isOneOf(3,7,"E","B")?this.set({note:this.note.up(),modifier:null}):this.modifier===Bt&&this.note.isOneOf(1,4,"C","F")?this.set({note:this.note.down(),modifier:null}):this.clone()}removeMinor(){return this.set({minor:!1})}normalizeEnharmonics(t){if(t){const e=Pt.wrapOrFail(t).toString({showMinor:!0}),n=Fh[e],s=this.toString({showMinor:!1});if(n&&n[s])return Pt.parseOrFail(n[s])}return this.clone()}set(t){return new Pt({note:this.note.clone(),modifier:this.modifier,minor:this.minor,...t})}transposeNoteUpToKey(t,e){let n=new Pt({note:t}),s=e.clone();const i=this.clone().normalize().useModifier(e.modifier).normalizeEnharmonics(e);for(;!s.equals(i);)n=n.transposeUp().useModifier(e.modifier),s=s.transposeUp().normalize().useModifier(e.modifier).normalizeEnharmonics(e);return n}}var Et=Pt;const qh={2:"2",4:"sus",5:"5",6:"6",7:"7",9:"9",11:"11",13:"13",42:"4(2)",69:"6(9)","(#4)":"(#4)","#4":"(#4)","+4":"(#4)","(+4)":"(#4)","(11)":"(11)",add11:"(11)","(add11)":"(11)","(13)":"(13)",add13:"(13)","(add13)":"(13)","(2)":"(2)",add2:"(2)","(add2)":"(2)","(4)":"(4)",add4:"(4)","(add4)":"(4)","sus(4)":"(4)","(6)":"(6)",add6:"(6)","(add6)":"(6)","(7)":"(7)","(9)":"(9)",add9:"(9)","(add9)":"(9)","(b5)":"(b5)","-5":"(b5)","(-5)":"(b5)",b5:"(b5)","2(6)":"2(6)","(b6)":"(b6)","(unis)":"(unis)",unis:"(unis)","[blank]":"[blank]",maj:"[blank]",major:"[blank]",M:"[blank]",ma:"[blank]",Ma:"[blank]",Majj:"[blank]","+":"+",aug:"+","(#5)":"+","#5":"+","+5":"+","(+5)":"+",x:"+",dom11:"11","dom 11":"11","11(#5)":"11(#5)","11#5":"11(#5)","11+5":"11(#5)","11(+5)":"11(#5)","11(#9)":"11(#9)","11#9":"11(#9)","11+9":"11(#9)","11(+9)":"11(#9)","11(b13)":"11(b13)","11b13":"11(b13)","11-13":"11(b13)","11(-13)":"11(b13)","11(b5)":"11(b5)","11b5":"11(b5)","11-5":"11(b5)","11(-5)":"11(b5)","11(b9)":"11(b9)","11b9":"11(b9)","11-9":"11(b9)","11(-9)":"11(b9)","11sus4":"11sus4","11sus":"11sus4",m11sus4:"11sus4",m11sus:"11sus4",dom13:"13","dom 13":"13","13(#11)":"13(#11)","13#11":"13(#11)","13+11":"13(#11)","13(+11)":"13(#11)","13(#5)":"13(#5)","13#5":"13(#5)","13+5":"13(#5)","13(+5)":"13(#5)","13(#9)":"13(#9)","13#9":"13(#9)","13(+9)":"13(#9)","13+9":"13(#9)","13(#9#5)":"13(#9#5)","13#9#5":"13(#9#5)","13(+9+5)":"13(#9#5)","13+9+5":"13(#9#5)","13(#9b5)":"13(#9b5)","13#9b5":"13(#9b5)","13(+9-5)":"13(#9b5)","13+9-5":"13(#9b5)","13(add4)":"13(add4)","13(b5)":"13(b5)","13b5":"13(b5)","13-5":"13(b5)","13(-5)":"13(b5)","13(b9)":"13(b9)","13b9":"13(b9)","13-9":"13(b9)","13(-9)":"13(b9)","13(b9#5)":"13(b9#5)","13b9#5":"13(b9#5)","13-9+5":"13(b9#5)","13(-9+5)":"13(b9#5)","13(b9b5)":"13(b9b5)","13b9b5":"13(b9b5)","13-9-5":"13(b9b5)","13(-9-5)":"13(b9b5)","13sus4":"13sus4","13sus":"13sus4",m13sus4:"13sus4",m13sus:"13sus4",sus2:"2","add9(no3)":"2","2(#11)":"2(#11)","2(#4)":"2(#4)","2+4":"2(#4)","2#4":"2(#4)","2(+4)":"2(#4)","(#4)2":"2(#4)","2(#4)(#42)(2#4)":"2(#4)(#42)(2#4)","2(+7)":"2(+7)","2(4)":"2(4)","sus2(4)":"2(4)","2(ma7)":"2(ma7)","2(no3)":"2(no3)","4(2)":"4(2)",sus42:"4(2)",no3:"5","(no3)":"5","(no 3)":"5","(no 3rd)":"5","5(no3)":"5","6(2)":"6(2)","6(b9)":"6(b9)","6(no3)":"6(no3)","6(9)":"6(9)","6(add9)":"6(9)",dom7:"7","dom 7":"7","dom 7th":"7","7(#11)":"7(#11)","7#11":"7(#11)","7+11":"7(#11)","7(+11)":"7(#11)","7(#5)":"7(#5)",aug7:"7(#5)","7#5":"7(#5)","7+5":"7(#5)","7(+5)":"7(#5)",x7:"7(#5)","aug 7":"7(#5)","aug 7th":"7(#5)","7(#5#11)":"7(#5#11)","7#5#11":"7(#5#11)","7+5+11":"7(#5#11)","7(+5+11)":"7(#5#11)","7(#9)":"7(#9)","7#9":"7(#9)","7+9":"7(#9)","7(+9)":"7(#9)","7(#9#5)":"7(#9#5)","7(#5#9)":"7(#9#5)","7#5#9":"7(#9#5)","7+5+9":"7(#9#5)","7(+5+9)":"7(#9#5)","7(#9b13)":"7(#9b13)","7#9b13":"7(#9b13)","7(+9-13)":"7(#9b13)","7+9-13":"7(#9b13)","7(b13#9)":"7(#9b13)","7b13#9":"7(#9b13)","7-13+9":"7(#9b13)","7(-13+9)":"7(#9b13)","7(#9b5)":"7(#9b5)","7(6)":"7(6)","7(b13)":"7(b13)","7b13":"7(b13)","7-13":"7(b13)","7(-13)":"7(b13)","7(b5)":"7(b5)","7b5":"7(b5)","7-5":"7(b5)","7(-5)":"7(b5)","7(b5#11)":"7(b5#11)","7b5#11":"7(b5#11)","7-5+11":"7(b5#11)","7(-5+11)":"7(b5#11)","7(b5#9)":"7(b5#9)","7b5#9":"7(b5#9)","7-5+9":"7(b5#9)","7(-5+9)":"7(b5#9)","7(b5b9)":"7(b5b9)","7b5b9":"7(b5b9)","7-5-9":"7(b5b9)","7(-5-9)":"7(b5b9)","7(b9)":"7(b9)","7b9":"7(b9)","7-9":"7(b9)","7(-9)":"7(b9)","7(b9#5)":"7(b9#5)","7(#5b9)":"7(b9#5)","7#5b9":"7(b9#5)","7+5-9":"7(b9#5)","7(+5-9)":"7(b9#5)","7(b9b13)":"7(b9b13)","7b9b13":"7(b9b13)","7-9-13":"7(b9b13)","7(-9-13)":"7(b9b13)","7(b13b9)":"7(b9b13)","7b13b9":"7(b9b13)","7-13-9":"7(b9b13)","7(-13-9)":"7(b9b13)","7(b9b5)":"7(b9b5)","7(no3)":"7(no3)","7aug5":"7aug5","7b9sus4":"7b9sus4","7sus(6)":"7sus(6)","7sus(b9)":"7sus(b9)","7sus4":"7sus4","7sus":"7sus4",dom9:"9","dom 9":"9","9(#11)":"9(#11)","9#11":"9(#11)","9+11":"9(#11)","9(+11)":"9(#11)","9(#5)":"9(#5)","9#5":"9(#5)","9+5":"9(#5)","9(+5)":"9(#5)",aug9:"9(#5)",x9:"9(#5)","9(b13)":"9(b13)","9b13":"9(b13)","9-13":"9(b13)","9(-13)":"9(b13)","9(b5)":"9(b5)","9b5":"9(b5)","9-5":"9(b5)","9(-5)":"9(b5)","9aug":"9aug","9sus4":"9sus4","9sus":"9sus4",m9sus4:"9sus4",m9sus:"9sus4","b69(#11)":"b69(#11)",b69sus:"b69sus",b9sus:"b9sus",dim:"dim","m(b5)":"dim",mb5:"dim","m-5":"dim","m(-5)":"dim","-(b5)":"dim","-b5":"dim",dim7:"dim7",o7:"dim7","dim 7":"dim7","dim 7th":"dim7",m:"m",mi:"m",min:"m",minor:"m","-":"m","m(11)":"m(11)","m(add11)":"m(11)","m(4)":"m(4)","m(add4)":"m(4)","m(9)":"m(9)","m(add9)":"m(9)","m(ma7)":"m(ma7)","m(M7)":"m(ma7)","mi(maj7)":"m(ma7)","min(maj7)":"m(ma7)","m(maj7)":"m(ma7)","m(+7)":"m(ma7)","m+7":"m(ma7)","m(ma9)":"m(ma9)","m(M9)":"m(ma9)","mi(maj9)":"m(ma9)","min(maj9)":"m(ma9)","m(maj9)":"m(ma9)","m(+9)":"m(ma9)","m+9":"m(ma9)","m(no5)":"m(no5)",m11:"m11",mi11:"m11",min11:"m11","-11":"m11","m11(#5)":"m11(#5)","m11#5":"m11(#5)","m11+5":"m11(#5)","m11(+5)":"m11(#5)","-11(#5)":"m11(#5)","-11#5":"m11(#5)","m9+5":"m9(#5)","-11(+5)":"m11(#5)","m11(#9)":"m11(#9)","m11#9":"m11(#9)","m11+9":"m11(#9)","m11(+9)":"m11(#9)","-11(#9)":"m11(#9)","-11#9":"m11(#9)","-11+9":"m11(#9)","-11(+9)":"m11(#9)","m11(#9#5)":"m11(#9#5)","m11(#5#9)":"m11(#9#5)","m11#5#9":"m11(#9#5)","m11+5+9":"m11(#9#5)","m11(+5+9)":"m11(#9#5)","-11(#5#9)":"m11(#9#5)","-11#5#9":"m11(#9#5)","m9+5+9":"m11(#9#5)","-11(+5+9)":"m11(#9#5)","m11(#9b13)":"m11(#9b13)","m11#9b13":"m11(#9b13)","m11+9-13":"m11(#9b13)","m11(+9-13)":"m11(#9b13)","-11(#9b13)":"m11(#9b13)","-11#9b13":"m11(#9b13)","-11+9-13":"m11(#9b13)","-11(+9-13)":"m11(#9b13)","m11(b13)":"m11(b13)",m11b13:"m11(b13)","m11-13":"m11(b13)","m11(-13)":"m11(b13)","-11(b13)":"m11(b13)","-11b13":"m11(b13)","-11-13":"m11(b13)","-11(-13)":"m11(b13)","m11(b13#5)":"m11(b13#5)","m11(#5b13)":"m11(b13#5)","m11#5b13":"m11(b13#5)","m11+5-13":"m11(b13#5)","m11(+5-13)":"m11(b13#5)","-11(#5b13)":"m11(b13#5)","-11#5b13":"m11(b13#5)","-11+5-13":"m11(b13#5)","-11(+5-13)":"m11(b13#5)","m11(b5)":"m11(b5)",m11b5:"m11(b5)","m11-5":"m11(b5)","m11(-5)":"m11(b5)","-11(b5)":"m11(b5)","-11b5":"m11(b5)","-9-5":"m9(b5)","-11(-5)":"m11(b5)","m11(b5#9)":"m11(b5#9)","m11b5#9":"m11(b5#9)","m11-5+9":"m11(b5#9)","m11(-5+9)":"m11(b5#9)","-11(b5#9)":"m11(b5#9)","-11b5#9":"m11(b5#9)","-11-5+9":"m11(b5#9)","-11(-5+9)":"m11(b5#9)","m11(b5b13)":"m11(b5b13)",m11b5b13:"m11(b5b13)","m11(-5-13)":"m11(b5b13)","m11-5-13":"m11(b5b13)","-11(b5b13)":"m11(b5b13)","-11b5b13":"m11(b5b13)","-11(-5-13)":"m11(b5b13)","-11-5-13":"m11(b5b13)","m11(b5b9)":"m11(b5b9)",m11b5b9:"m11(b5b9)","m11-5-9":"m11(b5b9)","m11(-5-9)":"m11(b5b9)","-11(b5b9)":"m11(b5b9)","-11b5b9":"m11(b5b9)","-11-5-9":"m11(b5b9)","-11(-5-9)":"m11(b5b9)","m11(b9)":"m11(b9)",m11b9:"m11(b9)","m11(-9)":"m11(b9)","m11-9":"m11(b9)","-11(b9)":"m11(b9)","-11b9":"m11(b9)","-11(-9)":"m11(b9)","-11-9":"m11(b9)","m11(b9#5)":"m11(b9#5)","m11(#5b9)":"m11(b9#5)","m11#5b9":"m11(b9#5)","m11+5-9":"m11(b9#5)","m11(+5-9)":"m11(b9#5)","-11(#5b9)":"m11(b9#5)","-11#5b9":"m11(b9#5)","m9+5-9":"m11(b9#5)","-11(+5-9)":"m11(b9#5)","m11(b9b13)":"m11(b9b13)",m11b9b13:"m11(b9b13)","m11(-9-13)":"m11(b9b13)","m11-9-13":"m11(b9b13)","-11(b9b13)":"m11(b9b13)","-11b9b13":"m11(b9b13)","-11(-9-13)":"m11(b9b13)","-11-9-13":"m11(b9b13)",m13:"m13",mi13:"m13",min13:"m13","-13":"m13","m13(#11)":"m13(#11)","m13#11":"m13(#11)","m13+11":"m13(#11)","m13(+11)":"m13(#11)","-13(#11)":"m13(#11)","-13#11":"m13(#11)","-13+11":"m13(#11)","-13(+11)":"m13(#11)","m13(#5)":"m13(#5)","m13#5":"m13(#5)","m13+5":"m13(#5)","m13(+5)":"m13(#5)","-13(#5)":"m13(#5)","-13#5":"m13(#5)","-13(+5)":"m13(#5)","m13(#9)":"m13(#9)","m13#9":"m13(#9)","m13(+9)":"m13(#9)","m13+9":"m13(#9)","-13(#9)":"m13(#9)","-13#9":"m13(#9)","-13(+9)":"m13(#9)","-13+9":"m13(#9)","m13(b5)":"m13(b5)",m13b5:"m13(b5)","m13-5":"m13(b5)","m13(-5)":"m13(b5)","-13(b5)":"m13(b5)","-13b5":"m13(b5)","-13-5":"m13(b5)","-13(-5)":"m13(b5)","m13(b9)":"m13(b9)",m13b9:"m13(b9)","m13-9":"m13(b9)","m13(-9)":"m13(b9)","-13(b13)":"m13(b9)","-13b13":"m13(b9)","-13-13":"m13(b9)","-13(-13)":"m13(b9)",m2:"m2",mi2:"m2",min2:"m2","m(add2)":"m2",madd2:"m2",m4:"m4",m6:"m6",mi6:"m6",min6:"m6","-6":"m6","m6(#5)":"m6(#5)","m6(9)":"m6(9)",m6add9:"m6(9)","m6(add9)":"m6(9)",m69:"m6(9)","m6(ma7)":"m6(ma7)","m6(M7)":"m6(ma7)","m6(+7)":"m6(ma7)",m6M7:"m6(ma7)","m6+7":"m6(ma7)",m7:"m7",mi7:"m7",min7:"m7","-7":"m7","m7(#11)":"m7(#11)","m7#11":"m7(#11)","m7+11":"m7(#11)","m7(+11)":"m7(#11)","-7(#11)":"m7(#11)","-7#11":"m7(#11)","-7+11":"m7(#11)","-7(+11)":"m7(#11)","m7(#5)":"m7(#5)","m7#5":"m7(#5)","m7+5":"m7(#5)","m7(+5)":"m7(#5)","-7(#5)":"m7(#5)","-7#5":"m7(#5)","-7(+5)":"m7(#5)","m7(#9)":"m7(#9)","m7#9":"m7(#9)","m7+9":"m7(#9)","m7(+9)":"m7(#9)","-7(#9)":"m7(#9)","-7#9":"m7(#9)","-7(+9)":"m7(#9)","m7(11)":"m7(11)","m7(4)":"m7(4)","m7(add4)":"m7(4)","m7(add11)":"m7(4)",m74:"m7(4)","m7(6)":"m7(6)","m7(add6)":"m7(add6)","m7(b13)":"m7(b13)",m7b13:"m7(b13)","m7-13":"m7(b13)","m7(-13)":"m7(b13)","-7(b13)":"m7(b13)","-7b13":"m7(b13)","-7-13":"m7(b13)","-7(-13)":"m7(b13)","m7(b5)":"m7(b5)",m7b5:"m7(b5)","m7-5":"m7(b5)","m7(-5)":"m7(b5)","-7(b5)":"m7(b5)","-7b5":"m7(b5)","-7(-5)":"m7(b5)","m7(b9)":"m7(b9)",m7b9:"m7(b9)","m7-9":"m7(b9)","m7(-9)":"m7(b9)","-7(b9)":"m7(b9)","-7b9":"m7(b9)","-7(-9)":"m7(b9)","m7(no3)":"m7(no3)","min7(no3)":"m7(no3)",m7sus4:"m7sus4",m7sus:"m7sus4",m9:"m9",mi9:"m9",min9:"m9","-9":"m9","m9(#11)":"m9(#11)","m9#11":"m9(#11)","m9+11":"m9(#11)","m9(+11)":"m9(#11)","-9(#11)":"m9(#11)","-9#11":"m9(#11)","-9+11":"m9(#11)","-9(+11)":"m9(#11)","m9(#5)":"m9(#5)","m9#5":"m9(#5)","m9(+5)":"m9(#5)","-9(#5)":"m9(#5)","-9#5":"m9(#5)","-9(+5)":"m9(#5)","m9(#7)":"m9(#7)","m9(b13)":"m9(b13)",m9b13:"m9(b13)","m9-13":"m9(b13)","m9(-13)":"m9(b13)","-9(b13)":"m9(b13)","-9b13":"m9(b13)","-9-13":"m9(b13)","-9(-13)":"m9(b13)","m9(b5)":"m9(b5)",m9b5:"m9(b5)","m9-5":"m9(b5)","m9(-5)":"m9(b5)","-9(b5)":"m9(b5)","-9b5":"m9(b5)","-9(-5)":"m9(b5)","m9(ma7)":"m9(ma7)","m9(maj7)":"m9(ma7)","m9(+7)":"m9(ma7)","m9(M7)":"m9(ma7)",m9M7:"m9(ma7)",ma9:"ma9",maj9:"ma9",ma11:"ma11","11(#7)":"ma11","11#7":"ma11","11+7":"ma11","11(+7)":"ma11","+11":"ma11",M11:"ma11","ma11(#5)":"ma11(#5)","maj11#5":"ma11(#5)","maj11+5":"ma11(#5)","maj11(+5)":"ma11(#5)","+11(#5)":"ma11(#5)","+11#5":"ma11(#5)","M11+5":"ma11(#5)","+11(+5)":"ma11(#5)","maj11(#5)":"ma11(#5)","ma11#5":"ma11(#5)","ma11+5":"ma11(#5)","ma11(+5)":"ma11(#5)","ma11(#9)":"ma11(#9)","maj11#9":"ma11(#9)","maj11+9":"ma11(#9)","maj11(+9)":"ma11(#9)","+11(#9)":"ma11(#9)","+11#9":"ma11(#9)","M11+9":"ma11(#9)","+11(+9)":"ma11(#9)","maj11(#9)":"ma11(#9)","ma11#9":"ma11(#9)","ma11+9":"ma11(#9)","ma11(+9)":"ma11(#9)","ma11(b13)":"ma11(b13)",maj11b13:"ma11(b13)","maj11-13":"ma11(b13)","maj11(-13)":"ma11(b13)","+11(b13)":"ma11(b13)","+11b13":"ma11(b13)","M11-13":"ma11(b13)","+11(-13)":"ma11(b13)","maj11(b13)":"ma11(b13)",ma11b13:"ma11(b13)","ma11-13":"ma11(b13)","ma11(-13)":"ma11(b13)","ma11(b5)":"ma11(b5)",maj11b5:"ma11(b5)","maj11-5":"ma11(b5)","maj11(-5)":"ma11(b5)","+11(b5)":"ma11(b5)","+11b5":"ma11(b5)","M11-5":"ma11(b5)","+11(-5)":"ma11(b5)","maj11(b5)":"ma11(b5)",ma11b5:"ma11(b5)","ma11-5":"ma11(b5)","ma11(-5)":"ma11(b5)","ma11(b9)":"ma11(b9)",maj11b9:"ma11(b9)","maj11(-9)":"ma11(b9)","maj11-9":"ma11(b9)","+11(b9)":"ma11(b9)","+11b9":"ma11(b9)","M11(-9)":"ma11(b9)","+11-9":"ma11(b9)","maj11(b9)":"ma11(b9)",ma11b9:"ma11(b9)","ma11(-9)":"ma11(b9)","ma11-9":"ma11(b9)",ma13:"ma13","13(#7)":"ma13","+13":"ma13",M13:"ma13","ma13(#11)":"ma13(#11)","maj13#11":"ma13(#11)","maj13+11":"ma13(#11)","maj13(+11)":"ma13(#11)","+13(#11)":"ma13(#11)","+13#11":"ma13(#11)","M13+11":"ma13(#11)","+13(+11)":"ma13(#11)","maj13(#11)":"ma13(#11)","ma7#11":"ma9(#11)","ma13+11":"ma13(#11)","ma13(+11)":"ma13(#11)","ma13(#11#5)":"ma13(#11#5)","maj13#11#5":"ma13(#11#5)","maj13+11+5":"ma13(#11#5)","maj13(+11+5)":"ma13(#11#5)","+13(#11#5)":"ma13(#11#5)","+13#11#5":"ma13(#11#5)","M13+11+5":"ma13(#11#5)","+13(+11+5)":"ma13(#11#5)","maj13(#11#5)":"ma13(#11#5)","ma7#11#5":"ma9(#11#5)","ma13+11+5":"ma13(#11#5)","ma13(+11+5)":"ma13(#11#5)","ma13(#5)":"ma13(#5)","maj13#5":"ma13(#5)","maj13+5":"ma13(#5)","maj13(+5)":"ma13(#5)","+13(#5)":"ma13(#5)","+13#5":"ma13(#5)","M13+5":"ma13(#5)","+13(+5)":"ma13(#5)","maj13(#5)":"ma13(#5)","ma13#5":"ma13(#5)","ma13+5":"ma13(#5)","ma13(+5)":"ma13(#5)","ma13(#9)":"ma13(#9)","maj13#9":"ma13(#9)","maj13(+9)":"ma13(#9)","maj13+9":"ma13(#9)","+13(#9)":"ma13(#9)","+13#9":"ma13(#9)","M13(+9)":"ma13(#9)","+13+9":"ma13(#9)","maj13(#9)":"ma13(#9)","ma13#9":"ma13(#9)","ma13(+9)":"ma13(#9)","ma13+9":"ma13(#9)","ma13(#9#5)":"ma13(#9#5)","maj13#9#5":"ma13(#9#5)","maj13(+9+5)":"ma13(#9#5)","maj13+9+5":"ma13(#9#5)","+13(#9#5)":"ma13(#9#5)","+13#9#5":"ma13(#9#5)","M13(+9+5)":"ma13(#9#5)","+13+9+5":"ma13(#9#5)","maj13(#9#5)":"ma13(#9#5)","ma7#9#5":"ma13(#9#5)","ma13(+9+5)":"ma13(#9#5)","ma13+9+5":"ma13(#9#5)","ma13(b5)":"ma13(b5)",maj13b5:"ma13(b5)","maj13-5":"ma13(b5)","maj13(-5)":"ma13(b5)","+13(b5)":"ma13(b5)","+13b5":"ma13(b5)","M13-5":"ma13(b5)","+13(-5)":"ma13(b5)","maj13(b5)":"ma13(b5)",ma13b5:"ma13(b5)","ma13-5":"ma13(b5)","ma13(-5)":"ma13(b5)","ma13(b9)":"ma13(b9)",maj13b9:"ma13(b9)","maj13-9":"ma13(b9)","maj13(-9)":"ma13(b9)","+13(b9)":"ma13(b9)","+13b9":"ma13(b9)","M13-9":"ma13(b9)","+13(-9)":"ma13(b9)","maj13(b9)":"ma13(b9)",ma13b9:"ma13(b9)","ma13-9":"ma13(b9)","ma13(-9)":"ma13(b9)","ma13(b9#5)":"ma13(b9#5)","maj13b9#5":"ma13(b9#5)","maj13-9+5":"ma13(b9#5)","maj13(-9+5)":"ma13(b9#5)","+13(b9#5)":"ma13(b9#5)","+13b9#5":"ma13(b9#5)","M13-9+5":"ma13(b9#5)","+13(-9+5)":"ma13(b9#5)","maj13(b9#5)":"ma13(b9#5)","ma7b9#5":"ma13(b9#5)","ma13-9+5":"ma13(b9#5)","ma13(-9+5)":"ma13(b9#5)",ma6:"ma6","ma6(9)":"ma6(9)",ma69:"ma6(9)",ma7:"ma7","+7":"ma7","#7":"ma7",M7:"ma7",Maj7:"ma7",maj7:"ma7","(triangle)":"ma7","ma7(#11)":"ma7(#11)","maj7#11":"ma7(#11)","maj7+11":"ma7(#11)","maj7(+11)":"ma7(#11)","+7(#11)":"ma7(#11)","+7#11":"ma7(#11)","M7+11":"ma7(#11)","+7(+11)":"ma7(#11)","maj7(#11)":"ma7(#11)","ma7+11":"ma7(#11)","ma7(+11)":"ma7(#11)","ma7(#4)":"ma7(#4)","ma7(#5)":"ma7(#5)","maj7#5":"ma7(#5)","maj7+5":"ma7(#5)","maj7(+5)":"ma7(#5)","+7(#5)":"ma7(#5)","+7#5":"ma7(#5)","M7+5":"ma7(#5)","+7(+5)":"ma7(#5)","maj7(#5)":"ma7(#5)","ma7#5":"ma7(#5)","ma7+5":"ma7(#5)","ma7(+5)":"ma7(#5)","aug(M7)":"ma7(#5)","aug(+7)":"ma7(#5)","aug(ma7)":"ma7(#5)","aug(maj7)":"ma7(#5)","ma7(#9)":"ma7(#9)","maj7#9":"ma7(#9)","maj7+9":"ma7(#9)","maj7(+9)":"ma7(#9)","+7(#9)":"ma7(#9)","+7#9":"ma7(#9)","M7+9":"ma7(#9)","+7(+9)":"ma7(#9)","maj7(#9)":"ma7(#9)","ma7#9":"ma7(#9)","ma7+9":"ma7(#9)","ma7(+9)":"ma7(#9)","ma7(b13)":"ma7(b13)",maj7b13:"ma7(b13)","maj7-13":"ma7(b13)","maj7(-13)":"ma7(b13)","+7(b13)":"ma7(b13)","+7b13":"ma7(b13)","M7-13":"ma7(b13)","+7(-13)":"ma7(b13)","maj7(b13)":"ma7(b13)",ma7b13:"ma9(b13)","ma7-13":"ma7(b13)","ma7(-13)":"ma7(b13)","ma7(b5)":"ma7(b5)",maj7b5:"ma7(b5)","maj7-5":"ma7(b5)","maj7(-5)":"ma7(b5)","+7(b5)":"ma7(b5)","+7b5":"ma7(b5)","M7-5":"ma7(b5)","+7(-5)":"ma7(b5)","maj7(b5)":"ma7(b5)",ma7b5:"ma7(b5)","ma7-5":"ma7(b5)","ma7(-5)":"ma7(b5)","ma7(b9)":"ma7(b9)",maj7b9:"ma7(b9)","maj7-9":"ma7(b9)","maj7(-9)":"ma7(b9)","+7(b9)":"ma7(b9)","+7b9":"ma7(b9)","M7-9":"ma7(b9)","+7(-9)":"ma7(b9)","maj7(b9)":"ma7(b9)",ma7b9:"ma7(b9)","ma7-9":"ma7(b9)","ma7(-9)":"ma7(b9)","ma7(no3)":"ma7(no3)","9(#7)":"ma9","+9":"ma9",M9:"ma9","ma9(#11)":"ma9(#11)","maj9#11":"ma9(#11)","maj9+11":"ma9(#11)","maj9(+11)":"ma9(#11)","+9(#11)":"ma9(#11)","+9#11":"ma9(#11)","M9+11":"ma9(#11)","+9(+11)":"ma9(#11)","maj9(#11)":"ma9(#11)","ma9+11":"ma9(#11)","ma9(+11)":"ma9(#11)","ma9(#11#5)":"ma9(#11#5)","maj9#11#5":"ma9(#11#5)","maj9+11+5":"ma9(#11#5)","maj9(+11+5)":"ma9(#11#5)","+9(#11#5)":"ma9(#11#5)","+9#11#5":"ma9(#11#5)","M9+11+5":"ma9(#11#5)","+9(+11+5)":"ma9(#11#5)","maj9(#11#5)":"ma9(#11#5)","ma9+11+5":"ma9(#11#5)","ma9(+11+5)":"ma9(#11#5)","ma9(#4)":"ma9(#4)","ma9(#5)":"ma9(#5)","maj9#5":"ma9(#5)","maj9+5":"ma9(#5)","maj9(+5)":"ma9(#5)","+9(#5)":"ma9(#5)","+9#5":"ma9(#5)","M9+5":"ma9(#5)","+9(+5)":"ma9(#5)","maj9(#5)":"ma9(#5)","ma9#5":"ma9(#5)","ma9+5":"ma9(#5)","ma9(+5)":"ma9(#5)","ma9(13)":"ma9(13)","ma9(b13)":"ma9(b13)",maj9b13:"ma9(b13)","maj9-13":"ma9(b13)","maj9(-13)":"ma9(b13)","+9(b13)":"ma9(b13)","+9b13":"ma9(b13)","M9-13":"ma9(b13)","+9(-13)":"ma9(b13)","maj9(b13)":"ma9(b13)","ma9-13":"ma9(b13)","ma9(-13)":"ma9(b13)","ma9(b13#5)":"ma9(b13#5)","maj9b13#5":"ma9(b13#5)","maj9-13+5":"ma9(b13#5)","maj9(-13+5)":"ma9(b13#5)","+9(b13#5)":"ma9(b13#5)","+9b13#5":"ma9(b13#5)","M9-13+5":"ma9(b13#5)","+9(-13+5)":"ma9(b13#5)","maj9(b13#5)":"ma9(b13#5)","ma7b13#5":"ma9(b13#5)","ma9-13+5":"ma9(b13#5)","ma9(-13+5)":"ma9(b13#5)","ma9(b5)":"ma9(b5)",maj9b5:"ma9(b5)","maj9-5":"ma9(b5)","maj9(-5)":"ma9(b5)","+9(b5)":"ma9(b5)","+9b5":"ma9(b5)","M9-5":"ma9(b5)","+9(-5)":"ma9(b5)","maj9(b5)":"ma9(b5)",ma9b5:"ma9(b5)","ma9-5":"ma9(b5)","ma9(-5)":"ma9(b5)",sus:"sus",sus4:"sus","sus(no5)":"sus(no5)","sus#42":"sus#42"};var To=qh;function bs(r){return r===null||To[r]==="[blank]"?null:To[r]||r}class yr{static parse(t){try{return this.parseOrFail(t)}catch{return null}}static parseOrFail(t){const e=jh(t.trim());return new yr(e)}clone(){return this.set({})}toChordSymbol(t=null){var s;if(this.isChordSymbol())return this.clone();const e=Et.wrapOrFail(t);let n=new yr({suffix:this.suffix?bs(this.suffix):null,root:this.root.toChordSymbol(e),bass:((s=this.bass)==null?void 0:s.toChordSymbol(e))||null});return this.root.isMinor()&&(n=n.makeMinor()),n=n.normalize(t),n}toChordSymbolString(t=null){return this.toChordSymbol(t).toString()}isChordSymbol(){return this.is(Xr)}toNumeric(t=null){var n;if(this.isNumeric())return this.clone();if(this.isNumeral())return this.transform(s=>s.toNumeric());const e=Et.wrapOrFail(t);return new yr({suffix:bs(this.suffix),root:this.root.toNumeric(e),bass:((n=this.bass)==null?void 0:n.toNumeric(e))||null})}toNumeral(t=null){var n;if(this.isNumeral())return this.clone();if(this.isNumeric())return this.transform(s=>s.toNumeral());const e=Et.wrapOrFail(t);return new yr({suffix:bs(this.suffix),root:e?this.root.toNumeral(e):null,bass:((n=this.bass)==null?void 0:n.toNumeral(e))||null})}toNumeralString(t=null){return this.toNumeral(t).toString()}isNumeric(){return this.is(Zr)}toNumericString(t=null){return this.toNumeric(t).toString()}isNumeral(){return this.is($r)}toString({useUnicodeModifier:t=!1}={}){const e=this.root.toString({showMinor:!1,useUnicodeModifier:t})+(this.suffix||"");return this.bass?`${e}/${this.bass.toString({useUnicodeModifier:t})}`:e}normalize(t=null,{normalizeSuffix:e=!0}={}){const n=e?bs(this.suffix):this.suffix;let s=this.root.normalize().normalizeEnharmonics(t);return this.root.isMinor()&&this.bass&&(s=this.root.transpose(3).removeMinor().normalize()),this.set({suffix:n,root:this.root.normalize().normalizeEnharmonics(t),bass:this.bass?this.bass.normalize().normalizeEnharmonics(s):null})}useModifier(t){return this.transform(e=>e.useModifier(t))}transposeUp(){return this.transform(t=>t.transposeUp())}transposeDown(){return this.transform(t=>t.transposeDown())}transpose(t){return this.transform(e=>e.transpose(t))}constructor({base:t=null,modifier:e=null,suffix:n=null,bassBase:s=null,bassModifier:i=null,root:a=null,bass:o=null}){this.suffix=n||null,this.root=this.determineRoot(a,t,e,n),this.bass=this.determineBass(o,s,i)}determineRoot(t,e,n,s){if(t)return t;if(!e)throw new Error("Expected base");return new Et({note:e,modifier:n,minor:Bh(s)})}determineBass(t,e,n){return t||(e?new Et({note:e,modifier:n||null,minor:!1}):null)}makeMinor(){return!this.suffix||this.suffix[0]!=="m"?this.set({suffix:`m${this.suffix||""}`}):this.clone()}set(t){var e;return new yr({root:this.root.clone(),suffix:this.suffix,bass:((e=this.bass)==null?void 0:e.clone())||null,...t})}is(t){return this.root.is(t)&&(!this.bass||this.bass.is(t))}transform(t){return this.set({root:t(this.root),bass:this.bass?t(this.bass):null})}}var Ws=yr;class Ds{constructor(t="",e=null){this.chords=t||"",this.lyrics=e||""}isRenderable(){return!0}clone(){return new Ds(this.chords,this.lyrics)}toString(){return`ChordLyricsPair(chords=${this.chords}, lyrics=${this.lyrics})`}set({chords:t,lyrics:e}){return new Ds(t||this.chords,e||this.lyrics)}setLyrics(t){return this.set({lyrics:t})}transpose(t,e=null,{normalizeChordSuffix:n}={normalizeChordSuffix:!1}){const s=Ws.parse(this.chords.trim());if(s){let i=s.transpose(t);return e&&(i=i.normalize(e,{normalizeSuffix:n})),this.set({chords:i.toString()})}return this.clone()}}var Je=Ds;const Hh={separator:","};class Wh{constructor(t=Hh){this.separator=t.separator}}var Yh=Wh;const Po={evaluate:!1,metadata:{separator:","},key:null,expandChorusDirective:!1,useUnicodeModifiers:!1,normalizeChords:!0};class Xh{constructor(t=Po){const e={...Po,...t};this.evaluate=!!e.evaluate,this.expandChorusDirective=!!e.expandChorusDirective,this.useUnicodeModifiers=!!e.useUnicodeModifiers,this.normalizeChords=!!e.normalizeChords,this.metadata=new Yh(t.metadata),this.key=t.key?Et.wrap(t.key):null,this.configuration=t}get(t){return Th(this,t)}}var Zh=Xh;class Qh{constructor(t=null){this.configuration=new Zh(t||{})}}var va=Qh;class Jh{constructor(t=null){Q(this,"line",null);Q(this,"column",null);Q(this,"offset",null);t&&(this.line=t.line||null,this.column=t.column||null,this.offset=t.offset||null)}}var oc=Jh;const lc="album",cc="artist",Hn="capo",$a="comment",uc="composer",fc="copyright",hc="duration",Rn="end_of_chorus",wa="end_of_tab",xa="end_of_verse",Qr="key",dc="_key",mc="lyricist",e1="start_of_bridge",rn="start_of_chorus",Ys="start_of_tab",Xs="start_of_verse",Ca="subtitle",pc="tempo",bc="time",Ea="title",t1="transpose",gc="new_key",yc="year",Ms="chordfont",Ns="chordsize",Yi="chordcolour",Fs="textfont",Rs="textsize",Xi="textcolour",_c="chorus",r1="t",n1="st",s1="c",i1="soc",a1="eoc",o1="sot",l1="eot",c1="nk",u1="cf",f1="cs",h1="tf",d1="ts",m1=[$a],p1=[lc,cc,Hn,uc,fc,hc,Qr,mc,pc,bc,Ea,Ca,yc],b1=[dc],g1=[rn,Rn,Ys,wa,Xs,xa],y1=[Ms,Ns,Yi,Fs,Rs,Xi],_1=[Xs,rn,e1,Ys,_c],jo={[r1]:Ea,[n1]:Ca,[s1]:$a,[i1]:rn,[a1]:Rn,[o1]:Ys,[l1]:wa,[c1]:gc,[u1]:Ms,[f1]:Ns,[h1]:Fs,[d1]:Rs},v1=/^([^:\s]+)(:?\s*(.+))?$/,$1=/^x_(.+)$/;function Io(r){return b1.includes(r)}const w1=r=>{if(!r)return r;const t=r.trim();return t in jo?jo[t]:t};class Ur extends oc{constructor(e,n=null,s=null){super(s);Q(this,"_originalName","");Q(this,"_name","");Q(this,"_value","");Q(this,"_isMetaTag",!1);this.parseNameValue(e,n)}parseNameValue(e,n){e==="meta"?this.parseMetaTag(n):(this.name=e,this.value=n||"")}parseMetaTag(e){if(!e)throw new Error("Expected value");const[n,s]=e.split(/\s(.+)/);this.name=n,this.value=s||"",this._isMetaTag=!0}static parse(e){return e instanceof Ur?e:this.parseWithRegex(e,v1)}static parseWithRegex(e,n){const s=e.match(n);return s!==null?new Ur(s[1],s[3]||null):null}static parseOrFail(e){const n=this.parse(e);if(!n)throw new Error(`Failed to parse ${e}`);return n}isSectionDelimiter(){return g1.includes(this.name)}isInlineFontTag(){return y1.includes(this.name)}set name(e){this._name=w1(e),this._originalName=e}get name(){return this._name.trim()}get originalName(){return this._originalName.trim()}set value(e){this._value=e||""}get value(){return`${this._value}`.trim()}hasValue(){return this.value.length>0}isRenderable(){return m1.includes(this.name)||this.hasRenderableLabel()}hasRenderableLabel(){return _1.includes(this.name)&&this.hasValue()}isMetaTag(){return this._isMetaTag||$1.test(this.name)||p1.indexOf(this.name)!==-1}clone(){return new Ur(this._originalName,this.value)}toString(){return`Tag(name=${this.name}, value=${this.value})`}set({value:e}){return new Ur(this._originalName,e)}}var De=Ur;class x1 extends Error{constructor(e,n=null,s=null,i=null){super(`${e} on line ${n} column ${s}`);Q(this,"line",null);Q(this,"column",null);Q(this,"offset",null);this.name="ExpressionError",this.line=n,this.column=s,this.offset=i}}var C1=x1;class E1 extends oc{}var ka=E1;class Sa extends ka{constructor(e,n=null){super();Q(this,"expressions",[]);this.expressions=e,this.variable=n}evaluate(e,n){return this.expressions.map(s=>s.evaluate(e,n,this.variable)).join("")}isRenderable(){return!0}clone(){return new Sa(this.expressions.map(e=>e.clone()),this.variable)}}var Zi=Sa;class Aa extends ka{constructor({variable:e=null,valueTest:n=null,trueExpression:s=[],falseExpression:i=[],line:a=null,column:o=null,offset:l=null}){super({line:a,column:o,offset:l});Q(this,"trueExpression",[]);Q(this,"falseExpression",[]);this.variable=e||null,this.valueTest=n||null,this.trueExpression=s,this.falseExpression=i}evaluate(e,n,s=null){if(this.variable)return this.evaluateWithVariable(e,n);if(!s)throw new C1("Unexpected empty expression",this.line,this.column,this.offset);return this.evaluateToString(e.get(s)||"",n)}evaluateToString(e,n){return Array.isArray(e)?e.join(n):e}evaluateWithVariable(e,n){if(!this.variable)throw new Error("Expected this.variable to be present");const s=e.get(this.variable);return s&&(Hs(this.valueTest)||s===this.valueTest)?this.evaluateForTruthyValue(e,n,s):this.falseExpression.length?new Zi(this.falseExpression,this.variable).evaluate(e,n):""}evaluateForTruthyValue(e,n,s){return this.trueExpression.length?new Zi(this.trueExpression,this.variable).evaluate(e,n):this.evaluateToString(s,n)}isRenderable(){return!0}clone(){return new Aa({variable:this.variable,valueTest:this.valueTest,trueExpression:this.trueExpression.map(e=>e.clone()),falseExpression:this.falseExpression.map(e=>e.clone()),line:this.line,column:this.column,offset:this.offset})}}var Kn=Aa;class Ta extends ka{constructor(t){super(),this.string=t}evaluate(){return this.string}isRenderable(){return!0}clone(){return new Ta(this.string)}}var Bn=Ta;const k1=`
`;class S1 extends va{format(t){const{lines:e,metadata:n}=t;return e.map(s=>this.formatLine(s,n)).join(k1)}formatLine(t,e){return t.items.map(n=>this.formatItem(n,e)).join("")}formatItem(t,e){if(t instanceof De)return this.formatTag(t);if(t instanceof Je)return this.formatChordLyricsPair(t);if("evaluate"in t)return this.formatOrEvaluateItem(t,e);throw new Error(`Don't know how to format a ${t.constructor.name}`)}formatOrEvaluateItem(t,e){if(this.configuration.evaluate)return t.evaluate(e,this.configuration.get("metadata.separator"));if(t instanceof Kn)return this.formatTernary(t);if(t instanceof Bn)return t.evaluate();throw new Error(`Don't know how to format a ${t.constructor.name}`)}formatTernary(t){const{variable:e,valueTest:n,trueExpression:s,falseExpression:i}=t;return["%{",e||"",this.formatValueTest(n),this.formatExpressionRange(s),this.formatExpressionRange(i),"}"].join("")}formatValueTest(t){return t?`=${t}`:""}formatExpressionRange(t){return t.length?`|${t.map(e=>this.formatExpression(e)).join("")}`:""}formatExpression(t){return t instanceof Kn?this.formatTernary(t):t instanceof Bn?t.string:""}formatTag(t){return t.hasValue()?`{${t.originalName}: ${t.value}}`:`{${t.originalName}}`}formatChordLyricsPair(t){return[this.formatChordLyricsPairChords(t),this.formatChordLyricsPairLyrics(t)].join("")}formatChordLyricsPairChords(t){return t.chords?`[${t.chords}]`:""}formatChordLyricsPairLyrics(t){return t.lyrics||""}}var A1=S1;class Pa{constructor(t){this.content=t}isRenderable(){return!1}clone(){return new Pa(this.content)}toString(){return`Comment(content=${this.content})`}}var An=Pa;class ja{constructor({font:t,size:e,colour:n}={font:null,size:null,colour:null}){Q(this,"font",null);Q(this,"size",null);Q(this,"colour",null);this.font=t?t.replace(/"/g,"'"):null,this.size=e||null,this.colour=n||null}clone(){return new ja({font:this.font,size:this.size,colour:this.colour})}toCssString(){const t={};return this.colour&&(t.color=this.colour),this.font&&this.size?t.font=`${this.size} ${this.font}`:this.font?t["font-family"]=this.font:this.size&&(t["font-size"]=`${this.size}`),Object.keys(t).map(e=>`${e}: ${t[e]}`).join("; ")}}var Ks=ja;class Bs{constructor({type:t,items:e}={type:ar,items:[]}){Q(this,"items",[]);Q(this,"type",ar);Q(this,"currentChordLyricsPair",new Je);Q(this,"key",null);Q(this,"transposeKey",null);Q(this,"lineNumber",null);Q(this,"textFont",new Ks);Q(this,"chordFont",new Ks);this.type=t,this.items=e}isEmpty(){return this.items.length===0}isNotEmpty(){return!this.isEmpty()}addItem(t){t instanceof De?this.addTag(t):t instanceof Je?this.addChordLyricsPair(t):t instanceof An?this.addComment(t):this.items.push(t)}hasRenderableItems(){return this.items.some(t=>t.isRenderable())}clone(){return this.mapItems(null)}mapItems(t){const e=new Bs;return e.items=this.items.map(n=>{const s=n.clone();return t?t(s):s}).filter(n=>n!==null),e.type=this.type,e}isVerse(){return this.type===Pr}isChorus(){return this.type===ir}hasContent(){return this.hasRenderableItems()}addChordLyricsPair(t=null,e=null){return t instanceof Je?this.currentChordLyricsPair=t:this.currentChordLyricsPair=new Je(t||"",e||""),this.items.push(this.currentChordLyricsPair),this.currentChordLyricsPair}ensureChordLyricsPair(){this.currentChordLyricsPair||this.addChordLyricsPair()}chords(t){this.ensureChordLyricsPair(),this.currentChordLyricsPair.chords+=t}lyrics(t){this.ensureChordLyricsPair(),this.currentChordLyricsPair.lyrics+=t}addTag(t,e=null){const n=t instanceof De?t:new De(t,e);return this.items.push(n),n}addComment(t){const e=t instanceof An?t:new An(t);return this.items.push(e),e}set(t){return new Bs({type:this.type,items:this.items,...t})}}var Qi=Bs;class T1{constructor(){Q(this,"lines",[])}addLine(t){this.lines.push(t)}get type(){const t=this.lines.map(n=>n.type),e=[...new Set(t)];return e.length===1?e[0]:ya}hasRenderableItems(){return this.lines.some(t=>t.hasRenderableItems())}}var Ji=T1;class P1{get key(){return this.getSingleMetadata(Qr)}get title(){return this.getSingleMetadata(Ea)}get subtitle(){return this.getSingleMetadata(Ca)}get capo(){return this.getMetadata(Hn)}get duration(){return this.getSingleMetadata(hc)}get tempo(){return this.getSingleMetadata(pc)}get time(){return this.getMetadata(bc)}get year(){return this.getSingleMetadata(yc)}get album(){return this.getMetadata(lc)}get copyright(){return this.getSingleMetadata(fc)}get lyricist(){return this.getMetadata(mc)}get artist(){return this.getMetadata(cc)}get composer(){return this.getMetadata(uc)}}var vc=P1;function j1(r,t){r.includes(t)||r.push(t)}class Ia extends vc{constructor(e={}){super();Q(this,"metadata",{});e&&this.assign(e)}merge(e){const n=this.clone();return n.assign(e),n}contains(e){return e in this.metadata}add(e,n){if(Io(e))return;if(!(e in this.metadata)){this.metadata[e]=n;return}const s=this.metadata[e];if(s!==n){if(s instanceof Array){j1(s,n);return}this.metadata[e]=[s,n]}}set(e,n){n?this.metadata[e]=n:delete this.metadata[e]}getMetadata(e){return this.get(e)}getSingleMetadata(e){return this.getSingle(e)}get(e){return e===dc?this.calculateKeyFromCapo():e in this.metadata?this.metadata[e]:this.getArrayItem(e)}getSingle(e){const n=this.get(e);return Array.isArray(n)?n[0]:n}parseArrayKey(e){const n=e.match(/(.+)\.(-?\d+)$/);if(!n)return null;const s=n[1],i=parseInt(n[2],10);return[s,i]}getArrayItem(e){const n=this.parseArrayKey(e);if(n===null)return;const[s,i]=n,a=this.metadata[s]||[];let o=i;return o<0?o=a.length+o:o>0&&(o-=1),a[o]}clone(){return new Ia(this.metadata)}calculateKeyFromCapo(){const e=this.getSingle(Hn),n=this.getSingle(Qr);if(e&&n){const s=Ws.parse(n);if(!s)throw new Error(`Could not parse ${n}`);return s.transpose(parseInt(e,10)).toString()}}assign(e){Object.keys(e).filter(n=>!Io(n)).forEach(n=>{const s=e[n];s instanceof Array?this.metadata[n]=[...s]:this.metadata[n]=s})}}var $c=Ia;class I1{constructor(t,e,n){Q(this,"lineNumber",null);Q(this,"column",null);this.message=t,this.lineNumber=e,this.column=n}toString(){return`Warning: ${this.message} on line ${this.lineNumber||"?"} column ${this.column||"?"}`}}var O1=I1;class _r{constructor(t,e){this.fontSize=t,this.unit=e}clone(){return new _r(this.fontSize,this.unit)}multiply(t){return new _r(this.fontSize*t/100,this.unit)}toString(){return`${this.fontSize}${this.unit}`}static parse(t,e){const n=t.trim(),s=parseFloat(n);return Number.isNaN(s)?this.parseNotANumber(e):n.slice(-1)==="%"?this.parsePercentage(s,e):new _r(s,"px")}static parseNotANumber(t){return t?t.clone():new _r(100,"%")}static parsePercentage(t,e){return e?e.multiply(t):new _r(t,"%")}}var L1=_r;class D1{constructor(){Q(this,"fontAndColourStacks",{[Yi]:[],[Ms]:[],[Xi]:[],[Fs]:[]});Q(this,"sizeStacks",{[Ns]:[],[Rs]:[]});Q(this,"textFont",new Ks);Q(this,"chordFont",new Ks)}applyTag(t){switch(t.name){case Fs:this.textFont.font=this.pushOrPopTag(t);break;case Rs:this.textFont.size=this.pushOrPopSizeTag(t);break;case Xi:this.textFont.colour=this.pushOrPopTag(t);break;case Ms:this.chordFont.font=this.pushOrPopTag(t);break;case Ns:this.chordFont.size=this.pushOrPopSizeTag(t);break;case Yi:this.chordFont.colour=this.pushOrPopTag(t);break}}pushOrPopTag(t){let{value:e}=t;return t.hasValue()?this.fontAndColourStacks[t.name].push(e):(this.fontAndColourStacks[t.name].pop(),e=this.fontAndColourStacks[t.name].slice(-1)[0]||null),e}pushOrPopSizeTag(t){const{value:e}=t;if(t.hasValue()){const n=this.sizeStacks[t.name].slice(-1)[0]||null,s=L1.parse(e,n);return this.sizeStacks[t.name].push(s),s}return this.sizeStacks[t.name].pop(),this.sizeStacks[t.name].slice(-1)[0]||null}}var M1=D1;class zs extends vc{constructor(e={}){super();Q(this,"lines",[]);Q(this,"currentLine",null);Q(this,"warnings",[]);Q(this,"sectionType",ar);Q(this,"fontStack",new M1);Q(this,"currentKey",null);Q(this,"transposeKey",null);Q(this,"_bodyParagraphs",null);Q(this,"_bodyLines",null);this.metadata=new $c(e)}get previousLine(){const e=this.lines.length;return e>=2?this.lines[e-2]:null}get bodyLines(){return this._bodyLines||(this._bodyLines=this.selectRenderableItems(this.lines)),this._bodyLines}get bodyParagraphs(){return this._bodyParagraphs||(this._bodyParagraphs=this.selectRenderableItems(this.paragraphs)),this._bodyParagraphs}selectRenderableItems(e){const n=[...e];for(;n.length&&!n[0].hasRenderableItems();)n.shift();return n}chords(e){if(!this.currentLine)throw new Error("Expected this.currentLine to be present");this.currentLine.chords(e)}lyrics(e){if(this.ensureLine(),!this.currentLine)throw new Error("Expected this.currentLine to be present");this.currentLine.lyrics(e)}addLine(e){return e?this.currentLine=e:(this.currentLine=new Qi,this.lines.push(this.currentLine)),this.setCurrentProperties(this.sectionType),this.currentLine.transposeKey=this.transposeKey??this.currentKey,this.currentLine.key=this.currentKey||this.metadata.getSingle(Qr),this.currentLine.lineNumber=this.lines.length-1,this.currentLine}expandLine(e){const n=e.items.flatMap(s=>s instanceof De&&s.name===_c?this.getLastChorusBefore(e.lineNumber):[]);return[e,...n]}getLastChorusBefore(e){const n=[];if(!e)return n;for(let s=e-1;s>=0;s-=1){const i=this.lines[s];if(i.type===ir){const a=this.filterChorusStartEndDirectives(i);i.isNotEmpty()&&a.isEmpty()||n.unshift(i)}else if(n.length>0)break}return n}filterChorusStartEndDirectives(e){return e.mapItems(n=>n instanceof De&&(n.name===rn||n.name===Rn)?null:n)}get paragraphs(){return this.linesToParagraphs(this.lines)}get expandedBodyParagraphs(){return this.selectRenderableItems(this.linesToParagraphs(this.lines.flatMap(e=>this.expandLine(e))))}linesToParagraphs(e){let n=new Ji;const s=[n];return e.forEach(i=>{i.isEmpty()?(n=new Ji,s.push(n)):i.hasRenderableItems()&&n.addLine(i)}),s}setCurrentProperties(e){if(!this.currentLine)throw new Error("Expected this.currentLine to be present");this.currentLine.type=e,this.currentLine.textFont=this.fontStack.textFont.clone(),this.currentLine.chordFont=this.fontStack.chordFont.clone()}ensureLine(){this.currentLine===null&&this.addLine()}addTag(e){const n=De.parseOrFail(e);return this.applyTagOnSong(n),this.applyTagOnLine(n),n}applyTagOnLine(e){if(this.ensureLine(),!this.currentLine)throw new Error("Expected this.currentLine to be present");this.currentLine.addTag(e)}applyTagOnSong(e){e.isMetaTag()?this.setMetadata(e.name,e.value||""):e.name===t1?this.transposeKey=e.value:e.name===gc?this.currentKey=e.value:e.isSectionDelimiter()?this.setSectionTypeFromTag(e):e.isInlineFontTag()&&this.fontStack.applyTag(e)}setSectionTypeFromTag(e){switch(e.name){case rn:this.startSection(ir,e);break;case Rn:this.endSection(ir,e);break;case Ys:this.startSection(Hi,e);break;case wa:this.endSection(Hi,e);break;case Xs:this.startSection(Pr,e);break;case xa:this.endSection(Pr,e);break}}startSection(e,n){this.checkCurrentSectionType(ar,n),this.sectionType=e,this.setCurrentProperties(e)}endSection(e,n){this.checkCurrentSectionType(e,n),this.sectionType=ar}checkCurrentSectionType(e,n){this.sectionType!==e&&this.addWarning(`Unexpected tag {${n.originalName}, current section is: ${this.sectionType}`,n)}addWarning(e,{line:n,column:s}){const i=new O1(e,n||null,s||null);this.warnings.push(i)}addItem(e){if(e instanceof De)this.addTag(e);else{if(this.ensureLine(),!this.currentLine)throw new Error("Expected this.currentLine to be present");this.currentLine.addItem(e)}}clone(){return this.mapItems(e=>e)}setMetadata(e,n){this.metadata.add(e,n)}get metaData(){return ic('metaData has been deprecated, please use metadata instead (notice the lowercase "d")'),this.metadata}getMetadata(e){return this.metadata.getMetadata(e)}getSingleMetadata(e){return this.metadata.getSingleMetadata(e)}setKey(e){const n=e?e.toString():null;return this.changeMetadata(Qr,n)}setCapo(e){const n=e?e.toString():null;return this.changeMetadata(Hn,n)}setDirective(e,n){return n===null?this.removeItem(s=>s instanceof De&&s.name===e):this.updateItem(s=>s instanceof De&&s.name===e,s=>"set"in s?s.set({value:n}):s,s=>s.insertDirective(e,n))}transpose(e,{normalizeChordSuffix:n=!1}={}){const s=Et.wrap(this.key);let i=null,a=this;return s&&(i=s.transpose(e),a=a.setKey(i.toString())),a.mapItems(o=>o instanceof Je?o.transpose(e,i,{normalizeChordSuffix:n}):o)}transposeUp({normalizeChordSuffix:e=!1}={}){return this.transpose(1,{normalizeChordSuffix:e})}transposeDown({normalizeChordSuffix:e=!1}={}){return this.transpose(-1,{normalizeChordSuffix:e})}changeKey(e){const n=this.getTransposeDistance(e),s=this.mapItems(i=>i instanceof De&&i.name===Qr?i.set({value:e.toString()}):i instanceof Je?i.transpose(n,e):i);return this.setKey(e.toString()),s}getTransposeDistance(e){const n=Et.wrap(this.key);if(!n)throw new Error(`
Cannot change song key, the original key is unknown.

Either ensure a key directive is present in the song (when using chordpro):
  \`{key: C}\`

Or set the song key before changing key:
  \`song.setKey('C');\``.substring(1));return n.distanceTo(e)}changeMetadata(e,n){const s=this.setDirective(e,n);return s.metadata.set(e,n),s}insertDirective(e,n,{after:s=null}={}){const i=this.lines.findIndex(u=>u.items.some(c=>!(c instanceof De)||s&&c instanceof De&&c.name===s)),a=new Qi;a.addTag(e,n);const o=this.clone(),{lines:l}=o;return o.lines=[...l.slice(0,i),a,...l.slice(i)],o}mapItems(e){const n=new zs;return this.lines.forEach(s=>{n.addLine(),s.items.forEach(i=>{const a=e(i);a&&n.addItem(a)})}),n}mapLines(e){const n=new zs;return this.lines.forEach(s=>{const i=e(s);i&&(n.addLine(),i.items.forEach(a=>n.addItem(a)))}),n}updateItem(e,n,s){let i=!1;const a=this.mapItems(o=>e(o)?(i=!0,n(o)):o);return i?a:s(a)}removeItem(e){return this.mapLines(n=>{const{items:s}=n,i=s.findIndex(e);return i===-1?n:s.length===1?null:n.set({items:[...s.slice(0,i),...s.slice(i+1)]})})}}var nn=zs;const Oo="chordSheet",Lo="chordLyricsPair",Do="tag",N1="comment",Mo="ternary",F1="line";class R1{constructor(){Q(this,"song",new nn)}serialize(t){return{type:Oo,lines:t.lines.map(e=>this.serializeLine(e))}}serializeLine(t){return{type:F1,items:t.items.map(e=>this.serializeItem(e))}}serializeItem(t){if(t instanceof De)return this.serializeTag(t);if(t instanceof Je)return this.serializeChordLyricsPair(t);if(t instanceof Kn)return this.serializeTernary(t);if(t instanceof Bn)return this.serializeLiteral(t);throw new Error(`Don't know how to serialize ${t.constructor.name}`)}serializeTag(t){return{type:Do,name:t.originalName,value:t.value}}serializeChordLyricsPair(t){return{type:Lo,chords:t.chords,chord:null,lyrics:t.lyrics}}serializeTernary(t){return{type:Mo,variable:t.variable,valueTest:t.valueTest,trueExpression:this.serializeExpression(t.trueExpression),falseExpression:this.serializeExpression(t.falseExpression)}}serializeLiteral(t){return t.string}serializeExpression(t){return t.map(e=>this.serializeItem(e))}deserialize(t){return this.parseAstComponent(t),this.song}parseAstComponent(t){if(!t)return null;if(typeof t=="string")return new Bn(t);const{type:e}=t;switch(e){case Oo:this.parseChordSheet(t);break;case Lo:return this.parseChordLyricsPair(t);case Do:return this.parseTag(t);case N1:return this.parseComment(t);case Mo:return this.parseTernary(t);default:console.warn(`Unhandled AST component "${e}"`,t)}return null}parseChordSheet(t){const{lines:e}=t;this.song=new nn,e.forEach(n=>this.parseLine(n))}parseLine(t){const{items:e}=t;this.song.addLine(),e.forEach(n=>{const s=this.parseAstComponent(n);this.song.addItem(s)})}parseChordLyricsPair(t){const{chord:e,chords:n,lyrics:s}=t;return new Je(e?new Ws(e).toString():n,s)}parseTag(t){const{name:e,value:n,location:{offset:s=null,line:i=null,column:a=null}={}}=t;return new De(e,n,{line:i,column:a,offset:s})}parseComment(t){const{comment:e}=t;return new An(e)}parseTernary(t){const{variable:e,valueTest:n,trueExpression:s,falseExpression:i,location:{offset:a=null,line:o=null,column:l=null}={}}=t;return new Kn({variable:e,valueTest:n,trueExpression:this.parseExpression(s),falseExpression:this.parseExpression(i),offset:a,line:o,column:l})}parseExpression(t){return(t||[]).map(e=>this.parseAstComponent(e)).filter(e=>e!==null)}}var wc=R1;class K1{constructor(){Q(this,"song",new nn)}get warnings(){return this.song.warnings}parseWithParser(t,e){const n=e(ac(t));return this.song=new wc().deserialize(n),this.song}}var xc=K1;function bi(r,t,e){return e=e||" ",r.length>t?r:(t-=r.length,e+=e.repeat(t),r+e.slice(0,t))}class Jr extends Error{static buildMessage(t,e){function n(u){return u.charCodeAt(0).toString(16).toUpperCase()}function s(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function i(u){return u.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function a(u){switch(u.type){case"literal":return'"'+s(u.text)+'"';case"class":const c=u.parts.map(h=>Array.isArray(h)?i(h[0])+"-"+i(h[1]):i(h));return"["+(u.inverted?"^":"")+c+"]";case"any":return"any character";case"end":return"end of input";case"other":return u.description}}function o(u){const c=u.map(a);let h,m;if(c.sort(),c.length>0){for(h=1,m=1;h<c.length;h++)c[h-1]!==c[h]&&(c[m]=c[h],m++);c.length=m}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}function l(u){return u?'"'+s(u)+'"':"end of input"}return"Expected "+o(t)+" but "+l(e)+" found."}constructor(t,e,n,s){super(),this.message=t,this.expected=e,this.found=n,this.location=s,this.name="PeggySyntaxError",typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(this,Jr.prototype):this.__proto__=Jr.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Jr)}format(t){let e="Error: "+this.message;if(this.location){let n=null,s;for(s=0;s<t.length;s++)if(t[s].grammarSource===this.location.source){n=t[s].text.split(/\r\n|\n|\r/g);break}let i=this.location.start,a=this.location.source+":"+i.line+":"+i.column;if(n){let o=this.location.end,l=bi("",i.line.toString().length," "),u=n[i.line-1],c=i.line===o.line?o.column:u.length+1;e+=`
 --> `+a+`
`+l+` |
`+i.line+" | "+u+`
`+l+" | "+bi("",i.column-1," ")+bi("",c-i.column,"^")}else e+=`
 at `+a}return e}}function B1(r,t){t=t!==void 0?t:{};const e={},n=t.grammarSource,s={ChordSheet:mn};let i=mn;const a=function(d,b){return{type:"chordSheet",lines:[...d,b]}},o=function(d){return d},l=function(d,b,k,T){return{type:"line",items:[d?{type:"chordLyricsPair",chords:"",lyrics:d}:null,...b,k?{type:"chordLyricsPair",chords:k,lyrics:""}:null,T?{type:"comment",comment:T}:null].filter(se=>se)}},u=function(d){return{type:"chordLyricsPair",chords:"",lyrics:d}},c="#",h=Ye("#",!1),m=/^[^\r\n]/,y=At(["\r",`
`],!0,!1),$=function(d){return d},_=function(d,b,k){return{type:"chordLyricsPair",chords:d||"",lyrics:b+(k||"")}},S=function(d){return d.map(b=>b.char||b).join("")},x="[",E=Ye("[",!1),M="]",j=Ye("]",!1),O=function(d){return d.map(b=>b.char||b).join("")},L=/^[^\]\r\n]/,I=At(["]","\r",`
`],!0,!1),N="\\",D=Ye("\\",!1),V=function(){return{type:"char",char:"\\"}},G=function(){return{type:"char",char:"]"}},H=function(d){return d},he="%{",le=Ye("%{",!1),xe="}",Ee=Ye("}",!1),ke=function(d,b,k){return{type:"ternary",variable:d.length>0?d:null,valueTest:b,...k,location:_e().start}},ie="=",Fe=Ye("=",!1),Re=function(d){return d},Me="|",ut=Ye("|",!1),$t=function(d,b){return{type:"ternary",trueExpression:d,falseExpression:b,location:_e().start}},Lt=function(d){return d},fe=/^[a-zA-Z0-9\-_]/,Te=At([["a","z"],["A","Z"],["0","9"],"-","_"],!1,!1),We=function(){return{type:"char",char:"]"}},Dt=function(){return{type:"char",char:"|"}},gt=function(){return{type:"char",char:"}"}},Xt=/^[^|[\]\\{}%#\r\n\t ]/,Zt=At(["|","[","]","\\","{","}","%","#","\r",`
`,"	"," "],!0,!1),St=function(){return{type:"char",char:"\\"}},st=function(){return{type:"char",char:"["}},wt="{",Qt=Ye("{",!1),K=function(){return{type:"char",char:"{"}},ft="%",Mt=Ye("%",!1),it=function(){return{type:"char",char:"%"}},ur=function(){return{type:"char",char:"#"}},Nt=function(d,b){return{type:"tag",name:d,value:b,location:_e().start}},Or=":",Ne=Ye(":",!1),fr=function(d){return d.map(b=>b.char||b).join("")},Lr=/^[a-zA-Z\-_]/,hr=At([["a","z"],["A","Z"],"-","_"],!1,!1),dr=/^[^}\\\r\n]/,Se=At(["}","\\","\r",`
`],!0,!1),ln=Yn("whitespace"),mr=/^[ \t\n\r]/,xt=At([" ","	",`
`,"\r"],!1,!1),Jt=Yn("space"),pr=/^[ \t]/,br=At([" ","	"],!1,!1),cn=`
`,un=Ye(`
`,!1),Dr="\r",fn=Ye("\r",!1);let v=0,de=0;const Ft=[{line:1,column:1}];let w=0,B=[],R=0,te;if(t.startRule!==void 0){if(!(t.startRule in s))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');i=s[t.startRule]}function _e(){return dn(de,v)}function Ye(d,b){return{type:"literal",text:d,ignoreCase:b}}function At(d,b,k){return{type:"class",parts:d,inverted:b,ignoreCase:k}}function Wn(){return{type:"end"}}function Yn(d){return{type:"other",description:d}}function hn(d){let b=Ft[d],k;if(b)return b;for(k=d-1;!Ft[k];)k--;for(b=Ft[k],b={line:b.line,column:b.column};k<d;)r.charCodeAt(k)===10?(b.line++,b.column=1):b.column++,k++;return Ft[d]=b,b}function dn(d,b){const k=hn(d),T=hn(b);return{source:n,start:{offset:d,line:k.line,column:k.column},end:{offset:b,line:T.line,column:T.column}}}function ae(d){v<w||(v>w&&(w=v,B=[]),B.push(d))}function Zs(d,b,k){return new Jr(Jr.buildMessage(d,b),d,b,k)}function mn(){let d,b,k;for(d=v,b=[],k=Xn();k!==e;)b.push(k),k=Xn();return b!==e?(k=pn(),k===e&&(k=null),k!==e?(de=d,b=a(b,k),d=b):(v=d,d=e)):(v=d,d=e),d}function Xn(){let d,b,k;return d=v,b=pn(),b!==e?(k=si(),k!==e?(de=d,b=o(b),d=b):(v=d,d=e)):(v=d,d=e),d}function pn(){let d,b,k,T,se,ye,Ue;if(d=v,b=v,k=Qn(),k===e&&(k=null),k!==e?b=r.substring(b,v):b=k,b!==e){for(k=[],T=Zn();T!==e;)k.push(T),T=Zn();if(k!==e)if(T=es(),T===e&&(T=null),T!==e)if(se=Qs(),se===e&&(se=null),se!==e){for(ye=[],Ue=Rt();Ue!==e;)ye.push(Ue),Ue=Rt();ye!==e?(de=d,b=l(b,k,T,se),d=b):(v=d,d=e)}else v=d,d=e;else v=d,d=e;else v=d,d=e}else v=d,d=e;return d}function Zn(){let d,b;return d=gn(),d===e&&(d=Js(),d===e&&(d=bn(),d===e&&(d=v,b=Qn(),b!==e&&(de=d,b=u(b)),d=b))),d}function Qs(){let d,b,k,T,se,ye;if(d=v,b=Rt(),b===e&&(b=null),b!==e)if(r.charCodeAt(v)===35?(k=c,v++):(k=e,R===0&&ae(h)),k!==e){for(T=v,se=[],m.test(r.charAt(v))?(ye=r.charAt(v),v++):(ye=e,R===0&&ae(y));ye!==e;)se.push(ye),m.test(r.charAt(v))?(ye=r.charAt(v),v++):(ye=e,R===0&&ae(y));se!==e?T=r.substring(T,v):T=se,T!==e?(de=d,b=$(T),d=b):(v=d,d=e)}else v=d,d=e;else v=d,d=e;return d}function Js(){let d,b,k,T,se,ye;if(d=v,b=es(),b!==e){for(k=v,T=[],se=Ae();se!==e;)T.push(se),se=Ae();if(T!==e?k=r.substring(k,v):k=T,k!==e){for(T=v,se=[],ye=Rt();ye!==e;)se.push(ye),ye=Rt();se!==e?T=r.substring(T,v):T=se,T!==e?(de=d,b=_(b,k,T),d=b):(v=d,d=e)}else v=d,d=e}else v=d,d=e;return d}function Qn(){let d,b,k;if(d=v,b=[],k=Jn(),k!==e)for(;k!==e;)b.push(k),k=Jn();else b=e;return b!==e&&(de=d,b=S(b)),d=b,d}function Jn(){let d;return d=Ae(),d===e&&(d=Rt()),d}function es(){let d,b,k,T,se;if(d=v,b=v,R++,k=Fr(),R--,k===e?b=void 0:(v=b,b=e),b!==e)if(r.charCodeAt(v)===91?(k=x,v++):(k=e,R===0&&ae(E)),k!==e){for(T=[],se=ts();se!==e;)T.push(se),se=ts();T!==e?(r.charCodeAt(v)===93?(se=M,v++):(se=e,R===0&&ae(j)),se!==e?(de=d,b=O(T),d=b):(v=d,d=e)):(v=d,d=e)}else v=d,d=e;else v=d,d=e;return d}function ts(){let d,b,k,T;return L.test(r.charAt(v))?(d=r.charAt(v),v++):(d=e,R===0&&ae(I)),d===e&&(d=v,b=Fr(),b!==e?(k=v,r.charCodeAt(v)===92?(T=N,v++):(T=e,R===0&&ae(D)),T!==e&&(de=k,T=V()),k=T,k===e&&(k=v,r.charCodeAt(v)===93?(T=M,v++):(T=e,R===0&&ae(j)),T!==e&&(de=k,T=G()),k=T),k!==e?(de=d,b=H(k),d=b):(v=d,d=e)):(v=d,d=e)),d}function bn(){let d,b,k,T,se,ye,Ue,er,yn;return d=v,r.substr(v,2)===he?(b=he,v+=2):(b=e,R===0&&ae(le)),b!==e?(k=Ke(),k!==e?(T=v,se=ni(),se===e&&(se=null),se!==e?T=r.substring(T,v):T=se,T!==e?(se=ei(),se===e&&(se=null),se!==e?(ye=Ke(),ye!==e?(Ue=ti(),Ue===e&&(Ue=null),Ue!==e?(er=Ke(),er!==e?(r.charCodeAt(v)===125?(yn=xe,v++):(yn=e,R===0&&ae(Ee)),yn!==e?(de=d,b=ke(T,se,Ue),d=b):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e),d}function ei(){let d,b,k,T;return d=v,r.charCodeAt(v)===61?(b=ie,v++):(b=e,R===0&&ae(Fe)),b!==e?(k=Ke(),k!==e?(T=rs(),T!==e?(de=d,b=Re(T),d=b):(v=d,d=e)):(v=d,d=e)):(v=d,d=e),d}function rs(){let d,b,k;if(d=v,b=[],k=Ct(),k!==e)for(;k!==e;)b.push(k),k=Ct();else b=e;return b!==e?d=r.substring(d,v):d=b,d}function ti(){let d,b,k,T,se,ye,Ue;return d=v,r.charCodeAt(v)===124?(b=Me,v++):(b=e,R===0&&ae(ut)),b!==e?(k=Ke(),k!==e?(T=g(),T!==e?(se=Ke(),se!==e?(ye=ri(),ye===e&&(ye=null),ye!==e?(Ue=Ke(),Ue!==e?(de=d,b=$t(T,ye),d=b):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e),d}function ri(){let d,b,k,T;return d=v,r.charCodeAt(v)===124?(b=Me,v++):(b=e,R===0&&ae(ut)),b!==e?(k=Ke(),k!==e?(T=g(),T!==e?(de=d,b=Lt(T),d=b):(v=d,d=e)):(v=d,d=e)):(v=d,d=e),d}function ni(){let d,b;if(d=[],fe.test(r.charAt(v))?(b=r.charAt(v),v++):(b=e,R===0&&ae(Te)),b!==e)for(;b!==e;)d.push(b),fe.test(r.charAt(v))?(b=r.charAt(v),v++):(b=e,R===0&&ae(Te));else d=e;return d}function g(){let d,b,k,T;if(d=[],b=v,k=[],T=Ct(),T!==e)for(;T!==e;)k.push(T),T=Ct();else k=e;if(k!==e?b=r.substring(b,v):b=k,b===e&&(b=bn()),b!==e)for(;b!==e;){if(d.push(b),b=v,k=[],T=Ct(),T!==e)for(;T!==e;)k.push(T),T=Ct();else k=e;k!==e?b=r.substring(b,v):b=k,b===e&&(b=bn())}else d=e;return d}function Ae(){let d,b;return d=ht(),d===e&&(d=v,r.charCodeAt(v)===93?(b=M,v++):(b=e,R===0&&ae(j)),b!==e&&(de=d,b=We()),d=b,d===e&&(d=v,r.charCodeAt(v)===124?(b=Me,v++):(b=e,R===0&&ae(ut)),b!==e&&(de=d,b=Dt()),d=b,d===e&&(d=v,r.charCodeAt(v)===125?(b=xe,v++):(b=e,R===0&&ae(Ee)),b!==e&&(de=d,b=gt()),d=b))),d}function Ct(){let d;return d=ht(),d===e&&(d=Rt()),d}function ht(){let d,b,k,T;return Xt.test(r.charAt(v))?(d=r.charAt(v),v++):(d=e,R===0&&ae(Zt)),d===e&&(d=v,b=Fr(),b!==e?(k=v,r.charCodeAt(v)===92?(T=N,v++):(T=e,R===0&&ae(D)),T!==e&&(de=k,T=St()),k=T,k===e&&(k=v,r.charCodeAt(v)===124?(T=Me,v++):(T=e,R===0&&ae(ut)),T!==e&&(de=k,T=Dt()),k=T,k===e&&(k=v,r.charCodeAt(v)===91?(T=x,v++):(T=e,R===0&&ae(E)),T!==e&&(de=k,T=st()),k=T,k===e&&(k=v,r.charCodeAt(v)===93?(T=M,v++):(T=e,R===0&&ae(j)),T!==e&&(de=k,T=We()),k=T,k===e&&(k=v,r.charCodeAt(v)===123?(T=wt,v++):(T=e,R===0&&ae(Qt)),T!==e&&(de=k,T=K()),k=T,k===e&&(k=v,r.charCodeAt(v)===125?(T=xe,v++):(T=e,R===0&&ae(Ee)),T!==e&&(de=k,T=gt()),k=T,k===e&&(k=v,r.charCodeAt(v)===37?(T=ft,v++):(T=e,R===0&&ae(Mt)),T!==e&&(de=k,T=it()),k=T,k===e&&(k=v,r.charCodeAt(v)===35?(T=c,v++):(T=e,R===0&&ae(h)),T!==e&&(de=k,T=ur()),k=T))))))),k!==e?(de=d,b=H(k),d=b):(v=d,d=e)):(v=d,d=e)),d}function gn(){let d,b,k,T,se,ye,Ue,er;return d=v,r.charCodeAt(v)===123?(b=wt,v++):(b=e,R===0&&ae(Qt)),b!==e?(k=Ke(),k!==e?(T=v,se=Mr(),se!==e?T=r.substring(T,v):T=se,T!==e?(se=Ke(),se!==e?(ye=re(),ye===e&&(ye=null),ye!==e?(Ue=Ke(),Ue!==e?(r.charCodeAt(v)===125?(er=xe,v++):(er=e,R===0&&ae(Ee)),er!==e?(de=d,b=Nt(T,ye),d=b):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e)):(v=d,d=e),d}function re(){let d,b,k,T;return d=v,r.charCodeAt(v)===58?(b=Or,v++):(b=e,R===0&&ae(Ne)),b!==e?(k=Ke(),k!==e?(T=ns(),T!==e?(de=d,b=fr(T),d=b):(v=d,d=e)):(v=d,d=e)):(v=d,d=e),d}function Mr(){let d,b;if(d=[],Lr.test(r.charAt(v))?(b=r.charAt(v),v++):(b=e,R===0&&ae(hr)),b!==e)for(;b!==e;)d.push(b),Lr.test(r.charAt(v))?(b=r.charAt(v),v++):(b=e,R===0&&ae(hr));else d=e;return d}function ns(){let d,b;for(d=[],b=ge();b!==e;)d.push(b),b=ge();return d}function ge(){let d,b,k,T;return dr.test(r.charAt(v))?(d=r.charAt(v),v++):(d=e,R===0&&ae(Se)),d===e&&(d=v,b=Fr(),b!==e?(k=v,r.charCodeAt(v)===92?(T=N,v++):(T=e,R===0&&ae(D)),T!==e&&(de=k,T=St()),k=T,k===e&&(k=v,r.charCodeAt(v)===125?(T=xe,v++):(T=e,R===0&&ae(Ee)),T!==e&&(de=k,T=gt()),k=T,k===e&&(k=v,r.charCodeAt(v)===123?(T=wt,v++):(T=e,R===0&&ae(Qt)),T!==e&&(de=k,T=K()),k=T)),k!==e?(de=d,b=H(k),d=b):(v=d,d=e)):(v=d,d=e)),d}function Ke(){let d,b;for(R++,d=[],mr.test(r.charAt(v))?(b=r.charAt(v),v++):(b=e,R===0&&ae(xt));b!==e;)d.push(b),mr.test(r.charAt(v))?(b=r.charAt(v),v++):(b=e,R===0&&ae(xt));return R--,d===e&&(b=e,R===0&&ae(ln)),d}function Rt(){let d,b;if(R++,d=[],pr.test(r.charAt(v))?(b=r.charAt(v),v++):(b=e,R===0&&ae(br)),b!==e)for(;b!==e;)d.push(b),pr.test(r.charAt(v))?(b=r.charAt(v),v++):(b=e,R===0&&ae(br));else d=e;return R--,d===e&&(b=e,R===0&&ae(Jt)),d}function si(){let d;return d=ne(),d===e&&(d=Nr(),d===e&&(d=ss())),d}function ss(){let d,b,k;return d=v,b=ne(),b!==e?(k=Nr(),k!==e?(b=[b,k],d=b):(v=d,d=e)):(v=d,d=e),d}function Nr(){let d;return r.charCodeAt(v)===10?(d=cn,v++):(d=e,R===0&&ae(un)),d}function ne(){let d;return r.charCodeAt(v)===13?(d=Dr,v++):(d=e,R===0&&ae(fn)),d}function Fr(){let d;return r.charCodeAt(v)===92?(d=N,v++):(d=e,R===0&&ae(D)),d}if(te=i(),te!==e&&v===r.length)return te;throw te!==e&&v<r.length&&ae(Wn()),Zs(B,w<r.length?r.charAt(w):null,w<r.length?dn(w,w+1):dn(w,w))}const z1=B1;class V1 extends xc{parse(t){return this.parseWithParser(t,z1)}}var G1=V1;const gi=/\s/,U1=/^\s*((([A-G])(#|b)?([^/\s]*)(\/([A-G])(#|b)?)?)(\s|$)+)+(\s|$)+/;class q1{constructor({preserveWhitespace:t=!0}={}){Q(this,"processingText",!0);Q(this,"preserveWhitespace",!0);Q(this,"song",new nn);Q(this,"songLine",null);Q(this,"chordLyricsPair",null);Q(this,"lines",[]);Q(this,"currentLine",0);Q(this,"lineCount",0);ic(`ChordSheetParser is deprecated, please use ChordsOverWordsParser. 

ChordsOverWordsParser aims to support any kind of chord, whereas ChordSheetParser lacks 
support for many variations. Besides that, some chordpro feature have been ported back 
to ChordsOverWordsParser, which adds some interesting functionality.`),this.preserveWhitespace=t}parse(t,{song:e}={}){for(this.initialize(t,e);this.hasNextLine();){const n=this.readLine();this.parseLine(n)}return this.endOfSong(),this.song}endOfSong(){}parseLine(t){this.songLine=this.song.addLine(),t.trim().length===0?this.chordLyricsPair=null:this.parseNonEmptyLine(t)}parseNonEmptyLine(t){if(!this.songLine)throw new Error("Expected this.songLine to be present");if(this.chordLyricsPair=this.songLine.addChordLyricsPair(),U1.test(t)&&this.hasNextLine()){const e=this.readLine();this.parseLyricsWithChords(t,e)}else this.chordLyricsPair.lyrics=`${t}`}initialize(t,e=null){e&&(this.song=e),this.lines=ac(t).split(`
`),this.currentLine=0,this.lineCount=this.lines.length,this.processingText=!0}readLine(){const t=this.lines[this.currentLine];return this.currentLine+=1,t}hasNextLine(){return this.currentLine<this.lineCount}parseLyricsWithChords(t,e){if(this.processCharacters(t,e),!this.chordLyricsPair)throw new Error("Expected this.chordLyricsPair to be present");this.chordLyricsPair.lyrics+=e.substring(t.length),this.chordLyricsPair.chords=this.chordLyricsPair.chords.trim(),this.chordLyricsPair.lyrics&&(this.chordLyricsPair.lyrics=this.chordLyricsPair.lyrics.trim()),e.trim().length||(this.songLine=this.song.addLine())}processCharacters(t,e){for(let n=0,s=t.length;n<s;n+=1){const i=t[n],a=t[n+1],o=gi.test(i);if(this.addCharacter(i,a),!this.chordLyricsPair)throw new Error("Expected this.chordLyricsPair to be present");this.chordLyricsPair.lyrics+=e[n]||"",this.processingText=!o}}addCharacter(t,e){const n=gi.test(t);if(n||this.ensureChordLyricsPairInitialized(),!n||this.shouldAddCharacterToChords(e)){if(!this.chordLyricsPair)throw new Error("Expected this.chordLyricsPair to be present");this.chordLyricsPair.chords+=t}}shouldAddCharacterToChords(t){return t&&gi.test(t)&&this.preserveWhitespace}ensureChordLyricsPairInitialized(){if(!this.processingText){if(!this.songLine)throw new Error("Expected this.songLine to be present");this.chordLyricsPair=this.songLine.addChordLyricsPair(),this.processingText=!0}}}var Cc=q1;function yi(r,t,e){return e=e||" ",r.length>t?r:(t-=r.length,e+=e.repeat(t),r+e.slice(0,t))}class en extends Error{static buildMessage(t,e){function n(u){return u.charCodeAt(0).toString(16).toUpperCase()}function s(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function i(u){return u.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,c=>"\\x0"+n(c)).replace(/[\x10-\x1F\x7F-\x9F]/g,c=>"\\x"+n(c))}function a(u){switch(u.type){case"literal":return'"'+s(u.text)+'"';case"class":const c=u.parts.map(h=>Array.isArray(h)?i(h[0])+"-"+i(h[1]):i(h));return"["+(u.inverted?"^":"")+c+"]";case"any":return"any character";case"end":return"end of input";case"other":return u.description}}function o(u){const c=u.map(a);let h,m;if(c.sort(),c.length>0){for(h=1,m=1;h<c.length;h++)c[h-1]!==c[h]&&(c[m]=c[h],m++);c.length=m}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}function l(u){return u?'"'+s(u)+'"':"end of input"}return"Expected "+o(t)+" but "+l(e)+" found."}constructor(t,e,n,s){super(),this.message=t,this.expected=e,this.found=n,this.location=s,this.name="PeggySyntaxError",typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(this,en.prototype):this.__proto__=en.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,en)}format(t){let e="Error: "+this.message;if(this.location){let n=null,s;for(s=0;s<t.length;s++)if(t[s].grammarSource===this.location.source){n=t[s].text.split(/\r\n|\n|\r/g);break}let i=this.location.start,a=this.location.source+":"+i.line+":"+i.column;if(n){let o=this.location.end,l=yi("",i.line.toString().length," "),u=n[i.line-1],c=i.line===o.line?o.column:u.length+1;e+=`
 --> `+a+`
`+l+` |
`+i.line+" | "+u+`
`+l+" | "+yi("",i.column-1," ")+yi("",c-i.column,"^")}else e+=`
 at `+a}return e}}function H1(r,t){t=t!==void 0?t:{};const e={},n=t.grammarSource,s={ChordSheet:d};let i=d;const a=function(f,p){return{type:"chordSheet",lines:[...f,...p]}},o=function(f,p,A){return[...(f==null?void 0:f.length)>0?[{type:"line",items:[]}]:[],...p,A]},l=function(f){return f},u=function(f){return f.type==="chordsLine"?{type:"line",items:f.items.map(p=>{const A={type:"chordLyricsPair"};return p.type==="chord"?{...A,chord:p}:{...A,chords:p.value}})}:f},c=function(f,p){const A=f.items,z=A.map((Ce,at)=>{const Tt=A[at+1],Zc=Ce.column-1,Ha=Tt?Tt.column-1:p.length,is=p.substring(Zc,Ha),ai=/(\s+)(\S+)/.exec(is),as=ai?ai.index+ai[1].length:null,Wa=Ce.type==="chord"?{chord:Ce}:{chords:Ce.value};return as&&as<Ha?[{type:"chordLyricsPair",...Wa,lyrics:is.substring(0,as)},{type:"chordLyricsPair",chords:"",lyrics:is.substring(as)}]:{type:"chordLyricsPair",...Wa,lyrics:is}}).flat(),ue=A[0];if(ue&&ue.column>1){const Ce=ue.column;Ce>0&&z.unshift({type:"chordLyricsPair",chords:"",lyrics:p.substring(0,Ce-1)})}return{type:"line",items:z}},h=function(f){return{type:"chordsLine",items:f}},m=function(f){return f},y="/",$=ge("/",!1),_="|",S=ge("|",!1),x="-",E=ge("-",!1),M=function(f){return{type:"symbol",value:f,column:ns().start.column}},j=function(f){return f.length===0?{type:"line",items:[]}:{type:"line",items:[{type:"chordLyricsPair",chords:"",lyrics:f}]}},O=function(f){return f},L=function(f){return{type:"line",items:[{type:"tag",name:"comment",value:f}]}},I="verse",N=ge("verse",!0),D="chorus",V=ge("chorus",!0),G="bridge",H=ge("bridge",!0),he="tag",le=ge("tag",!0),xe="interlude",Ee=ge("interlude",!0),ke="instrumental",ie=ge("instrumental",!0),Fe="intro",Re=ge("intro",!0),Me=/^[^\n\r]/,ut=Ke([`
`,"\r"],!0,!1),$t=function(f,p){return[...f,p].filter(A=>A).map(([A,z])=>({type:"line",items:[{type:"tag",name:A,value:z}]}))},Lt=function(f,p){return{type:"line",items:[{type:"tag",name:f,value:p}]}},fe=function(f){return f},Te="{",We=ge("{",!1),Dt="}",gt=ge("}",!1),Xt=function(f){return f},Zt=function(f,p){return[f,p]},St=":",st=ge(":",!1),wt=/^[a-zA-Z0-9\-_]/,Qt=Ke([["a","z"],["A","Z"],["0","9"],"-","_"],!1,!1),K=/^[^\n\r}]/,ft=Ke([`
`,"\r","}"],!0,!1),Mt="---",it=ge("---",!1),ur=si("whitespace"),Nt=/^[ \t]/,Or=Ke([" ","	"],!1,!1),Ne=`
`,fr=ge(`
`,!1),Lr="\r",hr=ge("\r",!1),dr=function(f){return{type:"chord",...f,column:ns().start.column}},Se="#",ln=ge("#",!1),mr="b",xt=ge("b",!1),Jt=/^[a-zA-Z0-9()#+]/,pr=Ke([["a","z"],["A","Z"],["0","9"],"(",")","#","+"],!1,!1),br=function(f,p,A,z){return{base:f,modifier:p,suffix:A,...z,chordType:"symbol"}},cn=/^[A-Ga-g]/,un=Ke([["A","G"],["a","g"]],!1,!1),Dr=function(f,p){return{bassBase:f,bassModifier:p}},fn=function(f,p,A,z){return{base:p,modifier:f,suffix:A,...z,chordType:"numeral"}},v="III",de=ge("III",!1),Ft="iii",w=ge("iii",!1),B="VII",R=ge("VII",!1),te="vii",_e=ge("vii",!1),Ye="II",At=ge("II",!1),Wn="ii",Yn=ge("ii",!1),hn="IV",dn=ge("IV",!1),ae="iv",Zs=ge("iv",!1),mn="VI",Xn=ge("VI",!1),pn="vi",Zn=ge("vi",!1),Qs="I",Js=ge("I",!1),Qn="i",Jn=ge("i",!1),es="V",ts=ge("V",!1),bn="v",ei=ge("v",!1),rs=function(f,p){return{bassBase:p,bassModifier:f}},ti=function(f,p,A,z){return{base:p,modifier:f,suffix:A,...z,chordType:"numeric"}},ri=/^[1-7]/,ni=Ke([["1","7"]],!1,!1);let g=0,Ae=0;const Ct=[{line:1,column:1}];let ht=0,gn=[],re=0,Mr;if(t.startRule!==void 0){if(!(t.startRule in s))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');i=s[t.startRule]}function ns(){return Nr(Ae,g)}function ge(f,p){return{type:"literal",text:f,ignoreCase:p}}function Ke(f,p,A){return{type:"class",parts:f,inverted:p,ignoreCase:A}}function Rt(){return{type:"end"}}function si(f){return{type:"other",description:f}}function ss(f){let p=Ct[f],A;if(p)return p;for(A=f-1;!Ct[A];)A--;for(p=Ct[A],p={line:p.line,column:p.column};A<f;)r.charCodeAt(A)===10?(p.line++,p.column=1):p.column++,A++;return Ct[f]=p,p}function Nr(f,p){const A=ss(f),z=ss(p);return{source:n,start:{offset:f,line:A.line,column:A.column},end:{offset:p,line:z.line,column:z.column}}}function ne(f){g<ht||(g>ht&&(ht=g,gn=[]),gn.push(f))}function Fr(f,p,A){return new en(en.buildMessage(f,p),f,p,A)}function d(){let f,p,A;return f=g,p=Rc(),p===e&&(p=null),p!==e?(A=b(),A===e&&(A=null),A!==e?(Ae=f,p=a(p,A),f=p):(g=f,f=e)):(g=f,f=e),f}function b(){let f,p,A,z;if(f=g,p=_n(),p===e&&(p=null),p!==e){for(A=[],z=k();z!==e;)A.push(z),z=k();A!==e?(z=T(),z===e&&(z=null),z!==e?(Ae=f,p=o(p,A,z),f=p):(g=f,f=e)):(g=f,f=e)}else g=f,f=e;return f}function k(){let f,p,A;return f=g,p=T(),p!==e?(A=_n(),A!==e?(Ae=f,p=l(p),f=p):(g=f,f=e)):(g=f,f=e),f}function T(){let f,p;return f=g,p=Nc(),p===e&&(p=Kc(),p===e&&(p=se(),p===e&&(p=ye(),p===e&&(p=yn())))),p!==e&&(Ae=f,p=u(p)),f=p,f}function se(){let f,p,A,z;return f=g,p=ye(),p!==e?(A=_n(),A!==e?(z=Mc(),z!==e?(Ae=f,p=c(p,z),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function ye(){let f,p,A;if(f=g,p=[],A=Ue(),A===e&&(A=Da()),A!==e)for(;A!==e;)p.push(A),A=Ue(),A===e&&(A=Da());else p=e;return p!==e&&(Ae=f,p=h(p)),f=p,f}function Ue(){let f,p,A,z;return f=g,p=dt(),p!==e?(A=er(),A!==e?(z=dt(),z!==e?(Ae=f,p=m(A),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function er(){let f,p;return f=g,r.charCodeAt(g)===47?(p=y,g++):(p=e,re===0&&ne($)),p===e&&(r.charCodeAt(g)===124?(p=_,g++):(p=e,re===0&&ne(S)),p===e&&(r.charCodeAt(g)===45?(p=x,g++):(p=e,re===0&&ne(E)))),p!==e&&(Ae=f,p=M(p)),f=p,f}function yn(){let f,p;return f=g,p=Dc(),p!==e&&(Ae=f,p=j(p)),f=p,f}function Dc(){let f,p,A;for(f=g,p=[],A=Rr();A!==e;)p.push(A),A=Rr();return p!==e?f=r.substring(f,g):f=p,f}function Mc(){let f,p,A;if(f=g,p=[],A=Rr(),A!==e)for(;A!==e;)p.push(A),A=Rr();else p=e;return p!==e?f=r.substring(f,g):f=p,f}function Da(){let f,p,A,z;return f=g,p=dt(),p!==e?(A=Gc(),A!==e?(z=dt(),z!==e?(Ae=f,p=O(A),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function Nc(){let f,p,A,z,ue,Ce,at,Tt;if(f=g,p=g,A=g,z=dt(),z!==e)if(ue=Fc(),ue!==e)if(Ce=dt(),Ce!==e){for(at=[],Tt=Rr();Tt!==e;)at.push(Tt),Tt=Rr();at!==e?(Tt=dt(),Tt!==e?(z=[z,ue,Ce,at,Tt],A=z):(g=A,A=e)):(g=A,A=e)}else g=A,A=e;else g=A,A=e;else g=A,A=e;return A!==e?p=r.substring(p,g):p=A,p!==e&&(Ae=f,p=L(p)),f=p,f}function Fc(){let f;return r.substr(g,5).toLowerCase()===I?(f=r.substr(g,5),g+=5):(f=e,re===0&&ne(N)),f===e&&(r.substr(g,6).toLowerCase()===D?(f=r.substr(g,6),g+=6):(f=e,re===0&&ne(V)),f===e&&(r.substr(g,6).toLowerCase()===G?(f=r.substr(g,6),g+=6):(f=e,re===0&&ne(H)),f===e&&(r.substr(g,3).toLowerCase()===he?(f=r.substr(g,3),g+=3):(f=e,re===0&&ne(le)),f===e&&(r.substr(g,9).toLowerCase()===xe?(f=r.substr(g,9),g+=9):(f=e,re===0&&ne(Ee)),f===e&&(r.substr(g,12).toLowerCase()===ke?(f=r.substr(g,12),g+=12):(f=e,re===0&&ne(ie)),f===e&&(r.substr(g,5).toLowerCase()===Fe?(f=r.substr(g,5),g+=5):(f=e,re===0&&ne(Re)))))))),f}function Rr(){let f;return Me.test(r.charAt(g))?(f=r.charAt(g),g++):(f=e,re===0&&ne(ut)),f}function Rc(){let f,p,A,z;for(f=g,p=[],A=Ma();A!==e;)p.push(A),A=Ma();return p!==e?(A=Na(),A===e&&(A=null),A!==e?(z=zc(),z===e&&(z=null),z!==e?(Ae=f,p=$t(p,A),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function Kc(){let f,p,A,z,ue,Ce,at;return f=g,p=g,A=Ka(),A!==e?p=r.substring(p,g):p=A,p!==e?(A=dt(),A!==e?(z=Ra(),z!==e?(ue=dt(),ue!==e?(Ce=g,at=Ba(),at!==e?Ce=r.substring(Ce,g):Ce=at,Ce!==e?(Ae=f,p=Lt(p,Ce),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function Ma(){let f,p,A;return f=g,p=Na(),p!==e?(A=_n(),A!==e?(Ae=f,p=fe(p),f=p):(g=f,f=e)):(g=f,f=e),f}function Na(){let f;return f=Bc(),f===e&&(f=Fa()),f}function Bc(){let f,p,A,z,ue,Ce;return f=g,r.charCodeAt(g)===123?(p=Te,g++):(p=e,re===0&&ne(We)),p!==e?(A=dt(),A!==e?(z=Fa(),z!==e?(ue=dt(),ue!==e?(r.charCodeAt(g)===125?(Ce=Dt,g++):(Ce=e,re===0&&ne(gt)),Ce!==e?(Ae=f,p=Xt(z),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function Fa(){let f,p,A,z,ue,Ce,at;return f=g,p=g,A=Ka(),A!==e?p=r.substring(p,g):p=A,p!==e?(A=dt(),A!==e?(z=Ra(),z!==e?(ue=dt(),ue!==e?(Ce=g,at=Ba(),at!==e?Ce=r.substring(Ce,g):Ce=at,Ce!==e?(Ae=f,p=Zt(p,Ce),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function Ra(){let f;return r.charCodeAt(g)===58?(f=St,g++):(f=e,re===0&&ne(st)),f}function Ka(){let f,p;if(f=[],wt.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(Qt)),p!==e)for(;p!==e;)f.push(p),wt.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(Qt));else f=e;return f}function Ba(){let f,p;if(f=[],K.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(ft)),p!==e)for(;p!==e;)f.push(p),K.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(ft));else f=e;return f}function zc(){let f,p,A;return f=g,r.substr(g,3)===Mt?(p=Mt,g+=3):(p=e,re===0&&ne(it)),p!==e?(A=_n(),A!==e?(p=[p,A],f=p):(g=f,f=e)):(g=f,f=e),f}function dt(){let f,p;for(re++,f=[],Nt.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(Or));p!==e;)f.push(p),Nt.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(Or));return re--,f===e&&(p=e,re===0&&ne(ur)),f}function _n(){let f;return f=Va(),f===e&&(f=za(),f===e&&(f=Vc())),f}function Vc(){let f,p,A;return f=g,p=Va(),p!==e?(A=za(),A!==e?(p=[p,A],f=p):(g=f,f=e)):(g=f,f=e),f}function za(){let f;return r.charCodeAt(g)===10?(f=Ne,g++):(f=e,re===0&&ne(fr)),f}function Va(){let f;return r.charCodeAt(g)===13?(f=Lr,g++):(f=e,re===0&&ne(hr)),f}function Gc(){let f,p;return f=g,p=Hc(),p===e&&(p=Yc(),p===e&&(p=Uc())),p!==e&&(Ae=f,p=dr(p)),f=p,f}function Kr(){let f;return r.charCodeAt(g)===35?(f=Se,g++):(f=e,re===0&&ne(ln)),f===e&&(r.charCodeAt(g)===98?(f=mr,g++):(f=e,re===0&&ne(xt))),f}function ii(){let f,p;for(f=[],Jt.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(pr));p!==e;)f.push(p),Jt.test(r.charAt(g))?(p=r.charAt(g),g++):(p=e,re===0&&ne(pr));return f}function Uc(){let f,p,A,z,ue;return f=g,p=Ga(),p!==e?(A=Kr(),A===e&&(A=null),A!==e?(z=g,ue=ii(),ue!==e?z=r.substring(z,g):z=ue,z!==e?(ue=qc(),ue===e&&(ue=null),ue!==e?(Ae=f,p=br(p,A,z,ue),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function Ga(){let f;return cn.test(r.charAt(g))?(f=r.charAt(g),g++):(f=e,re===0&&ne(un)),f}function qc(){let f,p,A,z;return f=g,r.charCodeAt(g)===47?(p=y,g++):(p=e,re===0&&ne($)),p!==e?(A=Ga(),A!==e?(z=Kr(),z===e&&(z=null),z!==e?(Ae=f,p=Dr(A,z),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function Hc(){let f,p,A,z,ue;return f=g,p=Kr(),p===e&&(p=null),p!==e?(A=Ua(),A!==e?(z=g,ue=ii(),ue!==e?z=r.substring(z,g):z=ue,z!==e?(ue=Wc(),ue===e&&(ue=null),ue!==e?(Ae=f,p=fn(p,A,z,ue),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function Ua(){let f;return r.substr(g,3)===v?(f=v,g+=3):(f=e,re===0&&ne(de)),f===e&&(r.substr(g,3)===Ft?(f=Ft,g+=3):(f=e,re===0&&ne(w)),f===e&&(r.substr(g,3)===B?(f=B,g+=3):(f=e,re===0&&ne(R)),f===e&&(r.substr(g,3)===te?(f=te,g+=3):(f=e,re===0&&ne(_e)),f===e&&(r.substr(g,2)===Ye?(f=Ye,g+=2):(f=e,re===0&&ne(At)),f===e&&(r.substr(g,2)===Wn?(f=Wn,g+=2):(f=e,re===0&&ne(Yn)),f===e&&(r.substr(g,2)===hn?(f=hn,g+=2):(f=e,re===0&&ne(dn)),f===e&&(r.substr(g,2)===ae?(f=ae,g+=2):(f=e,re===0&&ne(Zs)),f===e&&(r.substr(g,2)===mn?(f=mn,g+=2):(f=e,re===0&&ne(Xn)),f===e&&(r.substr(g,2)===pn?(f=pn,g+=2):(f=e,re===0&&ne(Zn)),f===e&&(r.charCodeAt(g)===73?(f=Qs,g++):(f=e,re===0&&ne(Js)),f===e&&(r.charCodeAt(g)===105?(f=Qn,g++):(f=e,re===0&&ne(Jn)),f===e&&(r.charCodeAt(g)===86?(f=es,g++):(f=e,re===0&&ne(ts)),f===e&&(r.charCodeAt(g)===118?(f=bn,g++):(f=e,re===0&&ne(ei))))))))))))))),f}function Wc(){let f,p,A,z;return f=g,r.charCodeAt(g)===47?(p=y,g++):(p=e,re===0&&ne($)),p!==e?(A=Kr(),A===e&&(A=null),A!==e?(z=Ua(),z!==e?(Ae=f,p=rs(A,z),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function Yc(){let f,p,A,z,ue;return f=g,p=Kr(),p===e&&(p=null),p!==e?(A=qa(),A!==e?(z=g,ue=ii(),ue!==e?z=r.substring(z,g):z=ue,z!==e?(ue=Xc(),ue===e&&(ue=null),ue!==e?(Ae=f,p=ti(p,A,z,ue),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}function qa(){let f;return ri.test(r.charAt(g))?(f=r.charAt(g),g++):(f=e,re===0&&ne(ni)),f}function Xc(){let f,p,A,z;return f=g,r.charCodeAt(g)===47?(p=y,g++):(p=e,re===0&&ne($)),p!==e?(A=Kr(),A===e&&(A=null),A!==e?(z=qa(),z!==e?(Ae=f,p=rs(A,z),f=p):(g=f,f=e)):(g=f,f=e)):(g=f,f=e),f}if(Mr=i(),Mr!==e&&g===r.length)return Mr;throw Mr!==e&&g<r.length&&ne(Rt()),Fr(gn,ht<r.length?r.charAt(ht):null,ht<r.length?Nr(ht,ht+1):Nr(ht,ht))}const W1=H1;class Y1 extends xc{parse(t){return this.parseWithParser(t,W1)}}var X1=Y1;class Z1 extends va{format(t){const{bodyParagraphs:e,expandedBodyParagraphs:n}=t;return this.template({song:t,configuration:this.configuration,bodyParagraphs:this.configuration.expandChorusDirective?n:e})}static cssString(t=""){So("The class method cssString() was removed in favor of the instance PROPERTY. Please use `new <Formatter>().cssString` instead.")}cssString(t=""){return Kh(this.defaultCss,t)}static cssObject(){So("The class method cssObject() was removed in favor of the instance PROPERTY. Please use `new <Formatter>().cssObject` instead.")}get cssObject(){return this.defaultCss}}var Ec=Z1;function Q1(r,t){return/^\d+$/.test(r)?parseInt(r,10):Et.distance(t,r)}function J1(r,t,e,n){let s=-1*(r||0);return e&&(t&&(s+=Q1(t,e)),n&&(s+=Et.distance(e,n))),s}function Oa(r,t,e,{renderKey:n=null,useUnicodeModifier:s=!1,normalizeChords:i=!0}={}){var y;const a=Ws.parse(r),o=e.key,l=parseInt(e.metadata.getSingle(Hn),10);if(!a)return r;const u=J1(l,t.transposeKey,o,n),c=n||((y=Et.wrap(t.key||e.key))==null?void 0:y.transpose(u))||null,h=a.transpose(u);return(i?h.normalize(c):h).toString({useUnicodeModifier:s})}const ea=r=>r instanceof Je,La=r=>r.items.some(t=>t.isRenderable()),kc=r=>r instanceof De,Sc=r=>r.name==="comment";function Ac(r){return r.trim().replace(/(<\/[a-z]+>)\s+(<)/g,"$1$2").replace(/(\n)\s+/g,"")}function wr(r,t){return r.map(t).join("")}function Be(r,t){return r?t():""}const Tc=r=>r.items.some(t=>t instanceof Je&&!Hs(t.lyrics)||t instanceof De&&t.isRenderable()||_a(t)),Pc=r=>{const t=["row"];return La(r)||t.push("empty-line"),t.join(" ")},jc=r=>{const t=["paragraph"];return r.type!==ya&&r.type!==ar&&t.push(r.type),t.join(" ")},Ic=(r,t,e)=>{if(!t)throw new Error("cannot evaluate, metadata is null");return r.evaluate(t,e.get("metadata.separator"))};function sr(r){const t=r.toCssString();return t?` style="${t}"`:""}var ed=({configuration:r,configuration:{key:t},song:e,renderBlankLines:n=!1,song:{title:s,subtitle:i,metadata:a},bodyParagraphs:o})=>Ac(`
  ${Be(s,()=>`<h1>${s}</h1>`)}
  ${Be(i,()=>`<h2>${i}</h2>`)}
  
  <div class="chord-sheet">
    ${wr(o,l=>`
      <div class="${jc(l)}">
        ${wr(l.lines,u=>`
          ${Be(n||La(u),()=>`
            <div class="${Pc(u)}">
              ${wr(u.items,c=>`
                ${Be(ea(c),()=>`
                  <div class="column">
                    <div class="chord"${sr(u.chordFont)}>${Oa(c.chords,u,e,{renderKey:t,useUnicodeModifier:r.useUnicodeModifiers,normalizeChords:r.normalizeChords})}</div>
                    <div class="lyrics"${sr(u.textFont)}>${c.lyrics}</div>
                  </div>
                `)}
                
                ${Be(kc(c),()=>`
                  ${Be(Sc(c),()=>`
                    <div class="comment">${c.value}</div>
                  `)}
                  
                  ${Be(c.hasRenderableLabel(),()=>`
                    <h3 class="label">${c.value}</h3>
                  `)}
                `)}
                
                ${Be(_a(c),()=>`
                  <div class="column">
                    <div class="chord"></div>
                    <div class="lyrics"${sr(u.textFont)}>${Ic(c,a,r)}</div>
                  </div>
                `)}
              `)}
            </div>
          `)}
        `)}
      </div>
    `)}
  </div>
`);const td={".chord:not(:last-child)":{paddingRight:"10px"},".paragraph":{marginBottom:"1em"},".row":{display:"flex"},".chord:after":{content:"'\\200b'"},".lyrics:after":{content:"'\\200b'"}};class rd extends Ec{get template(){return ed}get defaultCss(){return td}}var nd=rd,sd=({configuration:r,configuration:{key:t},song:e,renderBlankLines:n=!1,song:{title:s,subtitle:i,bodyLines:a,metadata:o},bodyParagraphs:l})=>Ac(`
  ${Be(s,()=>`<h1>${s}</h1>`)}
  ${Be(i,()=>`<h2>${i}</h2>`)}

  ${Be(a.length>0,()=>`
    <div class="chord-sheet">
      ${wr(l,u=>`
        <div class="${jc(u)}">
          ${wr(u.lines,c=>`
            ${Be(n||La(c),()=>`
              <table class="${Pc(c)}">
                ${Be(sc(c),()=>`
                  <tr>
                    ${wr(c.items,h=>`
                      ${Be(ea(h),()=>`
                        <td class="chord"${sr(c.chordFont)}>${Oa(h.chords,c,e,{renderKey:t,useUnicodeModifier:r.useUnicodeModifiers,normalizeChords:r.normalizeChords})}</td>
                      `)}
                    `)}
                  </tr>
                `)}
                
                ${Be(Tc(c),()=>`
                  <tr>
                    ${wr(c.items,h=>`
                      ${Be(ea(h),()=>`
                        <td class="lyrics"${sr(c.textFont)}>${h.lyrics}</td>
                      `)}
                      
                      ${Be(kc(h),()=>`
                        ${Be(Sc(h),()=>`
                          <td class="comment"${sr(c.textFont)}>${h.value}</td>
                        `)}
                        
                        ${Be(h.hasRenderableLabel(),()=>`
                          <td><h3 class="label"${sr(c.textFont)}>${h.value}</h3></td>
                        `)}
                      `)}
                      
                      ${Be(_a(h),()=>`
                        <td class="lyrics"${sr(c.textFont)}>${Ic(h,o,r)}</td>
                      `)}
                    `)}
                  </tr>
                `)}
              </table>
            `)}
          `)}
        </div>
      `)}
    </div>
  `)}
`);const id={h1:{fontSize:"1.5em"},h2:{fontSize:"1.1em"},table:{borderSpacing:"0",color:"inherit"},td:{padding:"3px 0"},".chord:not(:last-child)":{paddingRight:"10px"},".paragraph":{marginBottom:"1em"}};class ad extends Ec{get template(){return sd}get defaultCss(){return id}}var od=ad;class ld extends va{constructor(){super(...arguments);Q(this,"song",new nn)}format(e){return this.song=e,[this.formatHeader(),this.formatParagraphs()].join("")}formatHeader(){const{title:e,subtitle:n}=this.song,s=e||n?`
`:"";return[this.formatTitle(e),this.formatSubTitle(n),s].join("")}formatParagraphs(){const{bodyParagraphs:e,expandedBodyParagraphs:n,metadata:s}=this.song,{expandChorusDirective:i}=this.configuration;return(i?n:e).map(a=>this.formatParagraph(a,s)).join(`

`)}formatParagraph(e,n){return e.lines.filter(s=>s.hasRenderableItems()).map(s=>this.formatLine(s,n)).join(`
`)}formatLine(e,n){return[this.formatLineTop(e,n),this.formatLineBottom(e,n)].filter(i=>!Hs(i)).map(i=>(i||"").trimRight()).join(`
`)}formatTitle(e){return e?`${e.toUpperCase()}
`:""}formatSubTitle(e){return e?`${e}
`:""}formatLineTop(e,n){return sc(e)?this.formatLineWithFormatter(e,this.formatItemTop,n):null}chordLyricsPairLength(e,n){const s=this.renderChords(e,n),{lyrics:i}=e,a=(s||"").length,o=(i||"").length;return a>=o?a+1:Math.max(a,o)}renderChords(e,n){return Oa(e.chords,n,this.song,{renderKey:this.configuration.key,useUnicodeModifier:this.configuration.useUnicodeModifiers,normalizeChords:this.configuration.normalizeChords})}formatItemTop(e,n,s){if(e instanceof De&&e.isRenderable())return e.value||"";if(e instanceof Je){const i=this.renderChords(e,s);return ko(i,this.chordLyricsPairLength(e,s))}return""}formatLineBottom(e,n){return Tc(e)?this.formatLineWithFormatter(e,this.formatItemBottom,n):""}formatLineWithFormatter(e,n,s){return e.items.map(i=>n.call(this,i,s,e)).join("")}formatItemBottom(e,n,s){return e instanceof De&&e.isRenderable()?e.value||"":e instanceof Je?ko(e.lyrics||"",this.chordLyricsPairLength(e,s)):"evaluate"in e?e.evaluate(n,this.configuration.get("metadata.separator")):""}}var cd=ld;const ud=/^\[Verse.*]/,fd=/^\[Chorus]/,No=/^\[([^\]]+)]/,Fo={[Pr]:Xs,[ir]:rn},_i={[Pr]:xa,[ir]:Rn};class hd extends Cc{constructor(){super(...arguments);Q(this,"currentSectionType",null)}parseLine(e){this.isSectionEnd()&&this.endSection(),ud.test(e)?(this.startNewLine(),this.startSection(Pr)):fd.test(e)?(this.startNewLine(),this.startSection(ir)):No.test(e)?this.parseMetadataLine(e):super.parseLine(e)}parseMetadataLine(e){this.startNewLine(),this.endSection();const n=e.match(No)[1];if(!this.songLine)throw new Error("Expected this.songLine to be present");this.songLine.addTag(new De($a,n))}isSectionEnd(){return this.songLine!==null&&this.songLine.isEmpty()&&this.song.previousLine!==null&&!this.song.previousLine.isEmpty()}endOfSong(){super.endOfSong(),this.currentSectionType!==null&&this.currentSectionType in _i&&this.startNewLine(),this.endSection({addNewLine:!1})}startSection(e){this.currentSectionType&&this.endSection(),this.currentSectionType=e,this.song.setCurrentProperties(e),e in Fo&&this.song.addTag(new De(Fo[e]))}endSection({addNewLine:e=!0}={}){this.currentSectionType!==null&&this.currentSectionType in _i&&(this.song.addTag(new De(_i[this.currentSectionType])),e&&this.startNewLine()),this.song.setCurrentProperties(ar),this.currentSectionType=null}startNewLine(){this.songLine=this.song.addLine()}}var dd=hd,md={ChordLyricsPair:Je,ChordProFormatter:A1,ChordProParser:G1,ChordSheetParser:Cc,ChordSheetSerializer:wc,ChordsOverWordsParser:X1,Comment:An,Composite:Zi,HtmlDivFormatter:nd,HtmlTableFormatter:od,Line:Qi,Literal:Bn,Metadata:$c,Paragraph:Ji,Song:nn,Tag:De,Ternary:Kn,TextFormatter:cd,UltimateGuitarParser:dd,CHORUS:ir,INDETERMINATE:ya,NONE:ar,TAB:Hi,VERSE:Pr};function pd(r){let t,e,n,s="",i,a,o,l,u,c;const h=r[4].default,m=au(h,r,r[3],null);return{c(){t=W("div"),e=W("div"),n=W("button"),n.textContent=s,i=$e(),m&&m.c(),this.h()},l(y){t=Y(y,"DIV",{class:!0,style:!0});var $=U(t);e=Y($,"DIV",{class:!0,style:!0});var _=U(e);n=Y(_,"BUTTON",{class:!0,["data-svelte-h"]:!0}),yt(n)!=="svelte-qc1bif"&&(n.textContent=s),i=we(_),m&&m.l(_),_.forEach(P),$.forEach(P),this.h()},h(){C(n,"class","bg-letkwet-500 rounded-full text-white absolute -top-2 -right-2 w-10 h-10 text-xl font-bold"),C(e,"class","container svelte-1pawiih"),C(e,"style",a=`width: ${r[1]};`),C(t,"class","backdrop svelte-1pawiih"),C(t,"style",o=r[0]?"display: flex;":"")},m(y,$){X(y,t,$),F(t,e),F(e,n),F(e,i),m&&m.m(e,null),l=!0,u||(c=[ze(window,"keydown",r[6]),ze(n,"click",r[7]),ze(e,"click",ou(r[5])),ze(t,"click",r[8])],u=!0)},p(y,[$]){m&&m.p&&(!l||$&8)&&lu(m,h,y,y[3],l?uu(h,y[3],$,null):cu(y[3]),null),(!l||$&2&&a!==(a=`width: ${y[1]};`))&&C(e,"style",a),(!l||$&1&&o!==(o=y[0]?"display: flex;":""))&&C(t,"style",o)},i(y){l||(ce(m,y),l=!0)},o(y){be(m,y),l=!1},d(y){y&&P(t),m&&m.d(y),u=!1,Vn(c)}}}function bd(r,t,e){let{$$slots:n={},$$scope:s}=t,{open:i=!1,width:a="auto"}=t;const o=zn();function l(m){$i.call(this,r,m)}const u=m=>{m.key==="Escape"&&o("close")},c=()=>o("close"),h=()=>o("close");return r.$$set=m=>{"open"in m&&e(0,i=m.open),"width"in m&&e(1,a=m.width),"$$scope"in m&&e(3,s=m.$$scope)},[i,a,o,s,n,l,u,c,h]}class gd extends lt{constructor(t){super(),ct(this,t,bd,pd,ot,{open:0,width:1})}}function Ro(r,t,e){const n=r.slice();return n[7]=t[e],n[9]=e,n}function yd(r){let t,e,n;return{c(){t=Oe("text"),e=me(r[2]),n=me("fr"),this.h()},l(s){t=Le(s,"text",{class:!0,fill:!0,x:!0,y:!0});var i=U(t);e=pe(i,r[2]),n=pe(i,"fr"),i.forEach(P),this.h()},h(){C(t,"class","eng"),C(t,"fill","#444"),C(t,"x","-12"),C(t,"y","8")},m(s,i){X(s,t,i),F(t,e),F(t,n)},p(s,i){i&4&&He(e,s[2])},d(s){s&&P(t)}}}function _d(r){let t,e;return{c(){t=Oe("path"),this.h()},l(n){t=Le(n,"path",{stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),U(t).forEach(P),this.h()},h(){C(t,"stroke","#444"),C(t,"stroke-width","2"),C(t,"stroke-linecap","round"),C(t,"stroke-linejoin","round"),C(t,"d",e=`M ${r[4][r[1]].x} 0 H ${r[4][r[1]].length}`)},m(n,s){X(n,t,s)},p(n,s){s&2&&e!==(e=`M ${n[4][n[1]].x} 0 H ${n[4][n[1]].length}`)&&C(t,"d",e)},d(n){n&&P(t)}}}function Ko(r){let t,e=Ge(r[0]),n=[];for(let s=0;s<e.length;s+=1)n[s]=Bo(Ro(r,e,s));return{c(){t=Oe("g");for(let s=0;s<n.length;s+=1)n[s].c()},l(s){t=Le(s,"g",{});var i=U(t);for(let a=0;a<n.length;a+=1)n[a].l(i);i.forEach(P)},m(s,i){X(s,t,i);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(t,null)},p(s,i){if(i&19){e=Ge(s[0]);let a;for(a=0;a<e.length;a+=1){const o=Ro(s,e,a);n[a]?n[a].p(o,i):(n[a]=Bo(o),n[a].c(),n[a].m(t,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=e.length}},d(s){s&&P(t),It(n,s)}}}function Bo(r){let t,e=r[7]+"",n,s;return{c(){t=Oe("text"),n=me(e),this.h()},l(i){t=Le(i,"text",{class:!0,"text-anchor":!0,fill:!0,x:!0,y:!0});var a=U(t);n=pe(a,e),a.forEach(P),this.h()},h(){C(t,"class","eng"),C(t,"text-anchor","middle"),C(t,"fill","#444"),C(t,"x",s=r[4][r[1]].x+r[9]*10),C(t,"y","53")},m(i,a){X(i,t,a),F(t,n)},p(i,a){a&1&&e!==(e=i[7]+"")&&He(n,e),a&2&&s!==(s=i[4][i[1]].x+i[9]*10)&&C(t,"x",s)},d(i){i&&P(t)}}}function vd(r){let t,e,n;function s(l,u){return l[2]===0?_d:yd}let i=s(r),a=i(r),o=!r[3]&&Ko(r);return{c(){t=Oe("g"),e=Oe("path"),a.c(),n=ve(),o&&o.c(),this.h()},l(l){t=Le(l,"g",{});var u=U(t);e=Le(u,"path",{stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),U(e).forEach(P),a.l(u),n=ve(),o&&o.l(u),u.forEach(P),this.h()},h(){C(e,"stroke","#444"),C(e,"stroke-width","0.25"),C(e,"stroke-linecap","square"),C(e,"stroke-linejoin","miter"),C(e,"d",r[5])},m(l,u){X(l,t,u),F(t,e),a.m(t,null),F(t,n),o&&o.m(t,null)},p(l,[u]){i===(i=s(l))&&a?a.p(l,u):(a.d(1),a=i(l),a&&(a.c(),a.m(t,n))),l[3]?o&&(o.d(1),o=null):o?o.p(l,u):(o=Ko(l),o.c(),o.m(t,null))},i:Z,o:Z,d(l){l&&P(t),a.d(),o&&o.d()}}}function $d(r,t,e){const n={4:{x:10,y:10,length:40},6:{x:0,y:0,length:50}};let{tuning:s,strings:i,baseFret:a=1,fretsOnChord:o,lite:l=!1}=t,u=Array((o||0)+1).fill(null).map((c,h)=>`M ${n[i].x} ${12*h} H ${n[i].length}`).join(" ")+" "+Array(i).fill(null).map((c,h)=>`M ${n[i].y+h*10} 0 V 48`).join(" ");return r.$$set=c=>{"tuning"in c&&e(0,s=c.tuning),"strings"in c&&e(1,i=c.strings),"baseFret"in c&&e(2,a=c.baseFret),"fretsOnChord"in c&&e(6,o=c.fretsOnChord),"lite"in c&&e(3,l=c.lite)},[s,i,a,l,n,u,o]}class wd extends lt{constructor(t){super(),ct(this,t,$d,vd,ot,{tuning:0,strings:1,baseFret:2,fretsOnChord:6,lite:3})}}const Oc={4:0,6:-1};function xd(r){let t,e,n,s,i,a=!r[2]&&r[0]>0&&r[1]&&r[1]>0&&zo(r);return{c(){t=Oe("g"),e=Oe("circle"),a&&a.c(),this.h()},l(o){t=Le(o,"g",{});var l=U(t);e=Le(l,"circle",{"stroke-width":!0,stroke:!0,fill:!0,cx:!0,cy:!0,r:!0}),U(e).forEach(P),a&&a.l(l),l.forEach(P),this.h()},h(){C(e,"stroke-width","0.25"),C(e,"stroke","#444"),C(e,"fill",n=r[0]===0?"transparent":"#444"),C(e,"cx",r[3]),C(e,"cy",s=r[4].fret[r[0]]),C(e,"r",i=r[0]===0?r[5].open:r[5].fret)},m(o,l){X(o,t,l),F(t,e),a&&a.m(t,null)},p(o,l){l&1&&n!==(n=o[0]===0?"transparent":"#444")&&C(e,"fill",n),l&8&&C(e,"cx",o[3]),l&1&&s!==(s=o[4].fret[o[0]])&&C(e,"cy",s),l&1&&i!==(i=o[0]===0?o[5].open:o[5].fret)&&C(e,"r",i),!o[2]&&o[0]>0&&o[1]&&o[1]>0?a?a.p(o,l):(a=zo(o),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(o){o&&P(t),a&&a.d()}}}function Cd(r){let t,e;return{c(){t=Oe("text"),e=me(""),this.h()},l(n){t=Le(n,"text",{class:!0,"text-anchor":!0,fill:!0,x:!0,y:!0});var s=U(t);e=pe(s,""),s.forEach(P),this.h()},h(){C(t,"class","eng"),C(t,"text-anchor","middle"),C(t,"fill","#444"),C(t,"x",r[3]),C(t,"y","-2")},m(n,s){X(n,t,s),F(t,e)},p(n,s){s&8&&C(t,"x",n[3])},d(n){n&&P(t)}}}function zo(r){let t,e,n,s;return{c(){t=Oe("text"),e=me(r[1]),s=me(`
      }`),this.h()},l(i){t=Le(i,"text",{fill:!0,"text-anchor":!0,style:!0,x:!0,y:!0});var a=U(t);e=pe(a,r[1]),a.forEach(P),s=pe(i,`
      }`),this.h()},h(){C(t,"fill","white"),C(t,"text-anchor","middle"),ks(t,"font-weight","bold"),C(t,"x",r[3]),C(t,"y",n=r[4].finger[r[0]]-.5)},m(i,a){X(i,t,a),F(t,e),X(i,s,a)},p(i,a){a&2&&He(e,i[1]),a&8&&C(t,"x",i[3]),a&1&&n!==(n=i[4].finger[i[0]]-.5)&&C(t,"y",n)},d(i){i&&(P(t),P(s))}}}function Ed(r){let t;function e(i,a){return i[0]===-1?Cd:xd}let n=e(r),s=n(r);return{c(){s.c(),t=ve()},l(i){s.l(i),t=ve()},m(i,a){s.m(i,a),X(i,t,a)},p(i,[a]){n===(n=e(i))&&s?s.p(i,a):(s.d(1),s=n(i),s&&(s.c(),s.m(t.parentNode,t)))},i:Z,o:Z,d(i){i&&P(t),s.d(i)}}}function kd(r,t,e){let n,{string:s,fret:i=0,finger:a,strings:o,lite:l=!1}=t;const u={string:[50,40,30,20,10,0],fret:[-4,6.5,18,30,42,54],finger:[-3,8,19.5,31.5,43.5]},c={open:2,fret:4};return r.$$set=h=>{"string"in h&&e(6,s=h.string),"fret"in h&&e(0,i=h.fret),"finger"in h&&e(1,a=h.finger),"strings"in h&&e(7,o=h.strings),"lite"in h&&e(2,l=h.lite)},r.$$.update=()=>{r.$$.dirty&192&&e(3,n=u.string[s+Oc[o]])},[i,a,l,n,u,c,s,o]}class Sd extends lt{constructor(t){super(),ct(this,t,kd,Ed,ot,{string:6,fret:0,finger:1,strings:7,lite:2})}}function Vo(r,t,e){const n=r.slice();return n[15]=t[e],n}function Go(r,t,e){const n=r.slice();return n[15]=t[e],n}function Uo(r){let t,e,n,s,i,a,o,l,u;return{c(){t=Oe("g"),e=Oe("g"),n=Oe("path"),i=Oe("rect"),o=Oe("g"),l=Oe("path"),this.h()},l(c){t=Le(c,"g",{});var h=U(t);e=Le(h,"g",{transform:!0});var m=U(e);n=Le(m,"path",{d:!0,fill:!0,"fill-opacity":!0,transform:!0}),U(n).forEach(P),m.forEach(P),i=Le(h,"rect",{fill:!0,x:!0,y:!0,width:!0,"fill-opacity":!0,height:!0}),U(i).forEach(P),o=Le(h,"g",{transform:!0});var y=U(o);l=Le(y,"path",{d:!0,fill:!0,"fill-opacity":!0,transform:!0}),U(l).forEach(P),y.forEach(P),h.forEach(P),this.h()},h(){C(n,"d","M 0, 0 m -4, 0 a 4,4 0 1,1 8,0"),C(n,"fill","#555"),C(n,"fill-opacity",.2),C(n,"transform","rotate(-90)"),C(e,"transform",s=`translate(${r[11](r[12],r[12])}, ${r[10].fret[r[4][0].value]})`),C(i,"fill","#555"),C(i,"x",r[8][r[12]][0]),C(i,"y",a=r[9][r[0]-1]),C(i,"width",(r[12]-1)*10),C(i,"fill-opacity",.2),C(i,"height","8.5"),C(l,"d","M 0, 0 m -4, 0 a 4,4 0 1,1 8,0"),C(l,"fill","#555"),C(l,"fill-opacity",.2),C(l,"transform","rotate(90)"),C(o,"transform",u=`translate(${r[11](1,r[12])}, ${r[10].fret[r[4][0].value]})`)},m(c,h){X(c,t,h),F(t,e),F(e,n),F(t,i),F(t,o),F(o,l)},p(c,h){h&16&&s!==(s=`translate(${c[11](c[12],c[12])}, ${c[10].fret[c[4][0].value]})`)&&C(e,"transform",s),h&1&&a!==(a=c[9][c[0]-1])&&C(i,"y",a),h&16&&u!==(u=`translate(${c[11](1,c[12])}, ${c[10].fret[c[4][0].value]})`)&&C(o,"transform",u)},d(c){c&&P(t)}}}function qo(r){let t,e,n;return{c(){t=Oe("circle"),this.h()},l(s){t=Le(s,"circle",{"stroke-width":!0,stroke:!0,fill:!0,cx:!0,cy:!0,r:!0}),U(t).forEach(P),this.h()},h(){C(t,"stroke-width","0.25"),C(t,"stroke","#444"),C(t,"fill","#444"),C(t,"cx",e=r[11](r[12]-r[15].position,r[12])),C(t,"cy",n=r[10].fret[r[15].value]),C(t,"r","4")},m(s,i){X(s,t,i)},p(s,i){i&16&&e!==(e=s[11](s[12]-s[15].position,s[12]))&&C(t,"cx",e),i&16&&n!==(n=s[10].fret[s[15].value])&&C(t,"cy",n)},d(s){s&&P(t)}}}function Ho(r){let t,e=Ge(r[4]),n=[];for(let s=0;s<e.length;s+=1)n[s]=Wo(Vo(r,e,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();t=ve()},l(s){for(let i=0;i<n.length;i+=1)n[i].l(s);t=ve()},m(s,i){for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(s,i);X(s,t,i)},p(s,i){if(i&7192){e=Ge(s[4]);let a;for(a=0;a<e.length;a+=1){const o=Vo(s,e,a);n[a]?n[a].p(o,i):(n[a]=Wo(o),n[a].c(),n[a].m(t.parentNode,t))}for(;a<n.length;a+=1)n[a].d(1);n.length=e.length}},d(s){s&&P(t),It(n,s)}}}function Wo(r){let t,e,n,s;return{c(){t=Oe("text"),e=me(r[3]),this.h()},l(i){t=Le(i,"text",{"text-anchor":!0,fill:!0,x:!0,y:!0});var a=U(t);e=pe(a,r[3]),a.forEach(P),this.h()},h(){C(t,"text-anchor","middle"),C(t,"fill","white"),C(t,"x",n=r[11](r[12]-r[15].position,r[12])),C(t,"y",s=r[10].finger[r[15].value]-.5)},m(i,a){X(i,t,a),F(t,e)},p(i,a){a&8&&He(e,i[3]),a&16&&n!==(n=i[11](i[12]-i[15].position,i[12]))&&C(t,"x",n),a&16&&s!==(s=i[10].finger[i[15].value]-.5)&&C(t,"y",s)},d(i){i&&P(t)}}}function Ad(r){let t,e,n,s,i=r[1]&&r[4].length>0&&Uo(r),a=Ge(r[4]),o=[];for(let u=0;u<a.length;u+=1)o[u]=qo(Go(r,a,u));let l=!r[2]&&r[3]&&Ho(r);return{c(){t=Oe("g"),i&&i.c(),e=ve();for(let u=0;u<o.length;u+=1)o[u].c();n=Oe("rect"),l&&l.c(),this.h()},l(u){t=Le(u,"g",{});var c=U(t);i&&i.l(c),e=ve();for(let h=0;h<o.length;h+=1)o[h].l(c);n=Le(c,"rect",{fill:!0,x:!0,y:!0,width:!0,height:!0}),U(n).forEach(P),l&&l.l(c),c.forEach(P),this.h()},h(){C(n,"fill","#444"),C(n,"x",s=r[8][r[12]][r[5]]),C(n,"y",r[7]),C(n,"width",r[6]),C(n,"height",8.25)},m(u,c){X(u,t,c),i&&i.m(t,null),F(t,e);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(t,null);F(t,n),l&&l.m(t,null)},p(u,[c]){if(u[1]&&u[4].length>0?i?i.p(u,c):(i=Uo(u),i.c(),i.m(t,e)):i&&(i.d(1),i=null),c&7184){a=Ge(u[4]);let h;for(h=0;h<a.length;h+=1){const m=Go(u,a,h);o[h]?o[h].p(m,c):(o[h]=qo(m),o[h].c(),o[h].m(t,n))}for(;h<o.length;h+=1)o[h].d(1);o.length=a.length}c&32&&s!==(s=u[8][u[12]][u[5]])&&C(n,"x",s),c&128&&C(n,"y",u[7]),c&64&&C(n,"width",u[6]),!u[2]&&u[3]?l?l.p(u,c):(l=Ho(u),l.c(),l.m(t,null)):l&&(l.d(1),l=null)},i:Z,o:Z,d(u){u&&P(t),i&&i.d(),It(o,u),l&&l.d()}}}function Td(r,t,e){let{frets:n,barre:s,capo:i=!1,lite:a=!1,finger:o}=t;const l={4:[10,20,30,40,50],6:[0,10,20,30,40,50]},u=[2.35,13.9,26,38],c={string:[50,40,30,20,10,0],fret:[-4,6.5,18,30,42,54],finger:[-3,8,19.5,31.5,43.5]},h=(E,M)=>c.string[E+Oc[M]];let m=[],y=n.length,$=0,_=0,S=0,x=0;return r.$$set=E=>{"frets"in E&&e(13,n=E.frets),"barre"in E&&e(0,s=E.barre),"capo"in E&&e(1,i=E.capo),"lite"in E&&e(2,a=E.lite),"finger"in E&&e(3,o=E.finger)},r.$$.update=()=>{r.$$.dirty&24625&&(e(4,m=n.map((E,M)=>({position:M,value:E})).filter(E=>E.value===s)),e(5,$=m.length>0?m[0].position:0),e(14,_=m.length>0?m[m.length-1].position:0),e(6,S=(_-$)*10),e(7,x=u[s-1]))},[s,i,a,o,m,$,S,x,l,u,c,h,y,n,_]}class Pd extends lt{constructor(t){super(),ct(this,t,Td,Ad,ot,{frets:13,barre:0,capo:1,lite:2,finger:3})}}function Yo(r,t,e){const n=r.slice();return n[8]=t[e],n}function Xo(r,t,e){const n=r.slice();return n[11]=t[e],n[13]=e,n}function Zo(r){let t,e,n=Ge(r[0].barres),s=[];for(let a=0;a<n.length;a+=1)s[a]=Qo(Xo(r,n,a));const i=a=>be(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();t=ve()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);t=ve()},m(a,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,o);X(a,t,o),e=!0},p(a,o){if(o&5){n=Ge(a[0].barres);let l;for(l=0;l<n.length;l+=1){const u=Xo(a,n,l);s[l]?(s[l].p(u,o),ce(s[l],1)):(s[l]=Qo(u),s[l].c(),ce(s[l],1),s[l].m(t.parentNode,t))}for(_t(),l=n.length;l<s.length;l+=1)i(l);vt()}},i(a){if(!e){for(let o=0;o<n.length;o+=1)ce(s[o]);e=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)be(s[o]);e=!1},d(a){a&&P(t),It(s,a)}}}function Qo(r){let t,e;return t=new Pd({props:{capo:r[13]===0&&r[0].capo,barre:r[11],finger:r[0].fingers?r[0].fingers[r[0].frets.indexOf(r[11])]:null,frets:r[0].frets,lite:r[2]}}),{c(){et(t.$$.fragment)},l(n){bt(t.$$.fragment,n)},m(n,s){tt(t,n,s),e=!0},p(n,s){const i={};s&1&&(i.capo=n[13]===0&&n[0].capo),s&1&&(i.barre=n[11]),s&1&&(i.finger=n[0].fingers?n[0].fingers[n[0].frets.indexOf(n[11])]:null),s&1&&(i.frets=n[0].frets),s&4&&(i.lite=n[2]),t.$set(i)},i(n){e||(ce(t.$$.fragment,n),e=!0)},o(n){be(t.$$.fragment,n),e=!1},d(n){rt(t,n)}}}function Jo(r){let t,e;return t=new Sd({props:{string:r[1].strings-r[8].position,fret:r[8].value,strings:r[1].strings,finger:r[0].fingers?r[0].fingers[r[8].position]:null,lite:r[2]}}),{c(){et(t.$$.fragment)},l(n){bt(t.$$.fragment,n)},m(n,s){tt(t,n,s),e=!0},p(n,s){const i={};s&3&&(i.string=n[1].strings-n[8].position),s&1&&(i.fret=n[8].value),s&2&&(i.strings=n[1].strings),s&1&&(i.finger=n[0].fingers?n[0].fingers[n[8].position]:null),s&4&&(i.lite=n[2]),t.$set(i)},i(n){e||(ce(t.$$.fragment,n),e=!0)},o(n){be(t.$$.fragment,n),e=!1},d(n){rt(t,n)}}}function jd(r){let t,e,n,s,i,a,o;n=new wd({props:{tuning:r[1].tuning,strings:r[1].strings,fretsOnChord:r[1].fretsOnChord,baseFret:r[0].baseFret,lite:r[2]}});let l=r[0].barres&&Zo(r),u=Ge(r[4](r[0])),c=[];for(let m=0;m<u.length;m+=1)c[m]=Jo(Yo(r,u,m));const h=m=>be(c[m],1,1,()=>{c[m]=null});return{c(){t=Oe("svg"),e=Oe("g"),et(n.$$.fragment),l&&l.c(),s=ve();for(let m=0;m<c.length;m+=1)c[m].c();this.h()},l(m){t=Le(m,"svg",{width:!0,xmlns:!0,preserveAspectRatio:!0,viewBox:!0,class:!0});var y=U(t);e=Le(y,"g",{transform:!0});var $=U(e);bt(n.$$.fragment,$),l&&l.l($),s=ve();for(let _=0;_<c.length;_+=1)c[_].l($);$.forEach(P),y.forEach(P),this.h()},h(){C(e,"transform","translate(13, 13)"),C(t,"width","100%"),C(t,"xmlns","http://www.w3.org/2000/svg"),C(t,"preserveAspectRatio","xMinYMin meet"),C(t,"viewBox","0 5 75 65"),C(t,"class","svelte-1a0c8ce")},m(m,y){X(m,t,y),F(t,e),tt(n,e,null),l&&l.m(e,null),F(e,s);for(let $=0;$<c.length;$+=1)c[$]&&c[$].m(e,null);r[6](t),i=!0,a||(o=ze(t,"click",r[5],!0),a=!0)},p(m,[y]){const $={};if(y&2&&($.tuning=m[1].tuning),y&2&&($.strings=m[1].strings),y&2&&($.fretsOnChord=m[1].fretsOnChord),y&1&&($.baseFret=m[0].baseFret),y&4&&($.lite=m[2]),n.$set($),m[0].barres?l?(l.p(m,y),y&1&&ce(l,1)):(l=Zo(m),l.c(),ce(l,1),l.m(e,s)):l&&(_t(),be(l,1,1,()=>{l=null}),vt()),y&23){u=Ge(m[4](m[0]));let _;for(_=0;_<u.length;_+=1){const S=Yo(m,u,_);c[_]?(c[_].p(S,y),ce(c[_],1)):(c[_]=Jo(S),c[_].c(),ce(c[_],1),c[_].m(e,null))}for(_t(),_=u.length;_<c.length;_+=1)h(_);vt()}},i(m){if(!i){ce(n.$$.fragment,m),ce(l);for(let y=0;y<u.length;y+=1)ce(c[y]);i=!0}},o(m){be(n.$$.fragment,m),be(l),c=c.filter(Boolean);for(let y=0;y<c.length;y+=1)be(c[y]);i=!1},d(m){m&&P(t),rt(n),l&&l.d(),It(c,m),r[6](null),a=!1,o()}}}function Id(r,t,e){let{chord:n,instrument:s,lite:i=!1}=t,a;const o=h=>h.frets.map((m,y)=>({position:y,value:m})).filter(m=>!h.barres||h.barres.indexOf(m.value)===-1),l=zn();function u(h){l("clickPos",{x:h.offsetX/a.clientWidth,y:h.offsetY/a.clientHeight})}function c(h){Tn[h?"unshift":"push"](()=>{a=h,e(3,a)})}return r.$$set=h=>{"chord"in h&&e(0,n=h.chord),"instrument"in h&&e(1,s=h.instrument),"lite"in h&&e(2,i=h.lite)},[n,s,i,a,o,u,c]}class Od extends lt{constructor(t){super(),ct(this,t,Id,jd,ot,{chord:0,instrument:1,lite:2})}}function el(r,t,e){const n=r.slice();return n[10]=t[e],n}function tl(r){let t,e,n,s,i,a,o,l,u,c,h,m,y,$,_,S,x,E,M,j,O,L,I=Ge(r[0]),N=[];for(let V=0;V<I.length;V+=1)N[V]=rl(el(r,I,V));const D=V=>be(N[V],1,1,()=>{N[V]=null});return{c(){t=W("span"),e=me(r[1]),n=$e(),s=W("div"),i=W("div");for(let V=0;V<N.length;V+=1)N[V].c();a=$e(),o=W("div"),l=W("button"),u=me("<"),h=$e(),m=W("strong"),y=me(r[4]),$=me(" / "),_=me(r[5]),S=$e(),x=W("button"),E=me(">"),this.h()},l(V){t=Y(V,"SPAN",{class:!0});var G=U(t);e=pe(G,r[1]),G.forEach(P),n=we(V),s=Y(V,"DIV",{class:!0});var H=U(s);i=Y(H,"DIV",{class:!0,style:!0});var he=U(i);for(let ie=0;ie<N.length;ie+=1)N[ie].l(he);he.forEach(P),H.forEach(P),a=we(V),o=Y(V,"DIV",{class:!0});var le=U(o);l=Y(le,"BUTTON",{class:!0});var xe=U(l);u=pe(xe,"<"),xe.forEach(P),h=we(le),m=Y(le,"STRONG",{class:!0});var Ee=U(m);y=pe(Ee,r[4]),$=pe(Ee," / "),_=pe(Ee,r[5]),Ee.forEach(P),S=we(le),x=Y(le,"BUTTON",{class:!0});var ke=U(x);E=pe(ke,">"),ke.forEach(P),le.forEach(P),this.h()},h(){C(t,"class","eng chord-name svelte-1mv8nun"),C(i,"class","slide svelte-1mv8nun"),ks(i,"margin-left",(r[4]-1)*-250+"px"),C(s,"class","slider svelte-1mv8nun"),C(l,"class","button-outline eng svelte-1mv8nun"),l.disabled=c=r[4]<=1,C(m,"class","eng"),C(x,"class","button-outline eng svelte-1mv8nun"),x.disabled=M=r[4]===r[5],C(o,"class","slider-nav svelte-1mv8nun")},m(V,G){X(V,t,G),F(t,e),X(V,n,G),X(V,s,G),F(s,i);for(let H=0;H<N.length;H+=1)N[H]&&N[H].m(i,null);X(V,a,G),X(V,o,G),F(o,l),F(l,u),F(o,h),F(o,m),F(m,y),F(m,$),F(m,_),F(o,S),F(o,x),F(x,E),j=!0,O||(L=[ze(l,"click",r[7]),ze(x,"click",r[8])],O=!0)},p(V,G){if((!j||G&2)&&He(e,V[1]),G&5){I=Ge(V[0]);let H;for(H=0;H<I.length;H+=1){const he=el(V,I,H);N[H]?(N[H].p(he,G),ce(N[H],1)):(N[H]=rl(he),N[H].c(),ce(N[H],1),N[H].m(i,null))}for(_t(),H=I.length;H<N.length;H+=1)D(H);vt()}(!j||G&16)&&ks(i,"margin-left",(V[4]-1)*-250+"px"),(!j||G&16&&c!==(c=V[4]<=1))&&(l.disabled=c),(!j||G&16)&&He(y,V[4]),(!j||G&32)&&He(_,V[5]),(!j||G&48&&M!==(M=V[4]===V[5]))&&(x.disabled=M)},i(V){if(!j){for(let G=0;G<I.length;G+=1)ce(N[G]);j=!0}},o(V){N=N.filter(Boolean);for(let G=0;G<N.length;G+=1)be(N[G]);j=!1},d(V){V&&(P(t),P(n),P(s),P(a),P(o)),It(N,V),O=!1,Vn(L)}}}function rl(r){let t,e,n,s;return e=new Od({props:{instrument:r[2],chord:r[10]}}),{c(){t=W("div"),et(e.$$.fragment),n=$e(),this.h()},l(i){t=Y(i,"DIV",{class:!0});var a=U(t);bt(e.$$.fragment,a),n=we(a),a.forEach(P),this.h()},h(){C(t,"class","svelte-1mv8nun")},m(i,a){X(i,t,a),tt(e,t,null),F(t,n),s=!0},p(i,a){const o={};a&4&&(o.instrument=i[2]),a&1&&(o.chord=i[10]),e.$set(o)},i(i){s||(ce(e.$$.fragment,i),s=!0)},o(i){be(e.$$.fragment,i),s=!1},d(i){i&&P(t),rt(e)}}}function Ld(r){let t,e,n=r[5]>0&&tl(r);return{c(){n&&n.c(),t=ve()},l(s){n&&n.l(s),t=ve()},m(s,i){n&&n.m(s,i),X(s,t,i),e=!0},p(s,i){s[5]>0?n?(n.p(s,i),i&32&&ce(n,1)):(n=tl(s),n.c(),ce(n,1),n.m(t.parentNode,t)):n&&(_t(),be(n,1,1,()=>{n=null}),vt())},i(s){e||(ce(n),e=!0)},o(s){be(n),e=!1},d(s){s&&P(t),n&&n.d(s)}}}function Dd(r){let t,e;return t=new gd({props:{open:r[3],$$slots:{default:[Ld]},$$scope:{ctx:r}}}),t.$on("close",r[9]),{c(){et(t.$$.fragment)},l(n){bt(t.$$.fragment,n)},m(n,s){tt(t,n,s),e=!0},p(n,[s]){const i={};s&8&&(i.open=n[3]),s&8247&&(i.$$scope={dirty:s,ctx:n}),t.$set(i)},i(n){e||(ce(t.$$.fragment,n),e=!0)},o(n){be(t.$$.fragment,n),e=!1},d(n){rt(t,n)}}}function Md(r,t,e){let n;const s=zn();let{chordsInfo:i,chordDisplay:a="",instrument:o,open:l=!1}=t,u=1;const c=()=>e(4,u--,u),h=()=>e(4,u++,u),m=()=>{e(4,u=1),s("close")};return r.$$set=y=>{"chordsInfo"in y&&e(0,i=y.chordsInfo),"chordDisplay"in y&&e(1,a=y.chordDisplay),"instrument"in y&&e(2,o=y.instrument),"open"in y&&e(3,l=y.open)},r.$$.update=()=>{r.$$.dirty&1&&e(5,n=i.length)},[i,a,o,l,u,n,s,c,h,m]}class Nd extends lt{constructor(t){super(),ct(this,t,Md,Dd,ot,{chordsInfo:0,chordDisplay:1,instrument:2,open:3})}}const vi=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Fd={Db:"C#",Eb:"D#",Gb:"F#",Ab:"G#",Bb:"A#"},J={maj:["ma","maj","M",""],min:["min","m","-"],sus2:["sus2","2"],sus4:["sus","sus4"],dim:["dim","o"],halfDim:["m7b5","m7(b5)","0"],aug:["aug","+"],5:["5"],6:["6"],7:["7"],9:["9"],add9:["add9","(9)"],maj7:["ma7","maj7","M7"],min7:["min7","m7"],mM7:["mM7","m(M7)","min(maj7)"]},nl={instrument:{tuning:["E","A","D","G","B","E"],fretsOnChord:4,name:"guitar",strings:6},chordShapes:[{suffix:J.maj,baseKey:"C",shape:[-1,3,2,0,1,0]},{suffix:J.sus2,baseKey:"C",shape:[-1,3,0,0,1,0]},{suffix:J.sus4,baseKey:"C",shape:[-1,3,3,0,1,1]},{suffix:J.aug,baseKey:"C",shape:[-1,3,2,1,1,3]},{suffix:J[6],baseKey:"C",shape:[-1,3,2,2,1,0]},{suffix:J[7],baseKey:"C",shape:[-1,3,2,3,1,0]},{suffix:J[9],baseKey:"C",shape:[-1,3,2,3,3,-1]},{suffix:J.add9,baseKey:"C",shape:[-1,3,2,0,3,3]},{suffix:J.maj7,baseKey:"C",shape:[-1,3,2,0,0,0]},{suffix:J.mM7,baseKey:"C",shape:[-1,3,1,0,0,0]},{suffix:J.maj,baseKey:"A",shape:[-1,0,2,2,2,0]},{suffix:J.min,baseKey:"A",shape:[-1,0,2,2,1,0]},{suffix:J.sus2,baseKey:"A",shape:[-1,0,2,2,0,0]},{suffix:J.sus4,baseKey:"A",shape:[-1,0,2,2,3,0]},{suffix:J.dim,baseKey:"A",shape:[-1,0,1,2,1,0]},{suffix:J.halfDim,baseKey:"A",shape:[-1,0,1,0,1,-1]},{suffix:J.aug,baseKey:"A",shape:[-1,0,3,2,2,0]},{suffix:J[5],baseKey:"A",shape:[-1,0,2,-1,-1,-1]},{suffix:J[6],baseKey:"A",shape:[-1,0,2,2,2,2]},{suffix:J[7],baseKey:"A",shape:[-1,0,2,0,2,0]},{suffix:J.maj7,baseKey:"A",shape:[-1,0,2,1,2,0]},{suffix:J.min7,baseKey:"A",shape:[-1,0,2,0,1,0]},{suffix:J.mM7,baseKey:"A",shape:[-1,0,2,1,1,0]},{suffix:J.maj,baseKey:"G",shape:[3,2,0,0,0,3]},{suffix:J.min,baseKey:"G",shape:[3,1,0,0,-1,-1]},{suffix:J.sus2,baseKey:"G",shape:[3,2,0,2,0,3]},{suffix:J.sus4,baseKey:"G",shape:[3,2,0,0,1,3]},{suffix:J[6],baseKey:"G",shape:[3,2,0,0,1,0]},{suffix:J[7],baseKey:"G",shape:[3,2,0,0,0,1]},{suffix:J.maj7,baseKey:"G",shape:[3,2,0,0,0,2]},{suffix:J.maj,baseKey:"E",shape:[0,2,2,1,0,0]},{suffix:J.min,baseKey:"E",shape:[0,2,2,0,0,0]},{suffix:J.sus2,baseKey:"E",shape:[0,2,4,1,0,0]},{suffix:J.sus4,baseKey:"E",shape:[0,2,2,2,0,0]},{suffix:J.dim,baseKey:"E",shape:[0,1,2,0,4,0]},{suffix:J.halfDim,baseKey:"E",shape:[0,1,0,0,3,0]},{suffix:J.aug,baseKey:"E",shape:[0,3,2,1,1,0]},{suffix:J[5],baseKey:"E",shape:[0,2,-1,-1,-1,-1]},{suffix:J[6],baseKey:"E",shape:[0,2,2,1,2,0]},{suffix:J[7],baseKey:"E",shape:[0,2,0,1,0,0]},{suffix:J.maj7,baseKey:"E",shape:[0,2,1,1,0,0]},{suffix:J.min7,baseKey:"E",shape:[0,2,0,0,0,0]},{suffix:J.mM7,baseKey:"E",shape:[0,2,1,0,0,0]},{suffix:J.maj,baseKey:"D",shape:[-1,-1,0,2,3,2]},{suffix:J.min,baseKey:"D",shape:[-1,-1,0,2,3,1]},{suffix:J.sus2,baseKey:"D",shape:[-1,-1,0,2,3,0]},{suffix:J.sus4,baseKey:"D",shape:[-1,-1,0,2,3,3]},{suffix:J.dim,baseKey:"D",shape:[-1,-1,0,1,3,1]},{suffix:J.halfDim,baseKey:"D",shape:[-1,-1,0,1,1,1]},{suffix:J.aug,baseKey:"D",shape:[-1,-1,0,3,3,2]},{suffix:J[6],baseKey:"D",shape:[-1,-1,0,2,0,2]},{suffix:J[7],baseKey:"D",shape:[-1,-1,0,2,1,2]},{suffix:J.maj7,baseKey:"D",shape:[-1,-1,0,2,2,2]},{suffix:J.min7,baseKey:"D",shape:[-1,-1,0,2,1,1]},{suffix:J.mM7,baseKey:"D",shape:[-1,-1,0,2,2,1]}],getChords(r,t="maj"){return r.includes("b")&&(r=Fd[r]),r?this.chordShapes.filter(e=>e.suffix.includes(t)).map(({baseKey:e,shape:n})=>{let s=vi.indexOf(r)-vi.indexOf(e);return s<0&&(s=vi.length+s),{baseFret:s,frets:s===0?n:n.map(i=>i>=0?i+1:i)}}).sort((e,n)=>(e.baseFret||0)-(n.baseFret||0)):[]}};function sl(r,t,e){const n=r.slice();return n[31]=t[e],n}function il(r){let t,e,n=Ge(r[9]),s=[];for(let i=0;i<n.length;i+=1)s[i]=al(sl(r,n,i));return{c(){t=me(`- 
    `);for(let i=0;i<s.length;i+=1)s[i].c();e=ve()},l(i){t=pe(i,`- 
    `);for(let a=0;a<s.length;a+=1)s[a].l(i);e=ve()},m(i,a){X(i,t,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(i,a);X(i,e,a)},p(i,a){if(a[0]&512){n=Ge(i[9]);let o;for(o=0;o<n.length;o+=1){const l=sl(i,n,o);s[o]?s[o].p(l,a):(s[o]=al(l),s[o].c(),s[o].m(e.parentNode,e))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},d(i){i&&(P(t),P(e)),It(s,i)}}}function al(r){let t,e=r[31]+"",n,s,i;return{c(){t=W("a"),n=me(e),i=me(`
        `),this.h()},l(a){t=Y(a,"A",{href:!0,class:!0});var o=U(t);n=pe(o,e),o.forEach(P),i=pe(a,`
        `),this.h()},h(){C(t,"href",s=`#/artist/${r[31]}`),C(t,"class","text-letkwet-500")},m(a,o){X(a,t,o),F(t,n),X(a,i,o)},p(a,o){o[0]&512&&e!==(e=a[31]+"")&&He(n,e),o[0]&512&&s!==(s=`#/artist/${a[31]}`)&&C(t,"href",s)},d(a){a&&(P(t),P(i))}}}function Rd(r){let t,e='<svg xmlns="http://www.w3.org/2000/svg" fill="#fff" viewBox="0 0 576 512"><path d="M320 224H416c17.67 0 32-14.33 32-32s-14.33-32-32-32h-95.1c-17.67 0-32 14.33-32 32S302.3 224 320 224zM320 352H480c17.67 0 32-14.33 32-32s-14.33-32-32-32h-159.1c-17.67 0-32 14.33-32 32S302.3 352 320 352zM320 96h32c17.67 0 31.1-14.33 31.1-32s-14.33-32-31.1-32h-32c-17.67 0-32 14.33-32 32S302.3 96 320 96zM544 416h-223.1c-17.67 0-32 14.33-32 32s14.33 32 32 32H544c17.67 0 32-14.33 32-32S561.7 416 544 416zM192.4 330.7L160 366.1V64.03C160 46.33 145.7 32 128 32S96 46.33 96 64.03v302L63.6 330.7c-6.312-6.883-14.94-10.38-23.61-10.38c-7.719 0-15.47 2.781-21.61 8.414c-13.03 11.95-13.9 32.22-1.969 45.27l87.1 96.09c12.12 13.26 35.06 13.26 47.19 0l87.1-96.09c11.94-13.05 11.06-33.31-1.969-45.27C224.6 316.8 204.4 317.7 192.4 330.7z"></path></svg>',n,s;return{c(){t=W("button"),t.innerHTML=e,this.h()},l(i){t=Y(i,"BUTTON",{class:!0,title:!0,["data-svelte-h"]:!0}),yt(t)!=="svelte-sdwfks"&&(t.innerHTML=e),this.h()},h(){C(t,"class","w-10 h-10 rounded bg-green-500 text-white p-3"),C(t,"title","Auto-scroll")},m(i,a){X(i,t,a),n||(s=ze(t,"click",r[21]),n=!0)},p:Z,d(i){i&&P(t),n=!1,s()}}}function Kd(r){let t,e,n,s,i,a,o,l,u,c,h='<svg xmlns="http://www.w3.org/2000/svg" fill="#fff" viewBox="0 0 512 512"><path d="M256 0C114.6 0 0 114.6 0 256c0 141.4 114.6 256 256 256s256-114.6 256-256C512 114.6 397.4 0 256 0zM352 328c0 13.2-10.8 24-24 24h-144C170.8 352 160 341.2 160 328v-144C160 170.8 170.8 160 184 160h144C341.2 160 352 170.8 352 184V328z"></path></svg>',m,y;return{c(){t=W("button"),e=Oe("svg"),n=Oe("path"),i=$e(),a=W("b"),o=me("x"),l=me(r[2]),u=$e(),c=W("button"),c.innerHTML=h,this.h()},l($){t=Y($,"BUTTON",{class:!0,title:!0});var _=U(t);e=Le(_,"svg",{xmlns:!0,fill:!0,viewBox:!0});var S=U(e);n=Le(S,"path",{d:!0}),U(n).forEach(P),S.forEach(P),_.forEach(P),i=we($),a=Y($,"B",{class:!0});var x=U(a);o=pe(x,"x"),l=pe(x,r[2]),x.forEach(P),u=we($),c=Y($,"BUTTON",{class:!0,title:!0,["data-svelte-h"]:!0}),yt(c)!=="svelte-f27xbg"&&(c.innerHTML=h),this.h()},h(){C(n,"d","M169.4 278.6C175.6 284.9 183.8 288 192 288s16.38-3.125 22.62-9.375l160-160c12.5-12.5 12.5-32.75 0-45.25s-32.75-12.5-45.25 0L192 210.8L54.63 73.38c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25L169.4 278.6zM329.4 265.4L192 402.8L54.63 265.4c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25l160 160C175.6 476.9 183.8 480 192 480s16.38-3.125 22.62-9.375l160-160c12.5-12.5 12.5-32.75 0-45.25S341.9 252.9 329.4 265.4z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","#fff"),C(e,"viewBox","0 0 384 512"),t.disabled=s=r[2]>=4,C(t,"class","w-10 h-10 rounded bg-green-500 text-white p-4"),C(t,"title","Speed Up"),C(a,"class","text-center"),C(c,"class","w-10 h-10 rounded bg-green-500 text-white p-3"),C(c,"title","Speed Up")},m($,_){X($,t,_),F(t,e),F(e,n),X($,i,_),X($,a,_),F(a,o),F(a,l),X($,u,_),X($,c,_),m||(y=[ze(t,"click",r[19]),ze(c,"click",r[20])],m=!0)},p($,_){_[0]&4&&s!==(s=$[2]>=4)&&(t.disabled=s),_[0]&4&&He(l,$[2])},d($){$&&(P(t),P(i),P(a),P(u),P(c)),m=!1,Vn(y)}}}function Bd(r){let t=!1,e=()=>{t=!1},n,s,i,a,o,l,u,c,h,m,y,$,_,S,x,E="",M,j,O,L,I,N,D="",V,G,H,he,le,xe,Ee,ke;fu(r[15]);let ie=r[9]&&il(r);function Fe(fe,Te){return fe[2]>0?Kd:Rd}let Re=Fe(r),Me=Re(r);function ut(fe){r[23](fe)}function $t(fe){r[24](fe)}let Lt={instrument:r[11],open:r[6]};return r[4]!==void 0&&(Lt.chordsInfo=r[4]),r[5]!==void 0&&(Lt.chordDisplay=r[5]),H=new Nd({props:Lt}),Tn.push(()=>Za(H,"chordsInfo",ut)),Tn.push(()=>Za(H,"chordDisplay",$t)),H.$on("close",r[25]),{c(){s=W("div"),i=W("div"),a=W("span"),o=me(r[8]),l=$e(),ie&&ie.c(),u=$e(),c=W("div"),h=W("article"),m=W("div"),y=new hu(!1),$=$e(),_=W("div"),S=W("div"),x=W("button"),x.textContent=E,M=$e(),j=W("button"),O=me(r[7]),I=$e(),N=W("button"),N.textContent=D,V=$e(),Me.c(),G=$e(),et(H.$$.fragment),this.h()},l(fe){s=Y(fe,"DIV",{class:!0});var Te=U(s);i=Y(Te,"DIV",{class:!0});var We=U(i);a=Y(We,"SPAN",{class:!0});var Dt=U(a);o=pe(Dt,r[8]),Dt.forEach(P),l=we(We),ie&&ie.l(We),We.forEach(P),u=we(Te),c=Y(Te,"DIV",{class:!0,style:!0});var gt=U(c);h=Y(gt,"ARTICLE",{class:!0});var Xt=U(h);m=Y(Xt,"DIV",{});var Zt=U(m);y=du(Zt,!1),Zt.forEach(P),Xt.forEach(P),$=we(gt),_=Y(gt,"DIV",{class:!0});var St=U(_);S=Y(St,"DIV",{class:!0});var st=U(S);x=Y(st,"BUTTON",{class:!0,["data-svelte-h"]:!0}),yt(x)!=="svelte-xrnsp6"&&(x.textContent=E),M=we(st),j=Y(st,"BUTTON",{class:!0});var wt=U(j);O=pe(wt,r[7]),wt.forEach(P),I=we(st),N=Y(st,"BUTTON",{class:!0,["data-svelte-h"]:!0}),yt(N)!=="svelte-13kg417"&&(N.textContent=D),V=we(st),Me.l(st),st.forEach(P),St.forEach(P),gt.forEach(P),Te.forEach(P),G=we(fe),bt(H.$$.fragment,fe),this.h()},h(){C(a,"class","text-bold"),C(i,"class","p-2"),y.a=null,C(h,"class","grow"),C(x,"class","w-10 h-10 rounded bg-letkwet-500 text-white font-bold text-xl"),C(j,"class","w-10 h-10 rounded bg-gray-500 text-white font-bold text-xl"),j.disabled=L=r[7]==0,C(N,"class","w-10 h-10 rounded bg-letkwet-500 text-white font-bold text-xl"),C(S,"class","sticky top-2 gap-2 flex flex-col"),C(_,"class","pr-2"),C(c,"class","flex"),ks(c,"align-items","stretch"),C(s,"class","flex flex-col mt-4")},m(fe,Te){X(fe,s,Te),F(s,i),F(i,a),F(a,o),F(i,l),ie&&ie.m(i,null),F(s,u),F(s,c),F(c,h),F(h,m),y.m(r[10],m),F(c,$),F(c,_),F(_,S),F(S,x),F(S,M),F(S,j),F(j,O),F(S,I),F(S,N),F(S,V),Me.m(S,null),r[22](s),X(fe,G,Te),tt(H,fe,Te),xe=!0,Ee||(ke=[ze(window,"scroll",()=>{t=!0,clearTimeout(n),n=setTimeout(e,100),r[15]()}),ze(h,"click",r[12]),ze(x,"click",r[16]),ze(j,"click",r[17]),ze(N,"click",r[18])],Ee=!0)},p(fe,Te){Te[0]&2&&!t&&(t=!0,clearTimeout(n),scrollTo(window.pageXOffset,fe[1]),n=setTimeout(e,100)),(!xe||Te[0]&256)&&He(o,fe[8]),fe[9]?ie?ie.p(fe,Te):(ie=il(fe),ie.c(),ie.m(i,null)):ie&&(ie.d(1),ie=null),(!xe||Te[0]&1024)&&y.p(fe[10]),(!xe||Te[0]&128)&&He(O,fe[7]),(!xe||Te[0]&128&&L!==(L=fe[7]==0))&&(j.disabled=L),Re===(Re=Fe(fe))&&Me?Me.p(fe,Te):(Me.d(1),Me=Re(fe),Me&&(Me.c(),Me.m(S,null)));const We={};Te[0]&64&&(We.open=fe[6]),!he&&Te[0]&16&&(he=!0,We.chordsInfo=fe[4],Ya(()=>he=!1)),!le&&Te[0]&32&&(le=!0,We.chordDisplay=fe[5],Ya(()=>le=!1)),H.$set(We)},i(fe){xe||(ce(H.$$.fragment,fe),xe=!0)},o(fe){be(H.$$.fragment,fe),xe=!1},d(fe){fe&&(P(s),P(G)),ie&&ie.d(),Me.d(),r[22](null),rt(H,fe),Ee=!1,Vn(ke)}}}const zd=/(([A-G][\#b]?)([A-Za-z\d\#\/\(\)]{0,9}))/m;function Vd(r){const t=zd.exec(r);if(t){const[e,n,s,i]=t;return[s,i||""]}return[r,""]}function Gd(r,t,e){let n,s;const{ChordProParser:i,HtmlDivFormatter:a}=md;let{song:o}=t,l=[],u,c=!1,h=0,m,y,$=0,_;const S=new i,x=new a;let E,M;const j=nl.instrument,O={};function L(ie){const Fe=ie.target;if(Fe instanceof HTMLElement){if((Fe==null?void 0:Fe.className.split(" ").indexOf("chord"))<0)return;const Re=Fe.innerText;if(O[Re])e(4,l=O[Re]),e(6,c=!0);else{const[Me,ut]=Vd(Re),$t=nl.getChords(Me,ut);$t.length>0&&(e(4,l=$t),O[Re]=$t,e(6,c=!0))}}}function I(){e(1,y=window.pageYOffset)}const N=()=>{e(3,n=n.transposeDown()),e(7,h--,h)},D=()=>{e(3,n=n.transpose(h*-1)),e(7,h=0)},V=()=>{e(3,n=n.transposeUp()),e(7,h++,h)},G=()=>e(2,$++,$),H=()=>e(2,$=0),he=()=>e(2,$++,$);function le(ie){Tn[ie?"unshift":"push"](()=>{m=ie,e(0,m)})}function xe(ie){l=ie,e(4,l)}function Ee(ie){u=ie,e(5,u)}const ke=()=>e(6,c=!1);return r.$$set=ie=>{"song"in ie&&e(13,o=ie.song)},r.$$.update=()=>{if(r.$$.dirty[0]&8192&&o&&e(7,h=0),r.$$.dirty[0]&8192&&e(3,n=S.parse(o)),r.$$.dirty[0]&8&&n&&(e(8,E=n.title),n.artist===void 0||Array.isArray(n.artist)?e(9,M=n.artist):e(9,M=[n.artist])),r.$$.dirty[0]&8&&e(10,s=x.format(n).replace(/<h1>.+<\/h1>/,"")),r.$$.dirty[0]&16391)if($>0){_&&clearInterval(_);const ie=m.scrollHeight/(420-$*60)/5;e(14,_=setInterval(()=>{e(1,y+=ie),y>=m.scrollHeight&&clearInterval(_)},100))}else clearInterval(_)},[m,y,$,n,l,u,c,h,E,M,s,j,L,o,_,I,N,D,V,G,H,he,le,xe,Ee,ke]}class Lc extends lt{constructor(t){super(),ct(this,t,Gd,Bd,ot,{song:13},null,[-1,-1])}}function ol(r){let t,e,n,s={ctx:r,current:null,token:null,hasCatch:!1,pending:Hd,then:qd,catch:Ud,value:2,blocks:[,,,]};return Ut(e=r[0],s),{c(){t=ve(),s.block.c()},l(i){t=ve(),s.block.l(i)},m(i,a){X(i,t,a),s.block.m(i,s.anchor=a),s.mount=()=>t.parentNode,s.anchor=t,n=!0},p(i,a){r=i,s.ctx=r,a&1&&e!==(e=r[0])&&Ut(e,s)||Pn(s,r,a)},i(i){n||(ce(s.block),n=!0)},o(i){for(let a=0;a<3;a+=1){const o=s.blocks[a];be(o)}n=!1},d(i){i&&P(t),s.block.d(i),s.token=null,s=null}}}function Ud(r){return{c:Z,l:Z,m:Z,p:Z,i:Z,o:Z,d:Z}}function qd(r){let t,e,n=r[2]&&ll(r);return{c(){n&&n.c(),t=ve()},l(s){n&&n.l(s),t=ve()},m(s,i){n&&n.m(s,i),X(s,t,i),e=!0},p(s,i){s[2]?n?(n.p(s,i),i&1&&ce(n,1)):(n=ll(s),n.c(),ce(n,1),n.m(t.parentNode,t)):n&&(_t(),be(n,1,1,()=>{n=null}),vt())},i(s){e||(ce(n),e=!0)},o(s){be(n),e=!1},d(s){s&&P(t),n&&n.d(s)}}}function ll(r){let t,e;return t=new Lc({props:{song:r[2].lyrics}}),{c(){et(t.$$.fragment)},l(n){bt(t.$$.fragment,n)},m(n,s){tt(t,n,s),e=!0},p(n,s){const i={};s&1&&(i.song=n[2].lyrics),t.$set(i)},i(n){e||(ce(t.$$.fragment,n),e=!0)},o(n){be(t.$$.fragment,n),e=!1},d(n){rt(t,n)}}}function Hd(r){return{c:Z,l:Z,m:Z,p:Z,i:Z,o:Z,d:Z}}function Wd(r){let t,e,n=r[0]&&ol(r);return{c(){t=W("div"),n&&n.c()},l(s){t=Y(s,"DIV",{});var i=U(t);n&&n.l(i),i.forEach(P)},m(s,i){X(s,t,i),n&&n.m(t,null),e=!0},p(s,[i]){s[0]?n?(n.p(s,i),i&1&&ce(n,1)):(n=ol(s),n.c(),ce(n,1),n.m(t,null)):n&&(_t(),be(n,1,1,()=>{n=null}),vt())},i(s){e||(ce(n),e=!0)},o(s){be(n),e=!1},d(s){s&&P(t),n&&n.d()}}}function Yd(r,t,e){let n,{params:s={song:null}}=t;return r.$$set=i=>{"params"in i&&e(1,s=i.params)},r.$$.update=()=>{r.$$.dirty&2&&e(0,n=s.song!==null?kr.songs.get(s.song):null)},[n,s]}class Xd extends lt{constructor(t){super(),ct(this,t,Yd,Wd,ot,{params:1})}}function cl(r,t,e){const n=r.slice();return n[3]=t[e],n}function ul(r){let t,e,n={ctx:r,current:null,token:null,hasCatch:!1,pending:Jd,then:Qd,catch:Zd,value:2};return Ut(e=r[1],n),{c(){t=ve(),n.block.c()},l(s){t=ve(),n.block.l(s)},m(s,i){X(s,t,i),n.block.m(s,n.anchor=i),n.mount=()=>t.parentNode,n.anchor=t},p(s,i){r=s,n.ctx=r,i&2&&e!==(e=r[1])&&Ut(e,n)||Pn(n,r,i)},d(s){s&&P(t),n.block.d(s),n.token=null,n=null}}}function Zd(r){return{c:Z,l:Z,m:Z,p:Z,d:Z}}function Qd(r){let t,e=r[2]&&fl(r);return{c(){e&&e.c(),t=ve()},l(n){e&&e.l(n),t=ve()},m(n,s){e&&e.m(n,s),X(n,t,s)},p(n,s){n[2]?e?e.p(n,s):(e=fl(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){n&&P(t),e&&e.d(n)}}}function fl(r){let t,e=r[0].artist+"",n,s,i,a,o=Ge(r[2]),l=[];for(let u=0;u<o.length;u+=1)l[u]=hl(cl(r,o,u));return{c(){t=W("h3"),n=me(e),s=me(" "),i=$e(),a=W("div");for(let u=0;u<l.length;u+=1)l[u].c();this.h()},l(u){t=Y(u,"H3",{class:!0});var c=U(t);n=pe(c,e),s=pe(c," "),c.forEach(P),i=we(u),a=Y(u,"DIV",{class:!0});var h=U(a);for(let m=0;m<l.length;m+=1)l[m].l(h);h.forEach(P),this.h()},h(){C(t,"class","text-lg font-bold my-4 px-10"),C(a,"class","flex flex-col")},m(u,c){X(u,t,c),F(t,n),F(t,s),X(u,i,c),X(u,a,c);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(a,null)},p(u,c){if(c&1&&e!==(e=u[0].artist+"")&&He(n,e),c&2){o=Ge(u[2]);let h;for(h=0;h<o.length;h+=1){const m=cl(u,o,h);l[h]?l[h].p(m,c):(l[h]=hl(m),l[h].c(),l[h].m(a,null))}for(;h<l.length;h+=1)l[h].d(1);l.length=o.length}},d(u){u&&(P(t),P(i),P(a)),It(l,u)}}}function hl(r){let t,e,n=r[3].title+"",s,i,a;return{c(){t=W("a"),e=me(" "),s=me(n),i=$e(),this.h()},l(o){t=Y(o,"A",{href:!0,class:!0});var l=U(t);e=pe(l," "),s=pe(l,n),i=we(l),l.forEach(P),this.h()},h(){C(t,"href",a=`#/song/${r[3].key}`),C(t,"class","text-letkwet-600 border-t-2 py-4 px-8")},m(o,l){X(o,t,l),F(t,e),F(t,s),F(t,i)},p(o,l){l&2&&n!==(n=o[3].title+"")&&He(s,n),l&2&&a!==(a=`#/song/${o[3].key}`)&&C(t,"href",a)},d(o){o&&P(t)}}}function Jd(r){return{c:Z,l:Z,m:Z,p:Z,d:Z}}function em(r){let t,e=r[1]&&ul(r);return{c(){t=W("div"),e&&e.c()},l(n){t=Y(n,"DIV",{});var s=U(t);e&&e.l(s),s.forEach(P)},m(n,s){X(n,t,s),e&&e.m(t,null)},p(n,[s]){n[1]?e?e.p(n,s):(e=ul(n),e.c(),e.m(t,null)):e&&(e.d(1),e=null)},i:Z,o:Z,d(n){n&&P(t),e&&e.d()}}}function tm(r,t,e){let n,{params:s={artist:null}}=t;return r.$$set=i=>{"params"in i&&e(0,s=i.params)},r.$$.update=()=>{r.$$.dirty&1&&e(1,n=s.artist!==null?kr.songs.where("artists").equalsIgnoreCase(s.artist).toArray():null)},[s,n]}class rm extends lt{constructor(t){super(),ct(this,t,tm,em,ot,{params:0})}}function nm(r){let t,e="   ";return{c(){t=W("div"),t.textContent=e,this.h()},l(n){t=Y(n,"DIV",{class:!0,["data-svelte-h"]:!0}),yt(t)!=="svelte-19rk3sy"&&(t.textContent=e),this.h()},h(){C(t,"class","text-gray-500 mt-40 mx-auto w-3/4 text-center")},m(n,s){X(n,t,s)},p:Z,i:Z,o:Z,d(n){n&&P(t)}}}class sm extends lt{constructor(t){super(),ct(this,t,null,nm,ot,{})}}function dl(r){let t,e;return t=new Lc({props:{song:r[2]}}),{c(){et(t.$$.fragment)},l(n){bt(t.$$.fragment,n)},m(n,s){tt(t,n,s),e=!0},p(n,s){const i={};s&4&&(i.song=n[2]),t.$set(i)},i(n){e||(ce(t.$$.fragment,n),e=!0)},o(n){be(t.$$.fragment,n),e=!1},d(n){rt(t,n)}}}function im(r){let t,e,n,s="Chord pro (.cho, .chopro, .chord)  ",i,a,o,l,u,c,h,m,y,$,_=r[2]&&dl(r);return{c(){t=W("div"),e=W("div"),n=W("label"),n.textContent=s,i=$e(),a=W("br"),o=$e(),l=W("br"),u=$e(),c=W("input"),h=$e(),_&&_.c(),this.h()},l(S){t=Y(S,"DIV",{class:!0});var x=U(t);e=Y(x,"DIV",{});var E=U(e);n=Y(E,"LABEL",{for:!0,class:!0,["data-svelte-h"]:!0}),yt(n)!=="svelte-61fw2d"&&(n.textContent=s),i=we(E),a=Y(E,"BR",{}),o=we(E),l=Y(E,"BR",{}),u=we(E),c=Y(E,"INPUT",{name:!0,class:!0,type:!0,accept:!0}),E.forEach(P),h=we(x),_&&_.l(x),x.forEach(P),this.h()},h(){C(n,"for","chofile"),C(n,"class","text-md text-gray-600 font-bold"),C(c,"name","chofile"),C(c,"class","text-center cursor-pointer text-gray-400 file:rounded file:bg-letkwet-200 file:text-letkwet-600 file:px-4 file:py-2 file:border-0 "),C(c,"type","file"),C(c,"accept",".cho,.chopro,.chord"),C(t,"class","flex flex-col gap-4 py-4")},m(S,x){X(S,t,x),F(t,e),F(e,n),F(e,i),F(e,a),F(e,o),F(e,l),F(e,u),F(e,c),r[3](c),F(t,h),_&&_.m(t,null),m=!0,y||($=ze(c,"change",r[4]),y=!0)},p(S,[x]){S[2]?_?(_.p(S,x),x&4&&ce(_,1)):(_=dl(S),_.c(),ce(_,1),_.m(t,null)):_&&(_t(),be(_,1,1,()=>{_=null}),vt())},i(S){m||(ce(_),m=!0)},o(S){be(_),m=!1},d(S){S&&P(t),r[3](null),_&&_.d(),y=!1,$()}}}function am(r,t,e){let n,s,i;function a(l){Tn[l?"unshift":"push"](()=>{s=l,e(1,s)})}function o(){n=this.files,e(0,n)}return r.$$.update=()=>{if(r.$$.dirty&1&&n&&n.length>0){const[l]=n;l.size<512e3&&l.text().then(u=>e(2,i=u))}},[n,s,i,a,o]}class om extends lt{constructor(t){super(),ct(this,t,am,im,ot,{})}}function lm(r){let t,e;return t=new Yl({props:{routes:r[2]}}),{c(){et(t.$$.fragment)},l(n){bt(t.$$.fragment,n)},m(n,s){tt(t,n,s),e=!0},p:Z,i(n){e||(ce(t.$$.fragment,n),e=!0)},o(n){be(t.$$.fragment,n),e=!1},d(n){rt(t,n)}}}function cm(r){let t,e;return t=new Yl({props:{routes:r[2]}}),{c(){et(t.$$.fragment)},l(n){bt(t.$$.fragment,n)},m(n,s){tt(t,n,s),e=!0},p:Z,i(n){e||(ce(t.$$.fragment,n),e=!0)},o(n){be(t.$$.fragment,n),e=!1},d(n){rt(t,n)}}}function um(r){let t,e="...";return{c(){t=W("div"),t.textContent=e,this.h()},l(n){t=Y(n,"DIV",{class:!0,["data-svelte-h"]:!0}),yt(t)!=="svelte-1em2us4"&&(t.textContent=e),this.h()},h(){C(t,"class","text-letkwet-500 font-bold mt-40 mx-auto w-3/4 text-center")},m(n,s){X(n,t,s)},p:Z,i:Z,o:Z,d(n){n&&P(t)}}}function fm(r){let t,e,n,s,i,a,o,l,u,c,h,m="",y,$,_="",S,x,E,M,j,O,L;x=new Pf({props:{query:r[1]}}),x.$on("selected",r[3]);let I={ctx:r,current:null,token:null,hasCatch:!0,pending:um,then:cm,catch:lm,blocks:[,,,]};return Ut(r[4],I),{c(){t=W("main"),e=W("nav"),n=W("div"),s=W("a"),i=W("img"),o=$e(),l=W("div"),u=W("input"),c=$e(),h=W("button"),h.textContent=m,y=$e(),$=W("a"),$.textContent=_,S=$e(),et(x.$$.fragment),E=$e(),M=W("div"),I.block.c(),this.h()},l(N){t=Y(N,"MAIN",{class:!0});var D=U(t);e=Y(D,"NAV",{});var V=U(e);n=Y(V,"DIV",{class:!0});var G=U(n);s=Y(G,"A",{href:!0});var H=U(s);i=Y(H,"IMG",{src:!0,class:!0,alt:!0}),H.forEach(P),o=we(G),l=Y(G,"DIV",{class:!0});var he=U(l);u=Y(he,"INPUT",{placeholder:!0,class:!0}),c=we(he),h=Y(he,"BUTTON",{class:!0,["data-svelte-h"]:!0}),yt(h)!=="svelte-42mvbl"&&(h.textContent=m),he.forEach(P),y=we(G),$=Y(G,"A",{href:!0,title:!0,class:!0,["data-svelte-h"]:!0}),yt($)!=="svelte-vnp6nu"&&($.textContent=_),G.forEach(P),V.forEach(P),S=we(D),bt(x.$$.fragment,D),E=we(D),M=Y(D,"DIV",{});var le=U(M);I.block.l(le),le.forEach(P),D.forEach(P),this.h()},h(){mu(i.src,a=gs+"/letkwet.svg")||C(i,"src",a),C(i,"class","w-8"),C(i,"alt","Letkwet"),C(s,"href","#"),C(u,"placeholder","  "),C(u,"class","w-20 border rounded p-2 w-full"),C(h,"class","absolute right-2 top-1 text-gray-400 text-lg"),C(l,"class","grow relative"),C($,"href","#/file"),C($,"title","Load local chord pro file"),C($,"class","text-xl"),C(n,"class","flex gap-4 py-2 px-4 items-center"),C(t,"class","max-w-lg mx-auto")},m(N,D){X(N,t,D),F(t,e),F(e,n),F(n,s),F(s,i),F(n,o),F(n,l),F(l,u),Xa(u,r[0]),F(l,c),F(l,h),F(n,y),F(n,$),F(t,S),tt(x,t,null),F(t,E),F(t,M),I.block.m(M,I.anchor=null),I.mount=()=>M,I.anchor=null,j=!0,O||(L=[ze(u,"input",r[5]),ze(h,"click",r[3])],O=!0)},p(N,[D]){r=N,D&1&&u.value!==r[0]&&Xa(u,r[0]);const V={};D&2&&(V.query=r[1]),x.$set(V),Pn(I,r,D)},i(N){j||(ce(x.$$.fragment,N),ce(I.block),j=!0)},o(N){be(x.$$.fragment,N);for(let D=0;D<3;D+=1){const V=I.blocks[D];be(V)}j=!1},d(N){N&&P(t),rt(x),I.block.d(),I.token=null,I=null,O=!1,Vn(L)}}}function hm(r=400){let t;return e=>{clearTimeout(t),t=setTimeout(()=>{e()},r)}}function dm(r,t,e){const n={"/artist/:artist":rm,"/song/:song":Xd,"/file":om,"*":sm};let s="",i="";const a=hm();function o(){e(0,s=""),e(1,i="")}let l=kr._meta.limit(1).first().then(async c=>{if(c){const h=await fetch(`${gs}/songs.json`,{method:"HEAD"});if(h.ok){const m=h.headers.get("Last-Modified"),y=m?Date.parse(m):0;if(c.last_modified<y){const $=await fetch(`${gs}/songs.json`),{songs:_}=await $.json();return kr.updateSongs(_,y)}}}else{const h=await fetch(`${gs}/songs.json`);if(h.ok){const m=h.headers.get("Last-Modified"),y=m?Date.parse(m):0,{songs:$}=await h.json();return kr.updateSongs($,y)}}});function u(){s=this.value,e(0,s)}return r.$$.update=()=>{r.$$.dirty&1&&a(()=>e(1,i=s))},[s,i,n,o,l,u]}class _m extends lt{constructor(t){super(),ct(this,t,dm,fm,ot,{})}}export{_m as component,ym as universal};
